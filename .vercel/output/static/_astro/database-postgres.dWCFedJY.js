var ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Er(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function Jt(d){if(Object.prototype.hasOwnProperty.call(d,"__esModule"))return d;var y=d.default;if(typeof y=="function"){var w=function _(){return this instanceof _?Reflect.construct(y,arguments,this.constructor):y.apply(this,arguments)};w.prototype=y.prototype}else w={};return Object.defineProperty(w,"__esModule",{value:!0}),Object.keys(d).forEach(function(_){var m=Object.getOwnPropertyDescriptor(d,_);Object.defineProperty(w,_,m.get?m:{enumerable:!0,get:function(){return d[_]}})}),w}var Ee={exports:{}};const wr={},gr=Object.freeze(Object.defineProperty({__proto__:null,default:wr},Symbol.toStringTag,{value:"Module"})),Y=Jt(gr);var we={exports:{}},Z={},ge={},st;function Zt(){if(st)return ge;st=1,ge.parse=function(w,_){return new d(w,_).parse()};class d{constructor(_,m){this.source=_,this.transform=m||y,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var _=this.source[this.position++];return _==="\\"?{value:this.source[this.position++],escaped:!0}:{value:_,escaped:!1}}record(_){this.recorded.push(_)}newEntry(_){var m;(this.recorded.length>0||_)&&(m=this.recorded.join(""),m==="NULL"&&!_&&(m=null),m!==null&&(m=this.transform(m)),this.entries.push(m),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var _=this.nextCharacter();if(_.value==="=")break}}parse(_){var m,h,o;for(this.consumeDimensions();!this.isEof();)if(m=this.nextCharacter(),m.value==="{"&&!o)this.dimension++,this.dimension>1&&(h=new d(this.source.substr(this.position-1),this.transform),this.entries.push(h.parse(!0)),this.position+=h.position-2);else if(m.value==="}"&&!o){if(this.dimension--,!this.dimension&&(this.newEntry(),_))return this.entries}else m.value==='"'&&!m.escaped?(o&&this.newEntry(!0),o=!o):m.value===","&&!o?this.newEntry():this.record(m.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}}function y(w){return w}return ge}var _e,at;function er(){if(at)return _e;at=1;var d=Zt();return _e={create:function(y,w){return{parse:function(){return d.parse(y,w)}}}},_e}var Se,ot;function _r(){if(ot)return Se;ot=1;var d=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,y=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,w=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,_=/^-?infinity$/;Se=function(l){if(_.test(l))return Number(l.replace("i","I"));var i=d.exec(l);if(!i)return m(l)||null;var r=!!i[8],n=parseInt(i[1],10);r&&(n=o(n));var a=parseInt(i[2],10)-1,p=i[3],E=parseInt(i[4],10),v=parseInt(i[5],10),g=parseInt(i[6],10),b=i[7];b=b?1e3*parseFloat(b):0;var R,L=h(l);return L!=null?(R=new Date(Date.UTC(n,a,p,E,v,g,b)),s(n)&&R.setUTCFullYear(n),L!==0&&R.setTime(R.getTime()-L)):(R=new Date(n,a,p,E,v,g,b),s(n)&&R.setFullYear(n)),R};function m(c){var l=y.exec(c);if(l){var i=parseInt(l[1],10),r=!!l[4];r&&(i=o(i));var n=parseInt(l[2],10)-1,a=l[3],p=new Date(i,n,a);return s(i)&&p.setFullYear(i),p}}function h(c){if(c.endsWith("+00"))return 0;var l=w.exec(c.split(" ")[1]);if(l){var i=l[1];if(i==="Z")return 0;var r=i==="-"?-1:1,n=parseInt(l[2],10)*3600+parseInt(l[3]||0,10)*60+parseInt(l[4]||0,10);return n*r*1e3}}function o(c){return-(c-1)}function s(c){return c>=0&&c<100}return Se}var ve,ut;function Sr(){if(ut)return ve;ut=1,ve=y;var d=Object.prototype.hasOwnProperty;function y(w){for(var _=1;_<arguments.length;_++){var m=arguments[_];for(var h in m)d.call(m,h)&&(w[h]=m[h])}return w}return ve}var Ae,ct;function vr(){if(ct)return Ae;ct=1;var d=Sr();Ae=y;function y(v){if(!(this instanceof y))return new y(v);d(this,E(v))}var w=["seconds","minutes","hours","days","months","years"];y.prototype.toPostgres=function(){var v=w.filter(this.hasOwnProperty,this);return this.milliseconds&&v.indexOf("seconds")<0&&v.push("seconds"),v.length===0?"0":v.map(function(g){var b=this[g]||0;return g==="seconds"&&this.milliseconds&&(b=(b+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),b+" "+g},this).join(" ")};var _={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},m=["years","months","days"],h=["hours","minutes","seconds"];y.prototype.toISOString=y.prototype.toISO=function(){var v=m.map(b,this).join(""),g=h.map(b,this).join("");return"P"+v+"T"+g;function b(R){var L=this[R]||0;return R==="seconds"&&this.milliseconds&&(L=(L+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),L+_[R]}};var o="([+-]?\\d+)",s=o+"\\s+years?",c=o+"\\s+mons?",l=o+"\\s+days?",i="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",r=new RegExp([s,c,l,i].map(function(v){return"("+v+")?"}).join("\\s*")),n={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},a=["hours","minutes","seconds","milliseconds"];function p(v){var g=v+"000000".slice(v.length);return parseInt(g,10)/1e3}function E(v){if(!v)return{};var g=r.exec(v),b=g[8]==="-";return Object.keys(n).reduce(function(R,L){var C=n[L],M=g[C];return!M||(M=L==="milliseconds"?p(M):parseInt(M,10),!M)||(b&&~a.indexOf(L)&&(M*=-1),R[L]=M),R},{})}return Ae}var be,ht;function Ar(){return ht||(ht=1,be=function(y){if(/^\\x/.test(y))return new Buffer(y.substr(2),"hex");for(var w="",_=0;_<y.length;)if(y[_]!=="\\")w+=y[_],++_;else if(/[0-7]{3}/.test(y.substr(_+1,3)))w+=String.fromCharCode(parseInt(y.substr(_+1,3),8)),_+=4;else{for(var m=1;_+m<y.length&&y[_+m]==="\\";)m++;for(var h=0;h<Math.floor(m/2);++h)w+="\\";_+=Math.floor(m/2)*2}return new Buffer(w,"binary")}),be}var Re,lt;function br(){if(lt)return Re;lt=1;var d=Zt(),y=er(),w=_r(),_=vr(),m=Ar();function h(A){return function(N){return N===null?N:A(N)}}function o(A){return A===null?A:A==="TRUE"||A==="t"||A==="true"||A==="y"||A==="yes"||A==="on"||A==="1"}function s(A){return A?d.parse(A,o):null}function c(A){return parseInt(A,10)}function l(A){return A?d.parse(A,h(c)):null}function i(A){return A?d.parse(A,h(function(P){return b(P).trim()})):null}var r=function(A){if(!A)return null;var P=y.create(A,function(N){return N!==null&&(N=L(N)),N});return P.parse()},n=function(A){if(!A)return null;var P=y.create(A,function(N){return N!==null&&(N=parseFloat(N)),N});return P.parse()},a=function(A){if(!A)return null;var P=y.create(A);return P.parse()},p=function(A){if(!A)return null;var P=y.create(A,function(N){return N!==null&&(N=w(N)),N});return P.parse()},E=function(A){if(!A)return null;var P=y.create(A,function(N){return N!==null&&(N=_(N)),N});return P.parse()},v=function(A){return A?d.parse(A,h(m)):null},g=function(A){return parseInt(A,10)},b=function(A){var P=String(A);return/^\d+$/.test(P)?P:A},R=function(A){return A?d.parse(A,h(JSON.parse)):null},L=function(A){return A[0]!=="("?null:(A=A.substring(1,A.length-1).split(","),{x:parseFloat(A[0]),y:parseFloat(A[1])})},C=function(A){if(A[0]!=="<"&&A[1]!=="(")return null;for(var P="(",N="",Q=!1,O=2;O<A.length-1;O++){if(Q||(P+=A[O]),A[O]===")"){Q=!0;continue}else if(!Q)continue;A[O]!==","&&(N+=A[O])}var K=L(P);return K.radius=parseFloat(N),K},M=function(A){A(20,b),A(21,g),A(23,g),A(26,g),A(700,parseFloat),A(701,parseFloat),A(16,o),A(1082,w),A(1114,w),A(1184,w),A(600,L),A(651,a),A(718,C),A(1e3,s),A(1001,v),A(1005,l),A(1007,l),A(1028,l),A(1016,i),A(1017,r),A(1021,n),A(1022,n),A(1231,n),A(1014,a),A(1015,a),A(1008,a),A(1009,a),A(1040,a),A(1041,a),A(1115,p),A(1182,p),A(1185,p),A(1186,_),A(1187,E),A(17,m),A(114,JSON.parse.bind(JSON)),A(3802,JSON.parse.bind(JSON)),A(199,R),A(3807,R),A(3907,a),A(2951,a),A(791,a),A(1183,a),A(1270,a)};return Re={init:M},Re}var Te,ft;function Rr(){if(ft)return Te;ft=1;var d=1e6;function y(w){var _=w.readInt32BE(0),m=w.readUInt32BE(4),h="";_<0&&(_=~_+(m===0),m=~m+1>>>0,h="-");var o="",s,c,l,i,r,n;{if(s=_%d,_=_/d>>>0,c=4294967296*s+m,m=c/d>>>0,l=""+(c-d*m),m===0&&_===0)return h+l+o;for(i="",r=6-l.length,n=0;n<r;n++)i+="0";o=i+l+o}{if(s=_%d,_=_/d>>>0,c=4294967296*s+m,m=c/d>>>0,l=""+(c-d*m),m===0&&_===0)return h+l+o;for(i="",r=6-l.length,n=0;n<r;n++)i+="0";o=i+l+o}{if(s=_%d,_=_/d>>>0,c=4294967296*s+m,m=c/d>>>0,l=""+(c-d*m),m===0&&_===0)return h+l+o;for(i="",r=6-l.length,n=0;n<r;n++)i+="0";o=i+l+o}return s=_%d,c=4294967296*s+m,l=""+c%d,h+l+o}return Te=y,Te}var Ce,pt;function Tr(){if(pt)return Ce;pt=1;var d=Rr(),y=function(a,p,E,v,g){E=E||0,v=v||!1,g=g||function(Q,O,K){return Q*Math.pow(2,K)+O};var b=E>>3,R=function(Q){return v?~Q&255:Q},L=255,C=8-E%8;p<C&&(L=255<<8-p&255,C=p),E&&(L=L>>E%8);var M=0;E%8+p>=8&&(M=g(0,R(a[b])&L,C));for(var A=p+E>>3,P=b+1;P<A;P++)M=g(M,R(a[P]),8);var N=(p+E)%8;return N>0&&(M=g(M,R(a[A])>>8-N,N)),M},w=function(a,p,E){var v=Math.pow(2,E-1)-1,g=y(a,1),b=y(a,E,1);if(b===0)return 0;var R=1,L=function(M,A,P){M===0&&(M=1);for(var N=1;N<=P;N++)R/=2,(A&1<<P-N)>0&&(M+=R);return M},C=y(a,p,E+1,!1,L);return b==Math.pow(2,E+1)-1?C===0?g===0?1/0:-1/0:NaN:(g===0?1:-1)*Math.pow(2,b-v)*C},_=function(a){return y(a,1)==1?-1*(y(a,15,1,!0)+1):y(a,15,1)},m=function(a){return y(a,1)==1?-1*(y(a,31,1,!0)+1):y(a,31,1)},h=function(a){return w(a,23,8)},o=function(a){return w(a,52,11)},s=function(a){var p=y(a,16,32);if(p==49152)return NaN;for(var E=Math.pow(1e4,y(a,16,16)),v=0,g=y(a,16),b=0;b<g;b++)v+=y(a,16,64+16*b)*E,E/=1e4;var R=Math.pow(10,y(a,16,48));return(p===0?1:-1)*Math.round(v*R)/R},c=function(a,p){var E=y(p,1),v=y(p,63,1),g=new Date((E===0?1:-1)*v/1e3+9466848e5);return a||g.setTime(g.getTime()+g.getTimezoneOffset()*6e4),g.usec=v%1e3,g.getMicroSeconds=function(){return this.usec},g.setMicroSeconds=function(b){this.usec=b},g.getUTCMicroSeconds=function(){return this.usec},g},l=function(a){var p=y(a,32);y(a,32,32);for(var E=y(a,32,64),v=96,g=[],b=0;b<p;b++)g[b]=y(a,32,v),v+=32,v+=32;var R=function(C){var M=y(a,32,v);if(v+=32,M==4294967295)return null;var A;if(C==23||C==20)return A=y(a,M*8,v),v+=M*8,A;if(C==25)return A=a.toString(this.encoding,v>>3,(v+=M<<3)>>3),A;console.log("ERROR: ElementType not implemented: "+C)},L=function(C,M){var A=[],P;if(C.length>1){var N=C.shift();for(P=0;P<N;P++)A[P]=L(C,M);C.unshift(N)}else for(P=0;P<C[0];P++)A[P]=R(M);return A};return L(g,E)},i=function(a){return a.toString("utf8")},r=function(a){return a===null?null:y(a,8)>0},n=function(a){a(20,d),a(21,_),a(23,m),a(26,m),a(1700,s),a(700,h),a(701,o),a(16,r),a(1114,c.bind(null,!1)),a(1184,c.bind(null,!0)),a(1e3,l),a(1007,l),a(1016,l),a(1008,l),a(1009,l),a(25,i)};return Ce={init:n},Ce}var xe,dt;function Cr(){return dt||(dt=1,xe={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}),xe}var mt;function pe(){if(mt)return Z;mt=1;var d=br(),y=Tr(),w=er(),_=Cr();Z.getTypeParser=o,Z.setTypeParser=s,Z.arrayParser=w,Z.builtins=_;var m={text:{},binary:{}};function h(c){return String(c)}function o(c,l){return l=l||"text",m[l]&&m[l][c]||h}function s(c,l,i){typeof l=="function"&&(i=l,l="text"),m[l][c]=i}return d.init(function(c,l){m.text[c]=l}),y.init(function(c,l){m.binary[c]=l}),Z}var yt;function de(){return yt||(yt=1,function(d){var y={};d.exports={host:"localhost",user:process.platform==="win32"?y.USERNAME:y.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};const w=pe(),_=w.getTypeParser(20,"text"),m=w.getTypeParser(1016,"text");d.exports.__defineSetter__("parseInt8",function(h){w.setTypeParser(20,"text",h?w.getTypeParser(23,"text"):_),w.setTypeParser(1016,"text",h?w.getTypeParser(1007,"text"):m)})}(we)),we.exports}var Ie,Et;function se(){if(Et)return Ie;Et=1;const d=de(),y=Y,{isDate:w}=y.types||y;function _(n){return'"'+n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function m(n){let a="{";for(let p=0;p<n.length;p++)if(p>0&&(a=a+","),n[p]===null||typeof n[p]>"u")a=a+"NULL";else if(Array.isArray(n[p]))a=a+m(n[p]);else if(ArrayBuffer.isView(n[p])){let E=n[p];if(!(E instanceof Buffer)){const v=Buffer.from(E.buffer,E.byteOffset,E.byteLength);v.length===E.byteLength?E=v:E=v.slice(E.byteOffset,E.byteOffset+E.byteLength)}a+="\\\\x"+E.toString("hex")}else a+=_(h(n[p]));return a=a+"}",a}const h=function(n,a){if(n==null)return null;if(typeof n=="object"){if(n instanceof Buffer)return n;if(ArrayBuffer.isView(n)){const p=Buffer.from(n.buffer,n.byteOffset,n.byteLength);return p.length===n.byteLength?p:p.slice(n.byteOffset,n.byteOffset+n.byteLength)}return w(n)?d.parseInputDatesAsUTC?c(n):s(n):Array.isArray(n)?m(n):o(n,a)}return n.toString()};function o(n,a){if(n&&typeof n.toPostgres=="function"){if(a=a||[],a.indexOf(n)!==-1)throw new Error('circular reference detected while preparing "'+n+'" for query');return a.push(n),h(n.toPostgres(h),a)}return JSON.stringify(n)}function s(n){let a=-n.getTimezoneOffset(),p=n.getFullYear();const E=p<1;E&&(p=Math.abs(p)+1);let v=String(p).padStart(4,"0")+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0")+"T"+String(n.getHours()).padStart(2,"0")+":"+String(n.getMinutes()).padStart(2,"0")+":"+String(n.getSeconds()).padStart(2,"0")+"."+String(n.getMilliseconds()).padStart(3,"0");return a<0?(v+="-",a*=-1):v+="+",v+=String(Math.floor(a/60)).padStart(2,"0")+":"+String(a%60).padStart(2,"0"),E&&(v+=" BC"),v}function c(n){let a=n.getUTCFullYear();const p=a<1;p&&(a=Math.abs(a)+1);let E=String(a).padStart(4,"0")+"-"+String(n.getUTCMonth()+1).padStart(2,"0")+"-"+String(n.getUTCDate()).padStart(2,"0")+"T"+String(n.getUTCHours()).padStart(2,"0")+":"+String(n.getUTCMinutes()).padStart(2,"0")+":"+String(n.getUTCSeconds()).padStart(2,"0")+"."+String(n.getUTCMilliseconds()).padStart(3,"0");return E+="+00:00",p&&(E+=" BC"),E}function l(n,a,p){return n=typeof n=="string"?{text:n}:n,a&&(typeof a=="function"?n.callback=a:n.values=a),p&&(n.callback=p),n}return Ie={prepareValue:function(a){return h(a)},normalizeQueryConfig:l,escapeIdentifier:function(n){return'"'+n.replace(/"/g,'""')+'"'},escapeLiteral:function(n){let a=!1,p="'";if(n==null||typeof n!="string")return"''";for(let E=0;E<n.length;E++){const v=n[E];v==="'"?p+=v+v:v==="\\"?(p+=v+v,a=!0):p+=v}return p+="'",a===!0&&(p=" E"+p),p}},Ie}var ue={exports:{}},Me,wt;function xr(){if(wt)return Me;wt=1;const d=Y;function y(s){return d.createHash("md5").update(s,"utf-8").digest("hex")}function w(s,c,l){const i=y(c+s);return"md5"+y(Buffer.concat([Buffer.from(i),l]))}function _(s){return d.createHash("sha256").update(s).digest()}function m(s,c){return s=s.replace(/(\D)-/,"$1"),d.createHash(s).update(c).digest()}function h(s,c){return d.createHmac("sha256",s).update(c).digest()}async function o(s,c,l){return d.pbkdf2Sync(s,c,l,32,"sha256")}return Me={postgresMd5PasswordHash:w,randomBytes:d.randomBytes,deriveKey:o,sha256:_,hashByName:m,hmacSha256:h,md5:y},Me}var Le,gt;function Ir(){if(gt)return Le;gt=1;const d=Y;Le={postgresMd5PasswordHash:o,randomBytes:m,deriveKey:i,sha256:s,hashByName:c,hmacSha256:l,md5:h};const y=d.webcrypto||globalThis.crypto,w=y.subtle,_=new TextEncoder;function m(r){return y.getRandomValues(Buffer.alloc(r))}async function h(r){try{return d.createHash("md5").update(r,"utf-8").digest("hex")}catch{const a=typeof r=="string"?_.encode(r):r,p=await w.digest("MD5",a);return Array.from(new Uint8Array(p)).map(E=>E.toString(16).padStart(2,"0")).join("")}}async function o(r,n,a){const p=await h(n+r);return"md5"+await h(Buffer.concat([Buffer.from(p),a]))}async function s(r){return await w.digest("SHA-256",r)}async function c(r,n){return await w.digest(r,n)}async function l(r,n){const a=await w.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return await w.sign("HMAC",a,_.encode(n))}async function i(r,n,a){const p=await w.importKey("raw",_.encode(r),"PBKDF2",!1,["deriveBits"]),E={name:"PBKDF2",hash:"SHA-256",salt:n,iterations:a};return await w.deriveBits(E,p,256,["deriveBits"])}return Le}var _t;function tr(){return _t||(_t=1,parseInt(process.versions&&process.versions.node&&process.versions.node.split(".")[0])<15?ue.exports=xr():ue.exports=Ir()),ue.exports}var Pe,St;function Mr(){if(St)return Pe;St=1;function d(h,o){return new Error("SASL channel binding: "+h+" when parsing public certificate "+o.toString("base64"))}function y(h,o){let s=h[o++];if(s<128)return{length:s,index:o};const c=s&127;if(c>4)throw d("bad length",h);s=0;for(let l=0;l<c;l++)s=s<<8|h[o++];return{length:s,index:o}}function w(h,o){if(h[o++]!==6)throw d("non-OID data",h);const{length:s,index:c}=y(h,o);o=c;const l=o+s,i=h[o++];let r=(i/40>>0)+"."+i%40;for(;o<l;){let n=0;for(;o<l;){const a=h[o++];if(n=n<<7|a&127,a<128)break}r+="."+n}return{oid:r,index:o}}function _(h,o){if(h[o++]!==48)throw d("non-sequence data",h);return y(h,o)}function m(h,o){o===void 0&&(o=0),o=_(h,o).index;const{length:s,index:c}=_(h,o);o=c+s,o=_(h,o).index;const{oid:l,index:i}=w(h,o);switch(l){case"1.2.840.113549.1.1.4":return"MD5";case"1.2.840.113549.1.1.5":return"SHA-1";case"1.2.840.113549.1.1.11":return"SHA-256";case"1.2.840.113549.1.1.12":return"SHA-384";case"1.2.840.113549.1.1.13":return"SHA-512";case"1.2.840.113549.1.1.14":return"SHA-224";case"1.2.840.113549.1.1.15":return"SHA512-224";case"1.2.840.113549.1.1.16":return"SHA512-256";case"1.2.840.10045.4.1":return"SHA-1";case"1.2.840.10045.4.3.1":return"SHA-224";case"1.2.840.10045.4.3.2":return"SHA-256";case"1.2.840.10045.4.3.3":return"SHA-384";case"1.2.840.10045.4.3.4":return"SHA-512";case"1.2.840.113549.1.1.10":{if(o=i,o=_(h,o).index,h[o++]!==160)throw d("non-tag data",h);o=y(h,o).index,o=_(h,o).index;const{oid:r}=w(h,o);switch(r){case"1.2.840.113549.2.5":return"MD5";case"1.3.14.3.2.26":return"SHA-1";case"2.16.840.1.101.3.4.2.1":return"SHA-256";case"2.16.840.1.101.3.4.2.2":return"SHA-384";case"2.16.840.1.101.3.4.2.3":return"SHA-512"}throw d("unknown hash OID "+r,h)}case"1.3.101.110":case"1.3.101.112":return"SHA-512";case"1.3.101.111":case"1.3.101.113":throw d("Ed448 certificate channel binding is not currently supported by Postgres")}throw d("unknown OID "+l,h)}return Pe={signatureAlgorithmHashFromCertificate:m},Pe}var Ne,vt;function Lr(){if(vt)return Ne;vt=1;const d=tr(),{signatureAlgorithmHashFromCertificate:y}=Mr();function w(r,n){const a=["SCRAM-SHA-256"];n&&a.unshift("SCRAM-SHA-256-PLUS");const p=a.find(g=>r.includes(g));if(!p)throw new Error("SASL: Only mechanism(s) "+a.join(" and ")+" are supported");if(p==="SCRAM-SHA-256-PLUS"&&typeof n.getPeerCertificate!="function")throw new Error("SASL: Mechanism SCRAM-SHA-256-PLUS requires a certificate");const E=d.randomBytes(18).toString("base64");return{mechanism:p,clientNonce:E,response:(p==="SCRAM-SHA-256-PLUS"?"p=tls-server-end-point":n?"y":"n")+",,n=*,r="+E,message:"SASLInitialResponse"}}async function _(r,n,a,p){if(r.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof n!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(n==="")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof a!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");const E=c(a);if(E.nonce.startsWith(r.clientNonce)){if(E.nonce.length===r.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");const v="n=*,r="+r.clientNonce,g="r="+E.nonce+",s="+E.salt+",i="+E.iteration;let b=p?"eSws":"biws";if(r.mechanism==="SCRAM-SHA-256-PLUS"){const I=p.getPeerCertificate().raw;let B=y(I);(B==="MD5"||B==="SHA-1")&&(B="SHA-256");const U=await d.hashByName(B,I);b=Buffer.concat([Buffer.from("p=tls-server-end-point,,"),Buffer.from(U)]).toString("base64")}const R="c="+b+",r="+E.nonce,L=v+","+g+","+R,C=Buffer.from(E.salt,"base64"),M=await d.deriveKey(n,C,E.iteration),A=await d.hmacSha256(M,"Client Key"),P=await d.sha256(A),N=await d.hmacSha256(P,L),Q=i(Buffer.from(A),Buffer.from(N)).toString("base64"),O=await d.hmacSha256(M,"Server Key"),K=await d.hmacSha256(O,L);r.message="SASLResponse",r.serverSignature=Buffer.from(K).toString("base64"),r.response=R+",p="+Q}function m(r,n){if(r.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof n!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");const{serverSignature:a}=l(n);if(a!==r.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function h(r){if(typeof r!="string")throw new TypeError("SASL: text must be a string");return r.split("").map((n,a)=>r.charCodeAt(a)).every(n=>n>=33&&n<=43||n>=45&&n<=126)}function o(r){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(r)}function s(r){if(typeof r!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(r.split(",").map(n=>{if(!/^.=/.test(n))throw new Error("SASL: Invalid attribute pair entry");const a=n[0],p=n.substring(2);return[a,p]}))}function c(r){const n=s(r),a=n.get("r");if(a){if(!h(a))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");const p=n.get("s");if(p){if(!o(p))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");const E=n.get("i");if(E){if(!/^[1-9][0-9]*$/.test(E))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");const v=parseInt(E,10);return{nonce:a,salt:p,iteration:v}}function l(r){const a=s(r).get("v");if(a){if(!o(a))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:a}}function i(r,n){if(!Buffer.isBuffer(r))throw new TypeError("first argument must be a Buffer");if(!Buffer.isBuffer(n))throw new TypeError("second argument must be a Buffer");if(r.length!==n.length)throw new Error("Buffer lengths must match");if(r.length===0)throw new Error("Buffers cannot be empty");return Buffer.from(r.map((a,p)=>r[p]^n[p]))}return Ne={startSession:w,continueSession:_,finalizeSession:m},Ne}var Fe,At;function Je(){if(At)return Fe;At=1;const d=pe();function y(w){this._types=w||d,this.text={},this.binary={}}return y.prototype.getOverrides=function(w){switch(w){case"text":return this.text;case"binary":return this.binary;default:return{}}},y.prototype.setTypeParser=function(w,_,m){typeof _=="function"&&(m=_,_="text"),this.getOverrides(_)[w]=m},y.prototype.getTypeParser=function(w,_){return _=_||"text",this.getOverrides(_)[w]||this._types.getTypeParser(w,_)},Fe=y,Fe}var Be,bt;function Pr(){if(bt)return Be;bt=1;function d(m,h={}){if(m.charAt(0)==="/"){const n=m.split(" ");return{host:n[0],database:n[1]}}const o={};let s,c=!1;/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(m)&&(m=encodeURI(m).replace(/%25(\d\d)/g,"%$1"));try{try{s=new URL(m,"postgres://base")}catch{s=new URL(m.replace("@/","@___DUMMY___/"),"postgres://base"),c=!0}}catch(n){n.input&&(n.input="*****REDACTED*****")}for(const n of s.searchParams.entries())o[n[0]]=n[1];if(o.user=o.user||decodeURIComponent(s.username),o.password=o.password||decodeURIComponent(s.password),s.protocol=="socket:")return o.host=decodeURI(s.pathname),o.database=s.searchParams.get("db"),o.client_encoding=s.searchParams.get("encoding"),o;const l=c?"":s.hostname;o.host?l&&/^%2f/i.test(l)&&(s.pathname=l+s.pathname):o.host=decodeURIComponent(l),o.port||(o.port=s.port);const i=s.pathname.slice(1)||null;o.database=i?decodeURI(i):null,(o.ssl==="true"||o.ssl==="1")&&(o.ssl=!0),o.ssl==="0"&&(o.ssl=!1),(o.sslcert||o.sslkey||o.sslrootcert||o.sslmode)&&(o.ssl={});const r=o.sslcert||o.sslkey||o.sslrootcert?Y:null;if(o.sslcert&&(o.ssl.cert=r.readFileSync(o.sslcert).toString()),o.sslkey&&(o.ssl.key=r.readFileSync(o.sslkey).toString()),o.sslrootcert&&(o.ssl.ca=r.readFileSync(o.sslrootcert).toString()),h.useLibpqCompat&&o.uselibpqcompat)throw new Error("Both useLibpqCompat and uselibpqcompat are set. Please use only one of them.");if(o.uselibpqcompat==="true"||h.useLibpqCompat)switch(o.sslmode){case"disable":{o.ssl=!1;break}case"prefer":{o.ssl.rejectUnauthorized=!1;break}case"require":{o.sslrootcert?o.ssl.checkServerIdentity=function(){}:o.ssl.rejectUnauthorized=!1;break}case"verify-ca":{if(!o.ssl.ca)throw new Error("SECURITY WARNING: Using sslmode=verify-ca requires specifying a CA with sslrootcert. If a public CA is used, verify-ca allows connections to a server that somebody else may have registered with the CA, making you vulnerable to Man-in-the-Middle attacks. Either specify a custom CA certificate with sslrootcert parameter or use sslmode=verify-full for proper security.");o.ssl.checkServerIdentity=function(){};break}}else switch(o.sslmode){case"disable":{o.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{o.ssl.rejectUnauthorized=!1;break}}return o}function y(m){return Object.entries(m).reduce((o,[s,c])=>(c!=null&&(o[s]=c),o),{})}function w(m){return Object.entries(m).reduce((o,[s,c])=>{if(s==="ssl"){const l=c;typeof l=="boolean"&&(o[s]=l),typeof l=="object"&&(o[s]=y(l))}else if(c!=null)if(s==="port"){if(c!==""){const l=parseInt(c,10);if(isNaN(l))throw new Error(`Invalid ${s}: ${c}`);o[s]=l}}else o[s]=c;return o},{})}function _(m){return w(d(m))}return Be=d,d.parse=d,d.toClientConfig=w,d.parseIntoClientConfig=_,Be}var Oe,Rt;function rr(){if(Rt)return Oe;Rt=1;var d={};const y=Y,w=de(),_=Pr().parse,m=function(l,i,r){return r===void 0?r=d["PG"+l.toUpperCase()]:r===!1||(r=d[r]),i[l]||r||w[l]},h=function(){switch(d.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return w.ssl},o=function(l){return"'"+(""+l).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},s=function(l,i,r){const n=i[r];n!=null&&l.push(r+"="+o(n))};class c{constructor(i){i=typeof i=="string"?_(i):i||{},i.connectionString&&(i=Object.assign({},i,_(i.connectionString))),this.user=m("user",i),this.database=m("database",i),this.database===void 0&&(this.database=this.user),this.port=parseInt(m("port",i),10),this.host=m("host",i),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:m("password",i)}),this.binary=m("binary",i),this.options=m("options",i),this.ssl=typeof i.ssl>"u"?h():i.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=m("client_encoding",i),this.replication=m("replication",i),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=m("application_name",i,"PGAPPNAME"),this.fallback_application_name=m("fallback_application_name",i,!1),this.statement_timeout=m("statement_timeout",i,!1),this.lock_timeout=m("lock_timeout",i,!1),this.idle_in_transaction_session_timeout=m("idle_in_transaction_session_timeout",i,!1),this.query_timeout=m("query_timeout",i,!1),i.connectionTimeoutMillis===void 0?this.connect_timeout=d.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(i.connectionTimeoutMillis/1e3),i.keepAlive===!1?this.keepalives=0:i.keepAlive===!0&&(this.keepalives=1),typeof i.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(i.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(i){const r=[];s(r,this,"user"),s(r,this,"password"),s(r,this,"port"),s(r,this,"application_name"),s(r,this,"fallback_application_name"),s(r,this,"connect_timeout"),s(r,this,"options");const n=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(s(r,n,"sslmode"),s(r,n,"sslca"),s(r,n,"sslkey"),s(r,n,"sslcert"),s(r,n,"sslrootcert"),this.database&&r.push("dbname="+o(this.database)),this.replication&&r.push("replication="+o(this.replication)),this.host&&r.push("host="+o(this.host)),this.isDomainSocket)return i(null,r.join(" "));this.client_encoding&&r.push("client_encoding="+o(this.client_encoding)),y.lookup(this.host,function(a,p){return a?i(a,null):(r.push("hostaddr="+o(p)),i(null,r.join(" ")))})}}return Oe=c,Oe}var De,Tt;function nr(){if(Tt)return De;Tt=1;const d=pe(),y=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/;class w{constructor(m,h){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=h,this.RowCtor=null,this.rowAsArray=m==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray),this._prebuiltEmptyResultObject=null}addCommandComplete(m){let h;m.text?h=y.exec(m.text):h=y.exec(m.command),h&&(this.command=h[1],h[3]?(this.oid=parseInt(h[2],10),this.rowCount=parseInt(h[3],10)):h[2]&&(this.rowCount=parseInt(h[2],10)))}_parseRowAsArray(m){const h=new Array(m.length);for(let o=0,s=m.length;o<s;o++){const c=m[o];c!==null?h[o]=this._parsers[o](c):h[o]=null}return h}parseRow(m){const h={...this._prebuiltEmptyResultObject};for(let o=0,s=m.length;o<s;o++){const c=m[o],l=this.fields[o].name;if(c!==null){const i=this.fields[o].format==="binary"?Buffer.from(c):c;h[l]=this._parsers[o](i)}else h[l]=null}return h}addRow(m){this.rows.push(m)}addFields(m){this.fields=m,this.fields.length&&(this._parsers=new Array(m.length));const h={};for(let o=0;o<m.length;o++){const s=m[o];h[s.name]=null,this._types?this._parsers[o]=this._types.getTypeParser(s.dataTypeID,s.format||"text"):this._parsers[o]=d.getTypeParser(s.dataTypeID,s.format||"text")}this._prebuiltEmptyResultObject={...h}}}return De=w,De}var Ue,Ct;function Nr(){if(Ct)return Ue;Ct=1;const{EventEmitter:d}=Y,y=nr(),w=se();class _ extends d{constructor(h,o,s){super(),h=w.normalizeQueryConfig(h,o,s),this.text=h.text,this.values=h.values,this.rows=h.rows,this.types=h.types,this.name=h.name,this.queryMode=h.queryMode,this.binary=h.binary,this.portal=h.portal||"",this.callback=h.callback,this._rowMode=h.rowMode,process.domain&&h.callback&&(this.callback=process.domain.bind(h.callback)),this._result=new y(this._rowMode,this.types),this._results=this._result,this._canceledDueToError=!1}requiresPreparation(){return this.queryMode==="extended"||this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new y(this._rowMode,this._result._types),this._results.push(this._result))}handleRowDescription(h){this._checkForMultirow(),this._result.addFields(h.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(h){let o;if(!this._canceledDueToError){try{o=this._result.parseRow(h.fields)}catch(s){this._canceledDueToError=s;return}this.emit("row",o,this._result),this._accumulateRows&&this._result.addRow(o)}}handleCommandComplete(h,o){this._checkForMultirow(),this._result.addCommandComplete(h),this.rows&&o.sync()}handleEmptyQuery(h){this.rows&&h.sync()}handleError(h,o){if(this._canceledDueToError&&(h=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(h);this.emit("error",h)}handleReadyForQuery(h){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,h);if(this.callback)try{this.callback(null,this._results)}catch(o){process.nextTick(()=>{throw o})}this.emit("end",this._results)}submit(h){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");const o=h.parsedStatements[this.name];if(this.text&&o&&this.text!==o)return new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);if(this.values&&!Array.isArray(this.values))return new Error("Query values must be an array");if(this.requiresPreparation()){h.stream.cork&&h.stream.cork();try{this.prepare(h)}finally{h.stream.uncork&&h.stream.uncork()}}else h.query(this.text);return null}hasBeenParsed(h){return this.name&&h.parsedStatements[this.name]}handlePortalSuspended(h){this._getRows(h,this.rows)}_getRows(h,o){h.execute({portal:this.portal,rows:o}),o?h.flush():h.sync()}prepare(h){this.hasBeenParsed(h)||h.parse({text:this.text,name:this.name,types:this.types});try{h.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:w.prepareValue})}catch(o){this.handleError(o,h);return}h.describe({type:"P",name:this.portal||""}),this._getRows(h,this.rows)}handleCopyInResponse(h){h.sendCopyFail("No source stream defined")}handleCopyData(h,o){}}return Ue=_,Ue}var ke={},F={},xt;function ir(){if(xt)return F;xt=1,Object.defineProperty(F,"__esModule",{value:!0}),F.NoticeMessage=F.DataRowMessage=F.CommandCompleteMessage=F.ReadyForQueryMessage=F.NotificationResponseMessage=F.BackendKeyDataMessage=F.AuthenticationMD5Password=F.ParameterStatusMessage=F.ParameterDescriptionMessage=F.RowDescriptionMessage=F.Field=F.CopyResponse=F.CopyDataMessage=F.DatabaseError=F.copyDone=F.emptyQuery=F.replicationStart=F.portalSuspended=F.noData=F.closeComplete=F.bindComplete=F.parseComplete=void 0,F.parseComplete={name:"parseComplete",length:5},F.bindComplete={name:"bindComplete",length:5},F.closeComplete={name:"closeComplete",length:5},F.noData={name:"noData",length:5},F.portalSuspended={name:"portalSuspended",length:5},F.replicationStart={name:"replicationStart",length:4},F.emptyQuery={name:"emptyQuery",length:4},F.copyDone={name:"copyDone",length:4};class d extends Error{constructor(E,v,g){super(E),this.length=v,this.name=g}}F.DatabaseError=d;class y{constructor(E,v){this.length=E,this.chunk=v,this.name="copyData"}}F.CopyDataMessage=y;class w{constructor(E,v,g,b){this.length=E,this.name=v,this.binary=g,this.columnTypes=new Array(b)}}F.CopyResponse=w;class _{constructor(E,v,g,b,R,L,C){this.name=E,this.tableID=v,this.columnID=g,this.dataTypeID=b,this.dataTypeSize=R,this.dataTypeModifier=L,this.format=C}}F.Field=_;class m{constructor(E,v){this.length=E,this.fieldCount=v,this.name="rowDescription",this.fields=new Array(this.fieldCount)}}F.RowDescriptionMessage=m;class h{constructor(E,v){this.length=E,this.parameterCount=v,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}}F.ParameterDescriptionMessage=h;class o{constructor(E,v,g){this.length=E,this.parameterName=v,this.parameterValue=g,this.name="parameterStatus"}}F.ParameterStatusMessage=o;class s{constructor(E,v){this.length=E,this.salt=v,this.name="authenticationMD5Password"}}F.AuthenticationMD5Password=s;class c{constructor(E,v,g){this.length=E,this.processID=v,this.secretKey=g,this.name="backendKeyData"}}F.BackendKeyDataMessage=c;class l{constructor(E,v,g,b){this.length=E,this.processId=v,this.channel=g,this.payload=b,this.name="notification"}}F.NotificationResponseMessage=l;class i{constructor(E,v){this.length=E,this.status=v,this.name="readyForQuery"}}F.ReadyForQueryMessage=i;class r{constructor(E,v){this.length=E,this.text=v,this.name="commandComplete"}}F.CommandCompleteMessage=r;class n{constructor(E,v){this.length=E,this.fields=v,this.name="dataRow",this.fieldCount=v.length}}F.DataRowMessage=n;class a{constructor(E,v){this.length=E,this.message=v,this.name="notice"}}return F.NoticeMessage=a,F}var ee={},te={},It;function Fr(){if(It)return te;It=1,Object.defineProperty(te,"__esModule",{value:!0}),te.Writer=void 0;class d{constructor(w=256){this.size=w,this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(w)}ensure(w){if(this.buffer.length-this.offset<w){const m=this.buffer,h=m.length+(m.length>>1)+w;this.buffer=Buffer.allocUnsafe(h),m.copy(this.buffer)}}addInt32(w){return this.ensure(4),this.buffer[this.offset++]=w>>>24&255,this.buffer[this.offset++]=w>>>16&255,this.buffer[this.offset++]=w>>>8&255,this.buffer[this.offset++]=w>>>0&255,this}addInt16(w){return this.ensure(2),this.buffer[this.offset++]=w>>>8&255,this.buffer[this.offset++]=w>>>0&255,this}addCString(w){if(!w)this.ensure(1);else{const _=Buffer.byteLength(w);this.ensure(_+1),this.buffer.write(w,this.offset,"utf-8"),this.offset+=_}return this.buffer[this.offset++]=0,this}addString(w=""){const _=Buffer.byteLength(w);return this.ensure(_),this.buffer.write(w,this.offset),this.offset+=_,this}add(w){return this.ensure(w.length),w.copy(this.buffer,this.offset),this.offset+=w.length,this}join(w){if(w){this.buffer[this.headerPosition]=w;const _=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(_,this.headerPosition+1)}return this.buffer.slice(w?0:5,this.offset)}flush(w){const _=this.join(w);return this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(this.size),_}}return te.Writer=d,te}var Mt;function Br(){if(Mt)return ee;Mt=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.serialize=void 0;const d=Fr(),y=new d.Writer,w=I=>{y.addInt16(3).addInt16(0);for(const q of Object.keys(I))y.addCString(q).addCString(I[q]);y.addCString("client_encoding").addCString("UTF8");const B=y.addCString("").flush(),U=B.length+4;return new d.Writer().addInt32(U).add(B).flush()},_=()=>{const I=Buffer.allocUnsafe(8);return I.writeInt32BE(8,0),I.writeInt32BE(80877103,4),I},m=I=>y.addCString(I).flush(112),h=function(I,B){return y.addCString(I).addInt32(Buffer.byteLength(B)).addString(B),y.flush(112)},o=function(I){return y.addString(I).flush(112)},s=I=>y.addCString(I).flush(81),c=[],l=I=>{const B=I.name||"";B.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",B,B.length),console.error("This can cause conflicts and silent errors executing queries"));const U=I.types||c,q=U.length,j=y.addCString(B).addCString(I.text).addInt16(q);for(let W=0;W<q;W++)j.addInt32(U[W]);return y.flush(80)},i=new d.Writer,r=function(I,B){for(let U=0;U<I.length;U++){const q=B?B(I[U],U):I[U];q==null?(y.addInt16(0),i.addInt32(-1)):q instanceof Buffer?(y.addInt16(1),i.addInt32(q.length),i.add(q)):(y.addInt16(0),i.addInt32(Buffer.byteLength(q)),i.addString(q))}},n=(I={})=>{const B=I.portal||"",U=I.statement||"",q=I.binary||!1,j=I.values||c,W=j.length;return y.addCString(B).addCString(U),y.addInt16(W),r(j,I.valueMapper),y.addInt16(W),y.add(i.flush()),y.addInt16(1),y.addInt16(q?1:0),y.flush(66)},a=Buffer.from([69,0,0,0,9,0,0,0,0,0]),p=I=>{if(!I||!I.portal&&!I.rows)return a;const B=I.portal||"",U=I.rows||0,q=Buffer.byteLength(B),j=4+q+1+4,W=Buffer.allocUnsafe(1+j);return W[0]=69,W.writeInt32BE(j,1),W.write(B,5,"utf-8"),W[q+5]=0,W.writeUInt32BE(U,W.length-4),W},E=(I,B)=>{const U=Buffer.allocUnsafe(16);return U.writeInt32BE(16,0),U.writeInt16BE(1234,4),U.writeInt16BE(5678,6),U.writeInt32BE(I,8),U.writeInt32BE(B,12),U},v=(I,B)=>{const q=4+Buffer.byteLength(B)+1,j=Buffer.allocUnsafe(1+q);return j[0]=I,j.writeInt32BE(q,1),j.write(B,5,"utf-8"),j[q]=0,j},g=y.addCString("P").flush(68),b=y.addCString("S").flush(68),R=I=>I.name?v(68,`${I.type}${I.name||""}`):I.type==="P"?g:b,L=I=>{const B=`${I.type}${I.name||""}`;return v(67,B)},C=I=>y.add(I).flush(100),M=I=>v(102,I),A=I=>Buffer.from([I,0,0,0,4]),P=A(72),N=A(83),Q=A(88),O=A(99),K={startup:w,password:m,requestSsl:_,sendSASLInitialResponseMessage:h,sendSCRAMClientFinalMessage:o,query:s,parse:l,bind:n,execute:p,describe:R,close:L,flush:()=>P,sync:()=>N,end:()=>Q,copyData:C,copyDone:()=>O,copyFail:M,cancel:E};return ee.serialize=K,ee}var re={},ne={},Lt;function Or(){if(Lt)return ne;Lt=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.BufferReader=void 0;const d=Buffer.allocUnsafe(0);class y{constructor(_=0){this.offset=_,this.buffer=d,this.encoding="utf-8"}setBuffer(_,m){this.offset=_,this.buffer=m}int16(){const _=this.buffer.readInt16BE(this.offset);return this.offset+=2,_}byte(){const _=this.buffer[this.offset];return this.offset++,_}int32(){const _=this.buffer.readInt32BE(this.offset);return this.offset+=4,_}uint32(){const _=this.buffer.readUInt32BE(this.offset);return this.offset+=4,_}string(_){const m=this.buffer.toString(this.encoding,this.offset,this.offset+_);return this.offset+=_,m}cstring(){const _=this.offset;let m=_;for(;this.buffer[m++]!==0;);return this.offset=m,this.buffer.toString(this.encoding,_,m-1)}bytes(_){const m=this.buffer.slice(this.offset,this.offset+_);return this.offset+=_,m}}return ne.BufferReader=y,ne}var Pt;function Dr(){if(Pt)return re;Pt=1,Object.defineProperty(re,"__esModule",{value:!0}),re.Parser=void 0;const d=ir(),y=Or(),w=1,m=w+4,h=Buffer.allocUnsafe(0);class o{constructor(c){if(this.buffer=h,this.bufferLength=0,this.bufferOffset=0,this.reader=new y.BufferReader,c?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=c?.mode||"text"}parse(c,l){this.mergeBuffer(c);const i=this.bufferOffset+this.bufferLength;let r=this.bufferOffset;for(;r+m<=i;){const n=this.buffer[r],a=this.buffer.readUInt32BE(r+w),p=w+a;if(p+r<=i){const E=this.handlePacket(r+m,n,a,this.buffer);l(E),r+=p}else break}r===i?(this.buffer=h,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=i-r,this.bufferOffset=r)}mergeBuffer(c){if(this.bufferLength>0){const l=this.bufferLength+c.byteLength;if(l+this.bufferOffset>this.buffer.byteLength){let r;if(l<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)r=this.buffer;else{let n=this.buffer.byteLength*2;for(;l>=n;)n*=2;r=Buffer.allocUnsafe(n)}this.buffer.copy(r,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=r,this.bufferOffset=0}c.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=l}else this.buffer=c,this.bufferOffset=0,this.bufferLength=c.byteLength}handlePacket(c,l,i,r){switch(l){case 50:return d.bindComplete;case 49:return d.parseComplete;case 51:return d.closeComplete;case 110:return d.noData;case 115:return d.portalSuspended;case 99:return d.copyDone;case 87:return d.replicationStart;case 73:return d.emptyQuery;case 68:return this.parseDataRowMessage(c,i,r);case 67:return this.parseCommandCompleteMessage(c,i,r);case 90:return this.parseReadyForQueryMessage(c,i,r);case 65:return this.parseNotificationMessage(c,i,r);case 82:return this.parseAuthenticationResponse(c,i,r);case 83:return this.parseParameterStatusMessage(c,i,r);case 75:return this.parseBackendKeyData(c,i,r);case 69:return this.parseErrorMessage(c,i,r,"error");case 78:return this.parseErrorMessage(c,i,r,"notice");case 84:return this.parseRowDescriptionMessage(c,i,r);case 116:return this.parseParameterDescriptionMessage(c,i,r);case 71:return this.parseCopyInMessage(c,i,r);case 72:return this.parseCopyOutMessage(c,i,r);case 100:return this.parseCopyData(c,i,r);default:return new d.DatabaseError("received invalid response: "+l.toString(16),i,"error")}}parseReadyForQueryMessage(c,l,i){this.reader.setBuffer(c,i);const r=this.reader.string(1);return new d.ReadyForQueryMessage(l,r)}parseCommandCompleteMessage(c,l,i){this.reader.setBuffer(c,i);const r=this.reader.cstring();return new d.CommandCompleteMessage(l,r)}parseCopyData(c,l,i){const r=i.slice(c,c+(l-4));return new d.CopyDataMessage(l,r)}parseCopyInMessage(c,l,i){return this.parseCopyMessage(c,l,i,"copyInResponse")}parseCopyOutMessage(c,l,i){return this.parseCopyMessage(c,l,i,"copyOutResponse")}parseCopyMessage(c,l,i,r){this.reader.setBuffer(c,i);const n=this.reader.byte()!==0,a=this.reader.int16(),p=new d.CopyResponse(l,r,n,a);for(let E=0;E<a;E++)p.columnTypes[E]=this.reader.int16();return p}parseNotificationMessage(c,l,i){this.reader.setBuffer(c,i);const r=this.reader.int32(),n=this.reader.cstring(),a=this.reader.cstring();return new d.NotificationResponseMessage(l,r,n,a)}parseRowDescriptionMessage(c,l,i){this.reader.setBuffer(c,i);const r=this.reader.int16(),n=new d.RowDescriptionMessage(l,r);for(let a=0;a<r;a++)n.fields[a]=this.parseField();return n}parseField(){const c=this.reader.cstring(),l=this.reader.uint32(),i=this.reader.int16(),r=this.reader.uint32(),n=this.reader.int16(),a=this.reader.int32(),p=this.reader.int16()===0?"text":"binary";return new d.Field(c,l,i,r,n,a,p)}parseParameterDescriptionMessage(c,l,i){this.reader.setBuffer(c,i);const r=this.reader.int16(),n=new d.ParameterDescriptionMessage(l,r);for(let a=0;a<r;a++)n.dataTypeIDs[a]=this.reader.int32();return n}parseDataRowMessage(c,l,i){this.reader.setBuffer(c,i);const r=this.reader.int16(),n=new Array(r);for(let a=0;a<r;a++){const p=this.reader.int32();n[a]=p===-1?null:this.reader.string(p)}return new d.DataRowMessage(l,n)}parseParameterStatusMessage(c,l,i){this.reader.setBuffer(c,i);const r=this.reader.cstring(),n=this.reader.cstring();return new d.ParameterStatusMessage(l,r,n)}parseBackendKeyData(c,l,i){this.reader.setBuffer(c,i);const r=this.reader.int32(),n=this.reader.int32();return new d.BackendKeyDataMessage(l,r,n)}parseAuthenticationResponse(c,l,i){this.reader.setBuffer(c,i);const r=this.reader.int32(),n={name:"authenticationOk",length:l};switch(r){case 0:break;case 3:n.length===8&&(n.name="authenticationCleartextPassword");break;case 5:if(n.length===12){n.name="authenticationMD5Password";const a=this.reader.bytes(4);return new d.AuthenticationMD5Password(l,a)}break;case 10:{n.name="authenticationSASL",n.mechanisms=[];let a;do a=this.reader.cstring(),a&&n.mechanisms.push(a);while(a)}break;case 11:n.name="authenticationSASLContinue",n.data=this.reader.string(l-8);break;case 12:n.name="authenticationSASLFinal",n.data=this.reader.string(l-8);break;default:throw new Error("Unknown authenticationOk message type "+r)}return n}parseErrorMessage(c,l,i,r){this.reader.setBuffer(c,i);const n={};let a=this.reader.string(1);for(;a!=="\0";)n[a]=this.reader.cstring(),a=this.reader.string(1);const p=n.M,E=r==="notice"?new d.NoticeMessage(l,p):new d.DatabaseError(p,l,r);return E.severity=n.S,E.code=n.C,E.detail=n.D,E.hint=n.H,E.position=n.P,E.internalPosition=n.p,E.internalQuery=n.q,E.where=n.W,E.schema=n.s,E.table=n.t,E.column=n.c,E.dataType=n.d,E.constraint=n.n,E.file=n.F,E.line=n.L,E.routine=n.R,E}}return re.Parser=o,re}var Nt;function sr(){return Nt||(Nt=1,function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.DatabaseError=d.serialize=d.parse=void 0;const y=ir();Object.defineProperty(d,"DatabaseError",{enumerable:!0,get:function(){return y.DatabaseError}});const w=Br();Object.defineProperty(d,"serialize",{enumerable:!0,get:function(){return w.serialize}});const _=Dr();function m(h,o){const s=new _.Parser;return h.on("data",c=>s.parse(c,o)),new Promise(c=>h.on("end",()=>c()))}d.parse=m}(ke)),ke}var ce={},Ft;function Ur(){return Ft||(Ft=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.default={}),ce}var qe,Bt;function kr(){if(Bt)return qe;Bt=1;const{getStream:d,getSecureStream:y}=h();qe={getStream:d,getSecureStream:y};function w(){function o(c){const l=Y;return new l.Socket}function s(c){return Y.connect(c)}return{getStream:o,getSecureStream:s}}function _(){function o(c){const{CloudflareSocket:l}=Ur();return new l(c)}function s(c){return c.socket.startTls(c),c.socket}return{getStream:o,getSecureStream:s}}function m(){if(typeof navigator=="object"&&navigator!==null&&typeof navigator.userAgent=="string")return navigator.userAgent==="Cloudflare-Workers";if(typeof Response=="function"){const o=new Response(null,{cf:{thing:!0}});if(typeof o.cf=="object"&&o.cf!==null&&o.cf.thing)return!0}return!1}function h(){return m()?_():w()}return qe}var Qe,Ot;function ar(){if(Ot)return Qe;Ot=1;const d=Y.EventEmitter,{parse:y,serialize:w}=sr(),{getStream:_,getSecureStream:m}=kr(),h=w.flush(),o=w.sync(),s=w.end();class c extends d{constructor(i){super(),i=i||{},this.stream=i.stream||_(i.ssl),typeof this.stream=="function"&&(this.stream=this.stream(i)),this._keepAlive=i.keepAlive,this._keepAliveInitialDelayMillis=i.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=i.ssl||!1,this._ending=!1,this._emitMessage=!1;const r=this;this.on("newListener",function(n){n==="message"&&(r._emitMessage=!0)})}connect(i,r){const n=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(i,r),this.stream.once("connect",function(){n._keepAlive&&n.stream.setKeepAlive(!0,n._keepAliveInitialDelayMillis),n.emit("connect")});const a=function(p){n._ending&&(p.code==="ECONNRESET"||p.code==="EPIPE")||n.emit("error",p)};if(this.stream.on("error",a),this.stream.on("close",function(){n.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(p){switch(p.toString("utf8")){case"S":break;case"N":return n.stream.end(),n.emit("error",new Error("The server does not support SSL connections"));default:return n.stream.end(),n.emit("error",new Error("There was an error establishing an SSL connection"))}const v={socket:n.stream};n.ssl!==!0&&(Object.assign(v,n.ssl),"key"in n.ssl&&(v.key=n.ssl.key));const g=Y;g.isIP&&g.isIP(r)===0&&(v.servername=r);try{n.stream=m(v)}catch(b){return n.emit("error",b)}n.attachListeners(n.stream),n.stream.on("error",a),n.emit("sslconnect")})}attachListeners(i){y(i,r=>{const n=r.name==="error"?"errorMessage":r.name;this._emitMessage&&this.emit("message",r),this.emit(n,r)})}requestSsl(){this.stream.write(w.requestSsl())}startup(i){this.stream.write(w.startup(i))}cancel(i,r){this._send(w.cancel(i,r))}password(i){this._send(w.password(i))}sendSASLInitialResponseMessage(i,r){this._send(w.sendSASLInitialResponseMessage(i,r))}sendSCRAMClientFinalMessage(i){this._send(w.sendSCRAMClientFinalMessage(i))}_send(i){return this.stream.writable?this.stream.write(i):!1}query(i){this._send(w.query(i))}parse(i){this._send(w.parse(i))}bind(i){this._send(w.bind(i))}execute(i){this._send(w.execute(i))}flush(){this.stream.writable&&this.stream.write(h)}sync(){this._ending=!0,this._send(o)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(s,()=>{this.stream.end()})}close(i){this._send(w.close(i))}describe(i){this._send(w.describe(i))}sendCopyFromChunk(i){this._send(w.copyData(i))}endCopyFrom(){this._send(w.copyDone())}sendCopyFail(i){this._send(w.copyFail(i))}}return Qe=c,Qe}var he={exports:{}},He={exports:{}},Ge={},le={exports:{}},Ye={},ie={},Dt;function qr(){if(Dt)return ie;Dt=1,ie.byteLength=s,ie.toByteArray=l,ie.fromByteArray=n;for(var d=[],y=[],w=typeof Uint8Array<"u"?Uint8Array:Array,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0,h=_.length;m<h;++m)d[m]=_[m],y[_.charCodeAt(m)]=m;y[45]=62,y[95]=63;function o(a){var p=a.length;if(p%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var E=a.indexOf("=");E===-1&&(E=p);var v=E===p?0:4-E%4;return[E,v]}function s(a){var p=o(a),E=p[0],v=p[1];return(E+v)*3/4-v}function c(a,p,E){return(p+E)*3/4-E}function l(a){var p,E=o(a),v=E[0],g=E[1],b=new w(c(a,v,g)),R=0,L=g>0?v-4:v,C;for(C=0;C<L;C+=4)p=y[a.charCodeAt(C)]<<18|y[a.charCodeAt(C+1)]<<12|y[a.charCodeAt(C+2)]<<6|y[a.charCodeAt(C+3)],b[R++]=p>>16&255,b[R++]=p>>8&255,b[R++]=p&255;return g===2&&(p=y[a.charCodeAt(C)]<<2|y[a.charCodeAt(C+1)]>>4,b[R++]=p&255),g===1&&(p=y[a.charCodeAt(C)]<<10|y[a.charCodeAt(C+1)]<<4|y[a.charCodeAt(C+2)]>>2,b[R++]=p>>8&255,b[R++]=p&255),b}function i(a){return d[a>>18&63]+d[a>>12&63]+d[a>>6&63]+d[a&63]}function r(a,p,E){for(var v,g=[],b=p;b<E;b+=3)v=(a[b]<<16&16711680)+(a[b+1]<<8&65280)+(a[b+2]&255),g.push(i(v));return g.join("")}function n(a){for(var p,E=a.length,v=E%3,g=[],b=16383,R=0,L=E-v;R<L;R+=b)g.push(r(a,R,R+b>L?L:R+b));return v===1?(p=a[E-1],g.push(d[p>>2]+d[p<<4&63]+"==")):v===2&&(p=(a[E-2]<<8)+a[E-1],g.push(d[p>>10]+d[p>>4&63]+d[p<<2&63]+"=")),g.join("")}return ie}var fe={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Ut;function Qr(){return Ut||(Ut=1,fe.read=function(d,y,w,_,m){var h,o,s=m*8-_-1,c=(1<<s)-1,l=c>>1,i=-7,r=w?m-1:0,n=w?-1:1,a=d[y+r];for(r+=n,h=a&(1<<-i)-1,a>>=-i,i+=s;i>0;h=h*256+d[y+r],r+=n,i-=8);for(o=h&(1<<-i)-1,h>>=-i,i+=_;i>0;o=o*256+d[y+r],r+=n,i-=8);if(h===0)h=1-l;else{if(h===c)return o?NaN:(a?-1:1)*(1/0);o=o+Math.pow(2,_),h=h-l}return(a?-1:1)*o*Math.pow(2,h-_)},fe.write=function(d,y,w,_,m,h){var o,s,c,l=h*8-m-1,i=(1<<l)-1,r=i>>1,n=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,a=_?0:h-1,p=_?1:-1,E=y<0||y===0&&1/y<0?1:0;for(y=Math.abs(y),isNaN(y)||y===1/0?(s=isNaN(y)?1:0,o=i):(o=Math.floor(Math.log(y)/Math.LN2),y*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+r>=1?y+=n/c:y+=n*Math.pow(2,1-r),y*c>=2&&(o++,c/=2),o+r>=i?(s=0,o=i):o+r>=1?(s=(y*c-1)*Math.pow(2,m),o=o+r):(s=y*Math.pow(2,r-1)*Math.pow(2,m),o=0));m>=8;d[w+a]=s&255,a+=p,s/=256,m-=8);for(o=o<<m|s,l+=m;l>0;d[w+a]=o&255,a+=p,o/=256,l-=8);d[w+a-p]|=E*128}),fe}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var kt;function Hr(){return kt||(kt=1,function(d){var y=qr(),w=Qr(),_=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;d.Buffer=s,d.SlowBuffer=b,d.INSPECT_MAX_BYTES=50;var m=2147483647;d.kMaxLength=m,s.TYPED_ARRAY_SUPPORT=h(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function h(){try{var u=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(u,e),u.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function o(u){if(u>m)throw new RangeError('The value "'+u+'" is invalid for option "size"');var e=new Uint8Array(u);return Object.setPrototypeOf(e,s.prototype),e}function s(u,e,t){if(typeof u=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return r(u)}return c(u,e,t)}s.poolSize=8192;function c(u,e,t){if(typeof u=="string")return n(u,e);if(ArrayBuffer.isView(u))return p(u);if(u==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof u);if(J(u,ArrayBuffer)||u&&J(u.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(J(u,SharedArrayBuffer)||u&&J(u.buffer,SharedArrayBuffer)))return E(u,e,t);if(typeof u=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var f=u.valueOf&&u.valueOf();if(f!=null&&f!==u)return s.from(f,e,t);var S=v(u);if(S)return S;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof u[Symbol.toPrimitive]=="function")return s.from(u[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof u)}s.from=function(u,e,t){return c(u,e,t)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function l(u){if(typeof u!="number")throw new TypeError('"size" argument must be of type number');if(u<0)throw new RangeError('The value "'+u+'" is invalid for option "size"')}function i(u,e,t){return l(u),u<=0?o(u):e!==void 0?typeof t=="string"?o(u).fill(e,t):o(u).fill(e):o(u)}s.alloc=function(u,e,t){return i(u,e,t)};function r(u){return l(u),o(u<0?0:g(u)|0)}s.allocUnsafe=function(u){return r(u)},s.allocUnsafeSlow=function(u){return r(u)};function n(u,e){if((typeof e!="string"||e==="")&&(e="utf8"),!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var t=R(u,e)|0,f=o(t),S=f.write(u,e);return S!==t&&(f=f.slice(0,S)),f}function a(u){for(var e=u.length<0?0:g(u.length)|0,t=o(e),f=0;f<e;f+=1)t[f]=u[f]&255;return t}function p(u){if(J(u,Uint8Array)){var e=new Uint8Array(u);return E(e.buffer,e.byteOffset,e.byteLength)}return a(u)}function E(u,e,t){if(e<0||u.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(u.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');var f;return e===void 0&&t===void 0?f=new Uint8Array(u):t===void 0?f=new Uint8Array(u,e):f=new Uint8Array(u,e,t),Object.setPrototypeOf(f,s.prototype),f}function v(u){if(s.isBuffer(u)){var e=g(u.length)|0,t=o(e);return t.length===0||u.copy(t,0,0,e),t}if(u.length!==void 0)return typeof u.length!="number"||ye(u.length)?o(0):a(u);if(u.type==="Buffer"&&Array.isArray(u.data))return a(u.data)}function g(u){if(u>=m)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+m.toString(16)+" bytes");return u|0}function b(u){return+u!=u&&(u=0),s.alloc(+u)}s.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==s.prototype},s.compare=function(e,t){if(J(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var f=e.length,S=t.length,T=0,x=Math.min(f,S);T<x;++T)if(e[T]!==t[T]){f=e[T],S=t[T];break}return f<S?-1:S<f?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return s.alloc(0);var f;if(t===void 0)for(t=0,f=0;f<e.length;++f)t+=e[f].length;var S=s.allocUnsafe(t),T=0;for(f=0;f<e.length;++f){var x=e[f];if(J(x,Uint8Array))T+x.length>S.length?s.from(x).copy(S,T):Uint8Array.prototype.set.call(S,x,T);else if(s.isBuffer(x))x.copy(S,T);else throw new TypeError('"list" argument must be an Array of Buffers');T+=x.length}return S};function R(u,e){if(s.isBuffer(u))return u.length;if(ArrayBuffer.isView(u)||J(u,ArrayBuffer))return u.byteLength;if(typeof u!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof u);var t=u.length,f=arguments.length>2&&arguments[2]===!0;if(!f&&t===0)return 0;for(var S=!1;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return me(u).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return rt(u).length;default:if(S)return f?-1:me(u).length;e=(""+e).toLowerCase(),S=!0}}s.byteLength=R;function L(u,e,t){var f=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(u||(u="utf8");;)switch(u){case"hex":return hr(this,e,t);case"utf8":case"utf-8":return B(this,e,t);case"ascii":return j(this,e,t);case"latin1":case"binary":return W(this,e,t);case"base64":return I(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lr(this,e,t);default:if(f)throw new TypeError("Unknown encoding: "+u);u=(u+"").toLowerCase(),f=!0}}s.prototype._isBuffer=!0;function C(u,e,t){var f=u[e];u[e]=u[t],u[t]=f}s.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)C(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)C(this,t,t+3),C(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)C(this,t,t+7),C(this,t+1,t+6),C(this,t+2,t+5),C(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?B(this,0,e):L.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:s.compare(this,e)===0},s.prototype.inspect=function(){var e="",t=d.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},_&&(s.prototype[_]=s.prototype.inspect),s.prototype.compare=function(e,t,f,S,T){if(J(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),f===void 0&&(f=e?e.length:0),S===void 0&&(S=0),T===void 0&&(T=this.length),t<0||f>e.length||S<0||T>this.length)throw new RangeError("out of range index");if(S>=T&&t>=f)return 0;if(S>=T)return-1;if(t>=f)return 1;if(t>>>=0,f>>>=0,S>>>=0,T>>>=0,this===e)return 0;for(var x=T-S,D=f-t,k=Math.min(x,D),H=this.slice(S,T),$=e.slice(t,f),G=0;G<k;++G)if(H[G]!==$[G]){x=H[G],D=$[G];break}return x<D?-1:D<x?1:0};function M(u,e,t,f,S){if(u.length===0)return-1;if(typeof t=="string"?(f=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,ye(t)&&(t=S?0:u.length-1),t<0&&(t=u.length+t),t>=u.length){if(S)return-1;t=u.length-1}else if(t<0)if(S)t=0;else return-1;if(typeof e=="string"&&(e=s.from(e,f)),s.isBuffer(e))return e.length===0?-1:A(u,e,t,f,S);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?S?Uint8Array.prototype.indexOf.call(u,e,t):Uint8Array.prototype.lastIndexOf.call(u,e,t):A(u,[e],t,f,S);throw new TypeError("val must be string, number or Buffer")}function A(u,e,t,f,S){var T=1,x=u.length,D=e.length;if(f!==void 0&&(f=String(f).toLowerCase(),f==="ucs2"||f==="ucs-2"||f==="utf16le"||f==="utf-16le")){if(u.length<2||e.length<2)return-1;T=2,x/=2,D/=2,t/=2}function k(nt,it){return T===1?nt[it]:nt.readUInt16BE(it*T)}var H;if(S){var $=-1;for(H=t;H<x;H++)if(k(u,H)===k(e,$===-1?0:H-$)){if($===-1&&($=H),H-$+1===D)return $*T}else $!==-1&&(H-=H-$),$=-1}else for(t+D>x&&(t=x-D),H=t;H>=0;H--){for(var G=!0,oe=0;oe<D;oe++)if(k(u,H+oe)!==k(e,oe)){G=!1;break}if(G)return H}return-1}s.prototype.includes=function(e,t,f){return this.indexOf(e,t,f)!==-1},s.prototype.indexOf=function(e,t,f){return M(this,e,t,f,!0)},s.prototype.lastIndexOf=function(e,t,f){return M(this,e,t,f,!1)};function P(u,e,t,f){t=Number(t)||0;var S=u.length-t;f?(f=Number(f),f>S&&(f=S)):f=S;var T=e.length;f>T/2&&(f=T/2);for(var x=0;x<f;++x){var D=parseInt(e.substr(x*2,2),16);if(ye(D))return x;u[t+x]=D}return x}function N(u,e,t,f){return ae(me(e,u.length-t),u,t,f)}function Q(u,e,t,f){return ae(dr(e),u,t,f)}function O(u,e,t,f){return ae(rt(e),u,t,f)}function K(u,e,t,f){return ae(mr(e,u.length-t),u,t,f)}s.prototype.write=function(e,t,f,S){if(t===void 0)S="utf8",f=this.length,t=0;else if(f===void 0&&typeof t=="string")S=t,f=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(f)?(f=f>>>0,S===void 0&&(S="utf8")):(S=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var T=this.length-t;if((f===void 0||f>T)&&(f=T),e.length>0&&(f<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");S||(S="utf8");for(var x=!1;;)switch(S){case"hex":return P(this,e,t,f);case"utf8":case"utf-8":return N(this,e,t,f);case"ascii":case"latin1":case"binary":return Q(this,e,t,f);case"base64":return O(this,e,t,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,e,t,f);default:if(x)throw new TypeError("Unknown encoding: "+S);S=(""+S).toLowerCase(),x=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(u,e,t){return e===0&&t===u.length?y.fromByteArray(u):y.fromByteArray(u.slice(e,t))}function B(u,e,t){t=Math.min(u.length,t);for(var f=[],S=e;S<t;){var T=u[S],x=null,D=T>239?4:T>223?3:T>191?2:1;if(S+D<=t){var k,H,$,G;switch(D){case 1:T<128&&(x=T);break;case 2:k=u[S+1],(k&192)===128&&(G=(T&31)<<6|k&63,G>127&&(x=G));break;case 3:k=u[S+1],H=u[S+2],(k&192)===128&&(H&192)===128&&(G=(T&15)<<12|(k&63)<<6|H&63,G>2047&&(G<55296||G>57343)&&(x=G));break;case 4:k=u[S+1],H=u[S+2],$=u[S+3],(k&192)===128&&(H&192)===128&&($&192)===128&&(G=(T&15)<<18|(k&63)<<12|(H&63)<<6|$&63,G>65535&&G<1114112&&(x=G))}}x===null?(x=65533,D=1):x>65535&&(x-=65536,f.push(x>>>10&1023|55296),x=56320|x&1023),f.push(x),S+=D}return q(f)}var U=4096;function q(u){var e=u.length;if(e<=U)return String.fromCharCode.apply(String,u);for(var t="",f=0;f<e;)t+=String.fromCharCode.apply(String,u.slice(f,f+=U));return t}function j(u,e,t){var f="";t=Math.min(u.length,t);for(var S=e;S<t;++S)f+=String.fromCharCode(u[S]&127);return f}function W(u,e,t){var f="";t=Math.min(u.length,t);for(var S=e;S<t;++S)f+=String.fromCharCode(u[S]);return f}function hr(u,e,t){var f=u.length;(!e||e<0)&&(e=0),(!t||t<0||t>f)&&(t=f);for(var S="",T=e;T<t;++T)S+=yr[u[T]];return S}function lr(u,e,t){for(var f=u.slice(e,t),S="",T=0;T<f.length-1;T+=2)S+=String.fromCharCode(f[T]+f[T+1]*256);return S}s.prototype.slice=function(e,t){var f=this.length;e=~~e,t=t===void 0?f:~~t,e<0?(e+=f,e<0&&(e=0)):e>f&&(e=f),t<0?(t+=f,t<0&&(t=0)):t>f&&(t=f),t<e&&(t=e);var S=this.subarray(e,t);return Object.setPrototypeOf(S,s.prototype),S};function V(u,e,t){if(u%1!==0||u<0)throw new RangeError("offset is not uint");if(u+e>t)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,f){e=e>>>0,t=t>>>0,f||V(e,t,this.length);for(var S=this[e],T=1,x=0;++x<t&&(T*=256);)S+=this[e+x]*T;return S},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,f){e=e>>>0,t=t>>>0,f||V(e,t,this.length);for(var S=this[e+--t],T=1;t>0&&(T*=256);)S+=this[e+--t]*T;return S},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e=e>>>0,t||V(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||V(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||V(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||V(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||V(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,f){e=e>>>0,t=t>>>0,f||V(e,t,this.length);for(var S=this[e],T=1,x=0;++x<t&&(T*=256);)S+=this[e+x]*T;return T*=128,S>=T&&(S-=Math.pow(2,8*t)),S},s.prototype.readIntBE=function(e,t,f){e=e>>>0,t=t>>>0,f||V(e,t,this.length);for(var S=t,T=1,x=this[e+--S];S>0&&(T*=256);)x+=this[e+--S]*T;return T*=128,x>=T&&(x-=Math.pow(2,8*t)),x},s.prototype.readInt8=function(e,t){return e=e>>>0,t||V(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},s.prototype.readInt16LE=function(e,t){e=e>>>0,t||V(e,2,this.length);var f=this[e]|this[e+1]<<8;return f&32768?f|4294901760:f},s.prototype.readInt16BE=function(e,t){e=e>>>0,t||V(e,2,this.length);var f=this[e+1]|this[e]<<8;return f&32768?f|4294901760:f},s.prototype.readInt32LE=function(e,t){return e=e>>>0,t||V(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e=e>>>0,t||V(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e=e>>>0,t||V(e,4,this.length),w.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e=e>>>0,t||V(e,4,this.length),w.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||V(e,8,this.length),w.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||V(e,8,this.length),w.read(this,e,!1,52,8)};function X(u,e,t,f,S,T){if(!s.isBuffer(u))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>S||e<T)throw new RangeError('"value" argument is out of bounds');if(t+f>u.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,f,S){if(e=+e,t=t>>>0,f=f>>>0,!S){var T=Math.pow(2,8*f)-1;X(this,e,t,f,T,0)}var x=1,D=0;for(this[t]=e&255;++D<f&&(x*=256);)this[t+D]=e/x&255;return t+f},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,f,S){if(e=+e,t=t>>>0,f=f>>>0,!S){var T=Math.pow(2,8*f)-1;X(this,e,t,f,T,0)}var x=f-1,D=1;for(this[t+x]=e&255;--x>=0&&(D*=256);)this[t+x]=e/D&255;return t+f},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,f){return e=+e,t=t>>>0,f||X(this,e,t,1,255,0),this[t]=e&255,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,f){return e=+e,t=t>>>0,f||X(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,f){return e=+e,t=t>>>0,f||X(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,f){return e=+e,t=t>>>0,f||X(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,f){return e=+e,t=t>>>0,f||X(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},s.prototype.writeIntLE=function(e,t,f,S){if(e=+e,t=t>>>0,!S){var T=Math.pow(2,8*f-1);X(this,e,t,f,T-1,-T)}var x=0,D=1,k=0;for(this[t]=e&255;++x<f&&(D*=256);)e<0&&k===0&&this[t+x-1]!==0&&(k=1),this[t+x]=(e/D>>0)-k&255;return t+f},s.prototype.writeIntBE=function(e,t,f,S){if(e=+e,t=t>>>0,!S){var T=Math.pow(2,8*f-1);X(this,e,t,f,T-1,-T)}var x=f-1,D=1,k=0;for(this[t+x]=e&255;--x>=0&&(D*=256);)e<0&&k===0&&this[t+x+1]!==0&&(k=1),this[t+x]=(e/D>>0)-k&255;return t+f},s.prototype.writeInt8=function(e,t,f){return e=+e,t=t>>>0,f||X(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},s.prototype.writeInt16LE=function(e,t,f){return e=+e,t=t>>>0,f||X(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,f){return e=+e,t=t>>>0,f||X(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},s.prototype.writeInt32LE=function(e,t,f){return e=+e,t=t>>>0,f||X(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,f){return e=+e,t=t>>>0,f||X(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function Ze(u,e,t,f,S,T){if(t+f>u.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function et(u,e,t,f,S){return e=+e,t=t>>>0,S||Ze(u,e,t,4),w.write(u,e,t,f,23,4),t+4}s.prototype.writeFloatLE=function(e,t,f){return et(this,e,t,!0,f)},s.prototype.writeFloatBE=function(e,t,f){return et(this,e,t,!1,f)};function tt(u,e,t,f,S){return e=+e,t=t>>>0,S||Ze(u,e,t,8),w.write(u,e,t,f,52,8),t+8}s.prototype.writeDoubleLE=function(e,t,f){return tt(this,e,t,!0,f)},s.prototype.writeDoubleBE=function(e,t,f){return tt(this,e,t,!1,f)},s.prototype.copy=function(e,t,f,S){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(f||(f=0),!S&&S!==0&&(S=this.length),t>=e.length&&(t=e.length),t||(t=0),S>0&&S<f&&(S=f),S===f||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(S<0)throw new RangeError("sourceEnd out of bounds");S>this.length&&(S=this.length),e.length-t<S-f&&(S=e.length-t+f);var T=S-f;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,f,S):Uint8Array.prototype.set.call(e,this.subarray(f,S),t),T},s.prototype.fill=function(e,t,f,S){if(typeof e=="string"){if(typeof t=="string"?(S=t,t=0,f=this.length):typeof f=="string"&&(S=f,f=this.length),S!==void 0&&typeof S!="string")throw new TypeError("encoding must be a string");if(typeof S=="string"&&!s.isEncoding(S))throw new TypeError("Unknown encoding: "+S);if(e.length===1){var T=e.charCodeAt(0);(S==="utf8"&&T<128||S==="latin1")&&(e=T)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<f)throw new RangeError("Out of range index");if(f<=t)return this;t=t>>>0,f=f===void 0?this.length:f>>>0,e||(e=0);var x;if(typeof e=="number")for(x=t;x<f;++x)this[x]=e;else{var D=s.isBuffer(e)?e:s.from(e,S),k=D.length;if(k===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(x=0;x<f-t;++x)this[x+t]=D[x%k]}return this};var fr=/[^+/0-9A-Za-z-_]/g;function pr(u){if(u=u.split("=")[0],u=u.trim().replace(fr,""),u.length<2)return"";for(;u.length%4!==0;)u=u+"=";return u}function me(u,e){e=e||1/0;for(var t,f=u.length,S=null,T=[],x=0;x<f;++x){if(t=u.charCodeAt(x),t>55295&&t<57344){if(!S){if(t>56319){(e-=3)>-1&&T.push(239,191,189);continue}else if(x+1===f){(e-=3)>-1&&T.push(239,191,189);continue}S=t;continue}if(t<56320){(e-=3)>-1&&T.push(239,191,189),S=t;continue}t=(S-55296<<10|t-56320)+65536}else S&&(e-=3)>-1&&T.push(239,191,189);if(S=null,t<128){if((e-=1)<0)break;T.push(t)}else if(t<2048){if((e-=2)<0)break;T.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;T.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;T.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return T}function dr(u){for(var e=[],t=0;t<u.length;++t)e.push(u.charCodeAt(t)&255);return e}function mr(u,e){for(var t,f,S,T=[],x=0;x<u.length&&!((e-=2)<0);++x)t=u.charCodeAt(x),f=t>>8,S=t%256,T.push(S),T.push(f);return T}function rt(u){return y.toByteArray(pr(u))}function ae(u,e,t,f){for(var S=0;S<f&&!(S+t>=e.length||S>=u.length);++S)e[S+t]=u[S];return S}function J(u,e){return u instanceof e||u!=null&&u.constructor!=null&&u.constructor.name!=null&&u.constructor.name===e.name}function ye(u){return u!==u}var yr=function(){for(var u="0123456789abcdef",e=new Array(256),t=0;t<16;++t)for(var f=t*16,S=0;S<16;++S)e[f+S]=u[t]+u[S];return e}()}(Ye)),Ye}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var qt;function Gr(){return qt||(qt=1,function(d,y){var w=Hr(),_=w.Buffer;function m(o,s){for(var c in o)s[c]=o[c]}_.from&&_.alloc&&_.allocUnsafe&&_.allocUnsafeSlow?d.exports=w:(m(w,y),y.Buffer=h);function h(o,s,c){return _(o,s,c)}h.prototype=Object.create(_.prototype),m(_,h),h.from=function(o,s,c){if(typeof o=="number")throw new TypeError("Argument must not be a number");return _(o,s,c)},h.alloc=function(o,s,c){if(typeof o!="number")throw new TypeError("Argument must be a number");var l=_(o);return s!==void 0?typeof c=="string"?l.fill(s,c):l.fill(s):l.fill(0),l},h.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return _(o)},h.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return w.SlowBuffer(o)}}(le,le.exports)),le.exports}var Qt;function Yr(){if(Qt)return Ge;Qt=1;var d=Gr().Buffer,y=d.isEncoding||function(g){switch(g=""+g,g&&g.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function w(g){if(!g)return"utf8";for(var b;;)switch(g){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return g;default:if(b)return;g=(""+g).toLowerCase(),b=!0}}function _(g){var b=w(g);if(typeof b!="string"&&(d.isEncoding===y||!y(g)))throw new Error("Unknown encoding: "+g);return b||g}Ge.StringDecoder=m;function m(g){this.encoding=_(g);var b;switch(this.encoding){case"utf16le":this.text=r,this.end=n,b=4;break;case"utf8":this.fillLast=c,b=4;break;case"base64":this.text=a,this.end=p,b=3;break;default:this.write=E,this.end=v;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=d.allocUnsafe(b)}m.prototype.write=function(g){if(g.length===0)return"";var b,R;if(this.lastNeed){if(b=this.fillLast(g),b===void 0)return"";R=this.lastNeed,this.lastNeed=0}else R=0;return R<g.length?b?b+this.text(g,R):this.text(g,R):b||""},m.prototype.end=i,m.prototype.text=l,m.prototype.fillLast=function(g){if(this.lastNeed<=g.length)return g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,g.length),this.lastNeed-=g.length};function h(g){return g<=127?0:g>>5===6?2:g>>4===14?3:g>>3===30?4:g>>6===2?-1:-2}function o(g,b,R){var L=b.length-1;if(L<R)return 0;var C=h(b[L]);return C>=0?(C>0&&(g.lastNeed=C-1),C):--L<R||C===-2?0:(C=h(b[L]),C>=0?(C>0&&(g.lastNeed=C-2),C):--L<R||C===-2?0:(C=h(b[L]),C>=0?(C>0&&(C===2?C=0:g.lastNeed=C-3),C):0))}function s(g,b,R){if((b[0]&192)!==128)return g.lastNeed=0,"";if(g.lastNeed>1&&b.length>1){if((b[1]&192)!==128)return g.lastNeed=1,"";if(g.lastNeed>2&&b.length>2&&(b[2]&192)!==128)return g.lastNeed=2,""}}function c(g){var b=this.lastTotal-this.lastNeed,R=s(this,g);if(R!==void 0)return R;if(this.lastNeed<=g.length)return g.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);g.copy(this.lastChar,b,0,g.length),this.lastNeed-=g.length}function l(g,b){var R=o(this,g,b);if(!this.lastNeed)return g.toString("utf8",b);this.lastTotal=R;var L=g.length-(R-this.lastNeed);return g.copy(this.lastChar,0,L),g.toString("utf8",b,L)}function i(g){var b=g&&g.length?this.write(g):"";return this.lastNeed?b+"":b}function r(g,b){if((g.length-b)%2===0){var R=g.toString("utf16le",b);if(R){var L=R.charCodeAt(R.length-1);if(L>=55296&&L<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1],R.slice(0,-1)}return R}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=g[g.length-1],g.toString("utf16le",b,g.length-1)}function n(g){var b=g&&g.length?this.write(g):"";if(this.lastNeed){var R=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,R)}return b}function a(g,b){var R=(g.length-b)%3;return R===0?g.toString("base64",b):(this.lastNeed=3-R,this.lastTotal=3,R===1?this.lastChar[0]=g[g.length-1]:(this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1]),g.toString("base64",b,g.length-R))}function p(g){var b=g&&g.length?this.write(g):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function E(g){return g.toString(this.encoding)}function v(g){return g&&g.length?this.write(g):""}return Ge}var je,Ht;function jr(){if(Ht)return je;Ht=1;const{Transform:d}=Y,{StringDecoder:y}=Yr(),w=Symbol("last"),_=Symbol("decoder");function m(l,i,r){let n;if(this.overflow){if(n=this[_].write(l).split(this.matcher),n.length===1)return r();n.shift(),this.overflow=!1}else this[w]+=this[_].write(l),n=this[w].split(this.matcher);this[w]=n.pop();for(let a=0;a<n.length;a++)try{o(this,this.mapper(n[a]))}catch(p){return r(p)}if(this.overflow=this[w].length>this.maxLength,this.overflow&&!this.skipOverflow){r(new Error("maximum buffer reached"));return}r()}function h(l){if(this[w]+=this[_].end(),this[w])try{o(this,this.mapper(this[w]))}catch(i){return l(i)}l()}function o(l,i){i!==void 0&&l.push(i)}function s(l){return l}function c(l,i,r){switch(l=l||/\r?\n/,i=i||s,r=r||{},arguments.length){case 1:typeof l=="function"?(i=l,l=/\r?\n/):typeof l=="object"&&!(l instanceof RegExp)&&!l[Symbol.split]&&(r=l,l=/\r?\n/);break;case 2:typeof l=="function"?(r=i,i=l,l=/\r?\n/):typeof i=="object"&&(r=i,i=s)}r=Object.assign({},r),r.autoDestroy=!0,r.transform=m,r.flush=h,r.readableObjectMode=!0;const n=new d(r);return n[w]="",n[_]=new y("utf8"),n.matcher=l,n.mapper=i,n.maxLength=r.maxLength,n.skipOverflow=r.skipOverflow||!1,n.overflow=!1,n._destroy=function(a,p){this._writableState.errorEmitted=!1,p(a)},n}return je=c,je}var Gt;function Vr(){return Gt||(Gt=1,function(d){var y={},w=Y,_=Y.Stream,m=jr(),h=Y,o=5432,s=process.platform==="win32",c=process.stderr,l=56,i=7,r=61440,n=32768;function a(C){return(C&r)==n}var p=["host","port","database","user","password"],E=p.length,v=p[E-1];function g(){var C=c instanceof _&&c.writable===!0;if(C){var M=Array.prototype.slice.call(arguments).concat(`
`);c.write(h.format.apply(h,M))}}Object.defineProperty(d.exports,"isWin",{get:function(){return s},set:function(C){s=C}}),d.exports.warnTo=function(C){var M=c;return c=C,M},d.exports.getFileName=function(C){var M=C||y,A=M.PGPASSFILE||(s?w.join(M.APPDATA||"./","postgresql","pgpass.conf"):w.join(M.HOME||"./",".pgpass"));return A},d.exports.usePgPass=function(C,M){return Object.prototype.hasOwnProperty.call(y,"PGPASSWORD")?!1:s?!0:(M=M||"<unkn>",a(C.mode)?C.mode&(l|i)?(g('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',M),!1):!0:(g('WARNING: password file "%s" is not a plain file',M),!1))};var b=d.exports.match=function(C,M){return p.slice(0,-1).reduce(function(A,P,N){return N==1&&Number(C[P]||o)===Number(M[P])?A&&!0:A&&(M[P]==="*"||M[P]===C[P])},!0)};d.exports.getPassword=function(C,M,A){var P,N=M.pipe(m());function Q(I){var B=R(I);B&&L(B)&&b(C,B)&&(P=B[v],N.end())}var O=function(){M.destroy(),A(P)},K=function(I){M.destroy(),g("WARNING: error on reading file: %s",I),A(void 0)};M.on("error",K),N.on("data",Q).on("end",O).on("error",K)};var R=d.exports.parseLine=function(C){if(C.length<11||C.match(/^\s+#/))return null;for(var M="",A="",P=0,N=0,Q={},O=!1,K=function(B,U,q){var j=C.substring(U,q);Object.hasOwnProperty.call(y,"PGPASS_NO_DEESCAPE")||(j=j.replace(/\\([:\\])/g,"$1")),Q[p[B]]=j},I=0;I<C.length-1;I+=1){if(M=C.charAt(I+1),A=C.charAt(I),O=P==E-1,O){K(P,N);break}I>=0&&M==":"&&A!=="\\"&&(K(P,N,I+1),N=I+2,P+=1)}return Q=Object.keys(Q).length===E?Q:null,Q},L=d.exports.isValidEntry=function(C){for(var M={0:function(O){return O.length>0},1:function(O){return O==="*"?!0:(O=Number(O),isFinite(O)&&O>0&&O<9007199254740992&&Math.floor(O)===O)},2:function(O){return O.length>0},3:function(O){return O.length>0},4:function(O){return O.length>0}},A=0;A<p.length;A+=1){var P=M[A],N=C[p[A]]||"",Q=P(N);if(!Q)return!1}return!0}}(He)),He.exports}var Yt;function Kr(){if(Yt)return he.exports;Yt=1;var d=Y,y=Vr();return he.exports=function(w,_){var m=y.getFileName();d.stat(m,function(h,o){if(h||!y.usePgPass(o,m))return _(void 0);var s=d.createReadStream(m);y.getPassword(w,s,_)})},he.exports.warnTo=y.warnTo,he.exports}var Ve,jt;function Wr(){if(jt)return Ve;jt=1;const d=Y.EventEmitter,y=se(),w=Lr(),_=Je(),m=rr(),h=Nr(),o=de(),s=ar(),c=tr();class l extends d{constructor(r){super(),this.connectionParameters=new m(r),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;const n=r||{};this._Promise=n.Promise||ze.Promise,this._types=new _(n.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!n.enableChannelBinding,this.connection=n.connection||new s({stream:n.stream,ssl:this.connectionParameters.ssl,keepAlive:n.keepAlive||!1,keepAliveInitialDelayMillis:n.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=n.binary||o.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=n.connectionTimeoutMillis||0}_errorAllQueries(r){const n=a=>{process.nextTick(()=>{a.handleError(r,this.connection)})};this.activeQuery&&(n(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(n),this.queryQueue.length=0}_connect(r){const n=this,a=this.connection;if(this._connectionCallback=r,this._connecting||this._connected){const p=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{r(p)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{a._ending=!0,a.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?a.connect(this.host+"/.s.PGSQL."+this.port):a.connect(this.port,this.host),a.on("connect",function(){n.ssl?a.requestSsl():a.startup(n.getStartupConf())}),a.on("sslconnect",function(){a.startup(n.getStartupConf())}),this._attachListeners(a),a.once("end",()=>{const p=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(p),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(p):this._handleErrorEvent(p):this._connectionError||this._handleErrorEvent(p)),process.nextTick(()=>{this.emit("end")})})}connect(r){if(r){this._connect(r);return}return new this._Promise((n,a)=>{this._connect(p=>{p?a(p):n()})})}_attachListeners(r){r.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),r.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),r.on("authenticationSASL",this._handleAuthSASL.bind(this)),r.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),r.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),r.on("backendKeyData",this._handleBackendKeyData.bind(this)),r.on("error",this._handleErrorEvent.bind(this)),r.on("errorMessage",this._handleErrorMessage.bind(this)),r.on("readyForQuery",this._handleReadyForQuery.bind(this)),r.on("notice",this._handleNotice.bind(this)),r.on("rowDescription",this._handleRowDescription.bind(this)),r.on("dataRow",this._handleDataRow.bind(this)),r.on("portalSuspended",this._handlePortalSuspended.bind(this)),r.on("emptyQuery",this._handleEmptyQuery.bind(this)),r.on("commandComplete",this._handleCommandComplete.bind(this)),r.on("parseComplete",this._handleParseComplete.bind(this)),r.on("copyInResponse",this._handleCopyInResponse.bind(this)),r.on("copyData",this._handleCopyData.bind(this)),r.on("notification",this._handleNotification.bind(this))}_checkPgPass(r){const n=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(a=>{if(a!==void 0){if(typeof a!="string"){n.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=a}else this.connectionParameters.password=this.password=null;r()}).catch(a=>{n.emit("error",a)});else if(this.password!==null)r();else try{Kr()(this.connectionParameters,p=>{p!==void 0&&(this.connectionParameters.password=this.password=p),r()})}catch(a){this.emit("error",a)}}_handleAuthCleartextPassword(r){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(r){this._checkPgPass(async()=>{try{const n=await c.postgresMd5PasswordHash(this.user,this.password,r.salt);this.connection.password(n)}catch(n){this.emit("error",n)}})}_handleAuthSASL(r){this._checkPgPass(()=>{try{this.saslSession=w.startSession(r.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(n){this.connection.emit("error",n)}})}async _handleAuthSASLContinue(r){try{await w.continueSession(this.saslSession,this.password,r.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(n){this.connection.emit("error",n)}}_handleAuthSASLFinal(r){try{w.finalizeSession(this.saslSession,r.data),this.saslSession=null}catch(n){this.connection.emit("error",n)}}_handleBackendKeyData(r){this.processID=r.processID,this.secretKey=r.secretKey}_handleReadyForQuery(r){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));const{activeQuery:n}=this;this.activeQuery=null,this.readyForQuery=!0,n&&n.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(r){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(r);this.emit("error",r)}}_handleErrorEvent(r){if(this._connecting)return this._handleErrorWhileConnecting(r);this._queryable=!1,this._errorAllQueries(r),this.emit("error",r)}_handleErrorMessage(r){if(this._connecting)return this._handleErrorWhileConnecting(r);const n=this.activeQuery;if(!n){this._handleErrorEvent(r);return}this.activeQuery=null,n.handleError(r,this.connection)}_handleRowDescription(r){this.activeQuery.handleRowDescription(r)}_handleDataRow(r){this.activeQuery.handleDataRow(r)}_handlePortalSuspended(r){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(r){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(r){if(this.activeQuery==null){const n=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(n);return}this.activeQuery.handleCommandComplete(r,this.connection)}_handleParseComplete(){if(this.activeQuery==null){const r=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(r);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(r){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(r){this.activeQuery.handleCopyData(r,this.connection)}_handleNotification(r){this.emit("notification",r)}_handleNotice(r){this.emit("notice",r)}getStartupConf(){const r=this.connectionParameters,n={user:r.user,database:r.database},a=r.application_name||r.fallback_application_name;return a&&(n.application_name=a),r.replication&&(n.replication=""+r.replication),r.statement_timeout&&(n.statement_timeout=String(parseInt(r.statement_timeout,10))),r.lock_timeout&&(n.lock_timeout=String(parseInt(r.lock_timeout,10))),r.idle_in_transaction_session_timeout&&(n.idle_in_transaction_session_timeout=String(parseInt(r.idle_in_transaction_session_timeout,10))),r.options&&(n.options=r.options),n}cancel(r,n){if(r.activeQuery===n){const a=this.connection;this.host&&this.host.indexOf("/")===0?a.connect(this.host+"/.s.PGSQL."+this.port):a.connect(this.port,this.host),a.on("connect",function(){a.cancel(r.processID,r.secretKey)})}else r.queryQueue.indexOf(n)!==-1&&r.queryQueue.splice(r.queryQueue.indexOf(n),1)}setTypeParser(r,n,a){return this._types.setTypeParser(r,n,a)}getTypeParser(r,n){return this._types.getTypeParser(r,n)}escapeIdentifier(r){return y.escapeIdentifier(r)}escapeLiteral(r){return y.escapeLiteral(r)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;const r=this.activeQuery.submit(this.connection);r&&process.nextTick(()=>{this.activeQuery.handleError(r,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(r,n,a){let p,E,v,g,b;if(r==null)throw new TypeError("Client was passed a null or undefined query");return typeof r.submit=="function"?(v=r.query_timeout||this.connectionParameters.query_timeout,E=p=r,typeof n=="function"&&(p.callback=p.callback||n)):(v=r.query_timeout||this.connectionParameters.query_timeout,p=new h(r,n,a),p.callback||(E=new this._Promise((R,L)=>{p.callback=(C,M)=>C?L(C):R(M)}).catch(R=>{throw Error.captureStackTrace(R),R}))),v&&(b=p.callback,g=setTimeout(()=>{const R=new Error("Query read timeout");process.nextTick(()=>{p.handleError(R,this.connection)}),b(R),p.callback=()=>{};const L=this.queryQueue.indexOf(p);L>-1&&this.queryQueue.splice(L,1),this._pulseQueryQueue()},v),p.callback=(R,L)=>{clearTimeout(g),b(R,L)}),this.binary&&!p.binary&&(p.binary=!0),p._result&&!p._result._types&&(p._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{p.handleError(new Error("Client was closed and is not queryable"),this.connection)}),E):(this.queryQueue.push(p),this._pulseQueryQueue(),E):(process.nextTick(()=>{p.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),E)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(r){if(this._ending=!0,!this.connection._connecting||this._ended)if(r)r();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),r)this.connection.once("end",r);else return new this._Promise(n=>{this.connection.once("end",n)})}}return l.Query=h,Ve=l,Ve}var Ke,Vt;function $r(){if(Vt)return Ke;Vt=1;const d=Y.EventEmitter,y=function(){},w=(l,i)=>{const r=l.findIndex(i);return r===-1?void 0:l.splice(r,1)[0]};class _{constructor(i,r,n){this.client=i,this.idleListener=r,this.timeoutId=n}}class m{constructor(i){this.callback=i}}function h(){throw new Error("Release called on client which has already been released to the pool.")}function o(l,i){if(i)return{callback:i,result:void 0};let r,n;const a=function(E,v){E?r(E):n(v)},p=new l(function(E,v){n=E,r=v}).catch(E=>{throw Error.captureStackTrace(E),E});return{callback:a,result:p}}function s(l,i){return function r(n){n.client=i,i.removeListener("error",r),i.on("error",()=>{l.log("additional client error after disconnection due to error",n)}),l._remove(i),l.emit("error",n,i)}}class c extends d{constructor(i,r){super(),this.options=Object.assign({},i),i!=null&&"password"in i&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:i.password}),i!=null&&i.ssl&&i.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||r||or().Client,this.Promise=this.options.Promise||ze.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;const i=this._pendingQueue.shift();if(this._idle.length){const r=this._idle.pop();clearTimeout(r.timeoutId);const n=r.client;n.ref&&n.ref();const a=r.idleListener;return this._acquireClient(n,i,a,!1)}if(!this._isFull())return this.newClient(i);throw new Error("unexpected condition")}_remove(i,r){const n=w(this._idle,p=>p.client===i);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(p=>p!==i);const a=this;i.end(()=>{a.emit("remove",i),typeof r=="function"&&r()})}connect(i){if(this.ending){const a=new Error("Cannot use a pool after calling end on the pool");return i?i(a):this.Promise.reject(a)}const r=o(this.Promise,i),n=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new m(r.callback)),n;const a=(v,g,b)=>{clearTimeout(E),r.callback(v,g,b)},p=new m(a),E=setTimeout(()=>{w(this._pendingQueue,v=>v.callback===a),p.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return E.unref&&E.unref(),this._pendingQueue.push(p),n}return this.newClient(new m(r.callback)),n}newClient(i){const r=new this.Client(this.options);this._clients.push(r);const n=s(this,r);this.log("checking client timeout");let a,p=!1;this.options.connectionTimeoutMillis&&(a=setTimeout(()=>{this.log("ending client due to timeout"),p=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(E=>{if(a&&clearTimeout(a),r.on("error",n),E)this.log("client failed to connect",E),this._clients=this._clients.filter(v=>v!==r),p&&(E=new Error("Connection terminated due to connection timeout",{cause:E})),this._pulseQueue(),i.timedOut||i.callback(E,void 0,y);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){const v=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(r),this._idle.findIndex(b=>b.client===r)!==-1&&this._acquireClient(r,new m((b,R,L)=>L()),n,!1)},this.options.maxLifetimeSeconds*1e3);v.unref(),r.once("end",()=>clearTimeout(v))}return this._acquireClient(r,i,n,!0)}})}_acquireClient(i,r,n,a){a&&this.emit("connect",i),this.emit("acquire",i),i.release=this._releaseOnce(i,n),i.removeListener("error",n),r.timedOut?a&&this.options.verify?this.options.verify(i,i.release):i.release():a&&this.options.verify?this.options.verify(i,p=>{if(p)return i.release(p),r.callback(p,void 0,y);r.callback(void 0,i,i.release)}):r.callback(void 0,i,i.release)}_releaseOnce(i,r){let n=!1;return a=>{n&&h(),n=!0,this._release(i,r,a)}}_release(i,r,n){if(i.on("error",r),i._poolUseCount=(i._poolUseCount||0)+1,this.emit("release",n,i),n||this.ending||!i._queryable||i._ending||i._poolUseCount>=this.options.maxUses)return i._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(i,this._pulseQueue.bind(this));if(this._expired.has(i))return this.log("remove expired client"),this._expired.delete(i),this._remove(i,this._pulseQueue.bind(this));let p;this.options.idleTimeoutMillis&&this._isAboveMin()&&(p=setTimeout(()=>{this.log("remove idle client"),this._remove(i,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&p.unref()),this.options.allowExitOnIdle&&i.unref(),this._idle.push(new _(i,r,p)),this._pulseQueue()}query(i,r,n){if(typeof i=="function"){const p=o(this.Promise,i);return setImmediate(function(){return p.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),p.result}typeof r=="function"&&(n=r,r=void 0);const a=o(this.Promise,n);return n=a.callback,this.connect((p,E)=>{if(p)return n(p);let v=!1;const g=b=>{v||(v=!0,E.release(b),n(b))};E.once("error",g),this.log("dispatching query");try{E.query(i,r,(b,R)=>{if(this.log("query dispatched"),E.removeListener("error",g),!v)return v=!0,E.release(b),b?n(b):n(void 0,R)})}catch(b){return E.release(b),n(b)}}),a.result}end(i){if(this.log("ending"),this.ending){const n=new Error("Called end on pool more than once");return i?i(n):this.Promise.reject(n)}this.ending=!0;const r=o(this.Promise,i);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((i,r)=>i+(this._expired.has(r)?1:0),0)}get totalCount(){return this._clients.length}}return Ke=c,Ke}var We={exports:{}};const Xr={},zr=Object.freeze(Object.defineProperty({__proto__:null,default:Xr},Symbol.toStringTag,{value:"Module"})),Jr=Jt(zr);var $e={exports:{}},Kt;function Zr(){if(Kt)return $e.exports;Kt=1;const d=Y.EventEmitter,y=Y,w=se(),_=$e.exports=function(h,o,s){d.call(this),h=w.normalizeQueryConfig(h,o,s),this.text=h.text,this.values=h.values,this.name=h.name,this.queryMode=h.queryMode,this.callback=h.callback,this.state="new",this._arrayMode=h.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(c){c==="row"&&(this._emitRowEvents=!0)}.bind(this))};y.inherits(_,d);const m={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};return _.prototype.handleError=function(h){const o=this.native.pq.resultErrorFields();if(o)for(const s in o){const c=m[s]||s;h[c]=o[s]}this.callback?this.callback(h):this.emit("error",h),this.state="error"},_.prototype.then=function(h,o){return this._getPromise().then(h,o)},_.prototype.catch=function(h){return this._getPromise().catch(h)},_.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(h,o){this._once("end",h),this._once("error",o)}.bind(this)),this._promise)},_.prototype.submit=function(h){this.state="running";const o=this;this.native=h.native,h.native.arrayMode=this._arrayMode;let s=function(c,l,i){if(h.native.arrayMode=!1,setImmediate(function(){o.emit("_done")}),c)return o.handleError(c);o._emitRowEvents&&(i.length>1?l.forEach((r,n)=>{r.forEach(a=>{o.emit("row",a,i[n])})}):l.forEach(function(r){o.emit("row",r,i)})),o.state="end",o.emit("end",i),o.callback&&o.callback(null,i)};if(process.domain&&(s=process.domain.bind(s)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));const c=(this.values||[]).map(w.prepareValue);if(h.namedQueries[this.name]){if(this.text&&h.namedQueries[this.name]!==this.text){const l=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return s(l)}return h.native.execute(this.name,c,s)}return h.native.prepare(this.name,this.text,c.length,function(l){return l?s(l):(h.namedQueries[o.name]=o.text,o.native.execute(o.name,c,s))})}else if(this.values){if(!Array.isArray(this.values)){const l=new Error("Query values must be an array");return s(l)}const c=this.values.map(w.prepareValue);h.native.query(this.text,c,s)}else this.queryMode==="extended"?h.native.query(this.text,[],s):h.native.query(this.text,s)},$e.exports}var Wt;function en(){if(Wt)return We.exports;Wt=1;var d;try{d=Jr}catch(s){throw s}const y=Je(),w=Y.EventEmitter,_=Y,m=rr(),h=Zr(),o=We.exports=function(s){w.call(this),s=s||{},this._Promise=s.Promise||ze.Promise,this._types=new y(s.types),this.native=new d({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;const c=this.connectionParameters=new m(s);s.nativeConnectionString&&(c.nativeConnectionString=s.nativeConnectionString),this.user=c.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:c.password}),this.database=c.database,this.host=c.host,this.port=c.port,this.namedQueries={}};return o.Query=h,_.inherits(o,w),o.prototype._errorAllQueries=function(s){const c=l=>{process.nextTick(()=>{l.native=this.native,l.handleError(s)})};this._hasActiveQuery()&&(c(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(c),this._queryQueue.length=0},o.prototype._connect=function(s){const c=this;if(this._connecting){process.nextTick(()=>s(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(l,i){if(c.connectionParameters.nativeConnectionString&&(i=c.connectionParameters.nativeConnectionString),l)return s(l);c.native.connect(i,function(r){if(r)return c.native.end(),s(r);c._connected=!0,c.native.on("error",function(n){c._queryable=!1,c._errorAllQueries(n),c.emit("error",n)}),c.native.on("notification",function(n){c.emit("notification",{channel:n.relname,payload:n.extra})}),c.emit("connect"),c._pulseQueryQueue(!0),s()})})},o.prototype.connect=function(s){if(s){this._connect(s);return}return new this._Promise((c,l)=>{this._connect(i=>{i?l(i):c()})})},o.prototype.query=function(s,c,l){let i,r,n,a,p;if(s==null)throw new TypeError("Client was passed a null or undefined query");if(typeof s.submit=="function")n=s.query_timeout||this.connectionParameters.query_timeout,r=i=s,typeof c=="function"&&(s.callback=c);else if(n=s.query_timeout||this.connectionParameters.query_timeout,i=new h(s,c,l),!i.callback){let E,v;r=new this._Promise((g,b)=>{E=g,v=b}).catch(g=>{throw Error.captureStackTrace(g),g}),i.callback=(g,b)=>g?v(g):E(b)}return n&&(p=i.callback,a=setTimeout(()=>{const E=new Error("Query read timeout");process.nextTick(()=>{i.handleError(E,this.connection)}),p(E),i.callback=()=>{};const v=this._queryQueue.indexOf(i);v>-1&&this._queryQueue.splice(v,1),this._pulseQueryQueue()},n),i.callback=(E,v)=>{clearTimeout(a),p(E,v)}),this._queryable?this._ending?(i.native=this.native,process.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(i),this._pulseQueryQueue(),r):(i.native=this.native,process.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)},o.prototype.end=function(s){const c=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,s));let l;return s||(l=new this._Promise(function(i,r){s=n=>n?r(n):i()})),this.native.end(function(){c._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{c.emit("end"),s&&s()})}),l},o.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},o.prototype._pulseQueryQueue=function(s){if(!this._connected||this._hasActiveQuery())return;const c=this._queryQueue.shift();if(!c){s||this.emit("drain");return}this._activeQuery=c,c.submit(this);const l=this;c.once("_done",function(){l._pulseQueryQueue()})},o.prototype.cancel=function(s){this._activeQuery===s?this.native.cancel(function(){}):this._queryQueue.indexOf(s)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(s),1)},o.prototype.ref=function(){},o.prototype.unref=function(){},o.prototype.setTypeParser=function(s,c,l){return this._types.setTypeParser(s,c,l)},o.prototype.getTypeParser=function(s,c){return this._types.getTypeParser(s,c)},We.exports}var Xe,$t;function Xt(){return $t||($t=1,Xe=en()),Xe}var zt;function or(){return zt||(zt=1,function(d){var y={};const w=Wr(),_=de(),m=ar(),h=nr(),o=se(),s=$r(),c=Je(),{DatabaseError:l}=sr(),{escapeIdentifier:i,escapeLiteral:r}=se(),n=p=>class extends s{constructor(v){super(v,p)}},a=function(p){this.defaults=_,this.Client=p,this.Query=this.Client.Query,this.Pool=n(this.Client),this._pools=[],this.Connection=m,this.types=pe(),this.DatabaseError=l,this.TypeOverrides=c,this.escapeIdentifier=i,this.escapeLiteral=r,this.Result=h,this.utils=o};typeof y.NODE_PG_FORCE_NATIVE<"u"?d.exports=new a(Xt()):(d.exports=new a(w),Object.defineProperty(d.exports,"native",{configurable:!0,enumerable:!1,get(){let p=null;try{p=new a(Xt())}catch(E){if(E.code!=="MODULE_NOT_FOUND")throw E}return Object.defineProperty(d.exports,"native",{value:p}),p}}))}(Ee)),Ee.exports}var tn=or();const z=Er(tn);z.Client;z.Pool;z.Connection;z.types;z.Query;z.DatabaseError;z.escapeIdentifier;z.escapeLiteral;z.Result;z.TypeOverrides;z.defaults;var rn={};const{Pool:nn}=z,ur=new nn({connectionString:rn.DATABASE_URL,ssl:{rejectUnauthorized:!1}});async function sn(){const d=await ur.connect();try{await d.query(`
      CREATE TABLE IF NOT EXISTS members (
        member_number VARCHAR(50) PRIMARY KEY,
        name VARCHAR(255) NOT NULL,
        phone VARCHAR(50),
        email VARCHAR(255),
        profile_picture TEXT,
        bio TEXT,
        sailing_experience TEXT,
        pin VARCHAR(50),
        is_admin BOOLEAN DEFAULT FALSE,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
      );
      
      CREATE TABLE IF NOT EXISTS boats (
        id VARCHAR(50) PRIMARY KEY,
        name VARCHAR(255) NOT NULL,
        status VARCHAR(50) DEFAULT 'operational',
        boat_type VARCHAR(50) DEFAULT 'individual',
        last_maintenance DATE,
        notes TEXT
      );
      
      CREATE TABLE IF NOT EXISTS check_ins (
        id SERIAL PRIMARY KEY,
        boat_id VARCHAR(50) NOT NULL,
        sailor_name VARCHAR(255) NOT NULL,
        member_number VARCHAR(50),
        phone VARCHAR(50),
        departure_time TIMESTAMP NOT NULL,
        expected_return TIMESTAMP NOT NULL,
        actual_return TIMESTAMP,
        checkout_checklist_completed BOOLEAN DEFAULT FALSE,
        checkin_checklist_completed BOOLEAN DEFAULT FALSE,
        trip_notes TEXT,
        weather_conditions TEXT,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (boat_id) REFERENCES boats (id),
        FOREIGN KEY (member_number) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS notifications (
        id SERIAL PRIMARY KEY,
        boat_id VARCHAR(50) NOT NULL,
        type VARCHAR(50) NOT NULL,
        message TEXT NOT NULL,
        sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (boat_id) REFERENCES boats (id)
      );
      
      CREATE TABLE IF NOT EXISTS trip_photos (
        id SERIAL PRIMARY KEY,
        check_in_id INTEGER NOT NULL,
        member_number VARCHAR(50) NOT NULL,
        photo_url TEXT NOT NULL,
        caption TEXT,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (check_in_id) REFERENCES check_ins (id),
        FOREIGN KEY (member_number) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS trip_likes (
        id SERIAL PRIMARY KEY,
        trip_photo_id INTEGER NOT NULL,
        member_number VARCHAR(50) NOT NULL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (trip_photo_id) REFERENCES trip_photos (id),
        FOREIGN KEY (member_number) REFERENCES members (member_number),
        UNIQUE(trip_photo_id, member_number)
      );
      
      CREATE TABLE IF NOT EXISTS trip_comments (
        id SERIAL PRIMARY KEY,
        trip_photo_id INTEGER NOT NULL,
        member_number VARCHAR(50) NOT NULL,
        comment TEXT NOT NULL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (trip_photo_id) REFERENCES trip_photos (id),
        FOREIGN KEY (member_number) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS user_friends (
        id SERIAL PRIMARY KEY,
        member_number1 VARCHAR(50) NOT NULL,
        member_number2 VARCHAR(50) NOT NULL,
        status VARCHAR(20) DEFAULT 'pending',
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (member_number1) REFERENCES members (member_number),
        FOREIGN KEY (member_number2) REFERENCES members (member_number),
        UNIQUE(member_number1, member_number2)
      );
      
      CREATE TABLE IF NOT EXISTS planned_outings (
        id SERIAL PRIMARY KEY,
        title VARCHAR(255) NOT NULL,
        description TEXT,
        date DATE NOT NULL,
        time TIME,
        location VARCHAR(255),
        max_participants INTEGER,
        created_by VARCHAR(50) NOT NULL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (created_by) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS outing_participants (
        id SERIAL PRIMARY KEY,
        outing_id INTEGER NOT NULL,
        member_number VARCHAR(50) NOT NULL,
        status VARCHAR(20) DEFAULT 'confirmed',
        joined_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (outing_id) REFERENCES planned_outings (id),
        FOREIGN KEY (member_number) REFERENCES members (member_number),
        UNIQUE(outing_id, member_number)
      );
      
      CREATE TABLE IF NOT EXISTS messages (
        id SERIAL PRIMARY KEY,
        sender_member_number VARCHAR(50) NOT NULL,
        receiver_member_number VARCHAR(50) NOT NULL,
        message TEXT NOT NULL,
        is_read BOOLEAN DEFAULT FALSE,
        sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (sender_member_number) REFERENCES members (member_number),
        FOREIGN KEY (receiver_member_number) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS boat_hours (
        id SERIAL PRIMARY KEY,
        member_number VARCHAR(50) NOT NULL,
        check_in_id INTEGER NOT NULL,
        boat_id VARCHAR(50) NOT NULL,
        hours DECIMAL(5,2) NOT NULL,
        recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (member_number) REFERENCES members (member_number),
        FOREIGN KEY (check_in_id) REFERENCES check_ins (id),
        FOREIGN KEY (boat_id) REFERENCES boats (id)
      );
      
      CREATE TABLE IF NOT EXISTS maintenance_issues (
        id SERIAL PRIMARY KEY,
        boat_id VARCHAR(50) NOT NULL,
        reported_by VARCHAR(50) NOT NULL,
        issue_type VARCHAR(100) NOT NULL,
        description TEXT NOT NULL,
        severity VARCHAR(20) DEFAULT 'medium',
        status VARCHAR(20) DEFAULT 'open',
        reported_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        resolved_at TIMESTAMP,
        resolved_by VARCHAR(50),
        resolution_notes TEXT,
        FOREIGN KEY (boat_id) REFERENCES boats (id),
        FOREIGN KEY (reported_by) REFERENCES members (member_number),
        FOREIGN KEY (resolved_by) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS qr_codes (
        id SERIAL PRIMARY KEY,
        boat_id VARCHAR(50) NOT NULL,
        qr_code_url TEXT NOT NULL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (boat_id) REFERENCES boats (id)
      );
    `)}finally{d.release()}}sn().catch(console.error);async function cr(){return await ur.connect()}async function on(d){const y=await cr();try{return(await y.query("SELECT is_admin FROM members WHERE member_number = $1",[d])).rows[0]?.is_admin||!1}finally{y.release()}}async function un(d,y){const w=await cr();try{return(await w.query("SELECT * FROM members WHERE member_number = $1 AND pin = $2",[d,y])).rows[0]||null}finally{w.release()}}export{on as isAdmin,un as verifyMemberCredentials};
