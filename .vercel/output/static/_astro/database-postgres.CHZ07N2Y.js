var Ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _r(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function tr(d){if(Object.prototype.hasOwnProperty.call(d,"__esModule"))return d;var y=d.default;if(typeof y=="function"){var w=function v(){return this instanceof v?Reflect.construct(y,arguments,this.constructor):y.apply(this,arguments)};w.prototype=y.prototype}else w={};return Object.defineProperty(w,"__esModule",{value:!0}),Object.keys(d).forEach(function(v){var m=Object.getOwnPropertyDescriptor(d,v);Object.defineProperty(w,v,m.get?m:{enumerable:!0,get:function(){return d[v]}})}),w}var ge={exports:{}},ce={exports:{}},at;function ee(){if(at)return ce.exports;at=1;var d=typeof Reflect=="object"?Reflect:null,y=d&&typeof d.apply=="function"?d.apply:function(S,C,g){return Function.prototype.apply.call(S,C,g)},w;d&&typeof d.ownKeys=="function"?w=d.ownKeys:Object.getOwnPropertySymbols?w=function(S){return Object.getOwnPropertyNames(S).concat(Object.getOwnPropertySymbols(S))}:w=function(S){return Object.getOwnPropertyNames(S)};function v(T){console&&console.warn&&console.warn(T)}var m=Number.isNaN||function(S){return S!==S};function u(){u.init.call(this)}ce.exports=u,ce.exports.once=_,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var a=10;function s(T){if(typeof T!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof T)}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(T){if(typeof T!="number"||T<0||m(T))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+T+".");a=T}}),u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(S){if(typeof S!="number"||S<0||m(S))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+S+".");return this._maxListeners=S,this};function h(T){return T._maxListeners===void 0?u.defaultMaxListeners:T._maxListeners}u.prototype.getMaxListeners=function(){return h(this)},u.prototype.emit=function(S){for(var C=[],g=1;g<arguments.length;g++)C.push(arguments[g]);var I=S==="error",P=this._events;if(P!==void 0)I=I&&P.error===void 0;else if(!I)return!1;if(I){var F;if(C.length>0&&(F=C[0]),F instanceof Error)throw F;var B=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw B.context=F,B}var j=P[S];if(j===void 0)return!1;if(typeof j=="function")y(j,this,C);else for(var N=j.length,D=l(j,N),g=0;g<N;++g)y(D[g],this,C);return!0};function f(T,S,C,g){var I,P,F;if(s(C),P=T._events,P===void 0?(P=T._events=Object.create(null),T._eventsCount=0):(P.newListener!==void 0&&(T.emit("newListener",S,C.listener?C.listener:C),P=T._events),F=P[S]),F===void 0)F=P[S]=C,++T._eventsCount;else if(typeof F=="function"?F=P[S]=g?[C,F]:[F,C]:g?F.unshift(C):F.push(C),I=h(T),I>0&&F.length>I&&!F.warned){F.warned=!0;var B=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(S)+" listeners added. Use emitter.setMaxListeners() to increase limit");B.name="MaxListenersExceededWarning",B.emitter=T,B.type=S,B.count=F.length,v(B)}return T}u.prototype.addListener=function(S,C){return f(this,S,C,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(S,C){return f(this,S,C,!0)};function i(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r(T,S,C){var g={fired:!1,wrapFn:void 0,target:T,type:S,listener:C},I=i.bind(g);return I.listener=C,g.wrapFn=I,I}u.prototype.once=function(S,C){return s(C),this.on(S,r(this,S,C)),this},u.prototype.prependOnceListener=function(S,C){return s(C),this.prependListener(S,r(this,S,C)),this},u.prototype.removeListener=function(S,C){var g,I,P,F,B;if(s(C),I=this._events,I===void 0)return this;if(g=I[S],g===void 0)return this;if(g===C||g.listener===C)--this._eventsCount===0?this._events=Object.create(null):(delete I[S],I.removeListener&&this.emit("removeListener",S,g.listener||C));else if(typeof g!="function"){for(P=-1,F=g.length-1;F>=0;F--)if(g[F]===C||g[F].listener===C){B=g[F].listener,P=F;break}if(P<0)return this;P===0?g.shift():E(g,P),g.length===1&&(I[S]=g[0]),I.removeListener!==void 0&&this.emit("removeListener",S,B||C)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(S){var C,g,I;if(g=this._events,g===void 0)return this;if(g.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):g[S]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete g[S]),this;if(arguments.length===0){var P=Object.keys(g),F;for(I=0;I<P.length;++I)F=P[I],F!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(C=g[S],typeof C=="function")this.removeListener(S,C);else if(C!==void 0)for(I=C.length-1;I>=0;I--)this.removeListener(S,C[I]);return this};function n(T,S,C){var g=T._events;if(g===void 0)return[];var I=g[S];return I===void 0?[]:typeof I=="function"?C?[I.listener||I]:[I]:C?b(I):l(I,I.length)}u.prototype.listeners=function(S){return n(this,S,!0)},u.prototype.rawListeners=function(S){return n(this,S,!1)},u.listenerCount=function(T,S){return typeof T.listenerCount=="function"?T.listenerCount(S):o.call(T,S)},u.prototype.listenerCount=o;function o(T){var S=this._events;if(S!==void 0){var C=S[T];if(typeof C=="function")return 1;if(C!==void 0)return C.length}return 0}u.prototype.eventNames=function(){return this._eventsCount>0?w(this._events):[]};function l(T,S){for(var C=new Array(S),g=0;g<S;++g)C[g]=T[g];return C}function E(T,S){for(;S+1<T.length;S++)T[S]=T[S+1];T.pop()}function b(T){for(var S=new Array(T.length),C=0;C<S.length;++C)S[C]=T[C].listener||T[C];return S}function _(T,S){return new Promise(function(C,g){function I(F){T.removeListener(S,P),g(F)}function P(){typeof T.removeListener=="function"&&T.removeListener("error",I),C([].slice.call(arguments))}x(T,S,P,{once:!0}),S!=="error"&&R(T,I,{once:!0})})}function R(T,S,C){typeof T.on=="function"&&x(T,"error",S,C)}function x(T,S,C,g){if(typeof T.on=="function")g.once?T.once(S,C):T.on(S,C);else if(typeof T.addEventListener=="function")T.addEventListener(S,function I(P){g.once&&T.removeEventListener(S,I),C(P)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof T)}return ce.exports}var _e={exports:{}},Z={},ve={},ut;function rr(){if(ut)return ve;ut=1,ve.parse=function(w,v){return new d(w,v).parse()};class d{constructor(v,m){this.source=v,this.transform=m||y,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var v=this.source[this.position++];return v==="\\"?{value:this.source[this.position++],escaped:!0}:{value:v,escaped:!1}}record(v){this.recorded.push(v)}newEntry(v){var m;(this.recorded.length>0||v)&&(m=this.recorded.join(""),m==="NULL"&&!v&&(m=null),m!==null&&(m=this.transform(m)),this.entries.push(m),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var v=this.nextCharacter();if(v.value==="=")break}}parse(v){var m,u,a;for(this.consumeDimensions();!this.isEof();)if(m=this.nextCharacter(),m.value==="{"&&!a)this.dimension++,this.dimension>1&&(u=new d(this.source.substr(this.position-1),this.transform),this.entries.push(u.parse(!0)),this.position+=u.position-2);else if(m.value==="}"&&!a){if(this.dimension--,!this.dimension&&(this.newEntry(),v))return this.entries}else m.value==='"'&&!m.escaped?(a&&this.newEntry(!0),a=!a):m.value===","&&!a?this.newEntry():this.record(m.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}}function y(w){return w}return ve}var Se,ct;function nr(){if(ct)return Se;ct=1;var d=rr();return Se={create:function(y,w){return{parse:function(){return d.parse(y,w)}}}},Se}var be,ht;function vr(){if(ht)return be;ht=1;var d=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,y=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,w=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,v=/^-?infinity$/;be=function(f){if(v.test(f))return Number(f.replace("i","I"));var i=d.exec(f);if(!i)return m(f)||null;var r=!!i[8],n=parseInt(i[1],10);r&&(n=a(n));var o=parseInt(i[2],10)-1,l=i[3],E=parseInt(i[4],10),b=parseInt(i[5],10),_=parseInt(i[6],10),R=i[7];R=R?1e3*parseFloat(R):0;var x,T=u(f);return T!=null?(x=new Date(Date.UTC(n,o,l,E,b,_,R)),s(n)&&x.setUTCFullYear(n),T!==0&&x.setTime(x.getTime()-T)):(x=new Date(n,o,l,E,b,_,R),s(n)&&x.setFullYear(n)),x};function m(h){var f=y.exec(h);if(f){var i=parseInt(f[1],10),r=!!f[4];r&&(i=a(i));var n=parseInt(f[2],10)-1,o=f[3],l=new Date(i,n,o);return s(i)&&l.setFullYear(i),l}}function u(h){if(h.endsWith("+00"))return 0;var f=w.exec(h.split(" ")[1]);if(f){var i=f[1];if(i==="Z")return 0;var r=i==="-"?-1:1,n=parseInt(f[2],10)*3600+parseInt(f[3]||0,10)*60+parseInt(f[4]||0,10);return n*r*1e3}}function a(h){return-(h-1)}function s(h){return h>=0&&h<100}return be}var Ae,ft;function Sr(){if(ft)return Ae;ft=1,Ae=y;var d=Object.prototype.hasOwnProperty;function y(w){for(var v=1;v<arguments.length;v++){var m=arguments[v];for(var u in m)d.call(m,u)&&(w[u]=m[u])}return w}return Ae}var Re,lt;function br(){if(lt)return Re;lt=1;var d=Sr();Re=y;function y(b){if(!(this instanceof y))return new y(b);d(this,E(b))}var w=["seconds","minutes","hours","days","months","years"];y.prototype.toPostgres=function(){var b=w.filter(this.hasOwnProperty,this);return this.milliseconds&&b.indexOf("seconds")<0&&b.push("seconds"),b.length===0?"0":b.map(function(_){var R=this[_]||0;return _==="seconds"&&this.milliseconds&&(R=(R+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),R+" "+_},this).join(" ")};var v={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},m=["years","months","days"],u=["hours","minutes","seconds"];y.prototype.toISOString=y.prototype.toISO=function(){var b=m.map(R,this).join(""),_=u.map(R,this).join("");return"P"+b+"T"+_;function R(x){var T=this[x]||0;return x==="seconds"&&this.milliseconds&&(T=(T+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),T+v[x]}};var a="([+-]?\\d+)",s=a+"\\s+years?",h=a+"\\s+mons?",f=a+"\\s+days?",i="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",r=new RegExp([s,h,f,i].map(function(b){return"("+b+")?"}).join("\\s*")),n={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},o=["hours","minutes","seconds","milliseconds"];function l(b){var _=b+"000000".slice(b.length);return parseInt(_,10)/1e3}function E(b){if(!b)return{};var _=r.exec(b),R=_[8]==="-";return Object.keys(n).reduce(function(x,T){var S=n[T],C=_[S];return!C||(C=T==="milliseconds"?l(C):parseInt(C,10),!C)||(R&&~o.indexOf(T)&&(C*=-1),x[T]=C),x},{})}return Re}var Te,pt;function Ar(){return pt||(pt=1,Te=function(y){if(/^\\x/.test(y))return new Buffer(y.substr(2),"hex");for(var w="",v=0;v<y.length;)if(y[v]!=="\\")w+=y[v],++v;else if(/[0-7]{3}/.test(y.substr(v+1,3)))w+=String.fromCharCode(parseInt(y.substr(v+1,3),8)),v+=4;else{for(var m=1;v+m<y.length&&y[v+m]==="\\";)m++;for(var u=0;u<Math.floor(m/2);++u)w+="\\";v+=Math.floor(m/2)*2}return new Buffer(w,"binary")}),Te}var Ce,dt;function Rr(){if(dt)return Ce;dt=1;var d=rr(),y=nr(),w=vr(),v=br(),m=Ar();function u(g){return function(P){return P===null?P:g(P)}}function a(g){return g===null?g:g==="TRUE"||g==="t"||g==="true"||g==="y"||g==="yes"||g==="on"||g==="1"}function s(g){return g?d.parse(g,a):null}function h(g){return parseInt(g,10)}function f(g){return g?d.parse(g,u(h)):null}function i(g){return g?d.parse(g,u(function(I){return R(I).trim()})):null}var r=function(g){if(!g)return null;var I=y.create(g,function(P){return P!==null&&(P=T(P)),P});return I.parse()},n=function(g){if(!g)return null;var I=y.create(g,function(P){return P!==null&&(P=parseFloat(P)),P});return I.parse()},o=function(g){if(!g)return null;var I=y.create(g);return I.parse()},l=function(g){if(!g)return null;var I=y.create(g,function(P){return P!==null&&(P=w(P)),P});return I.parse()},E=function(g){if(!g)return null;var I=y.create(g,function(P){return P!==null&&(P=v(P)),P});return I.parse()},b=function(g){return g?d.parse(g,u(m)):null},_=function(g){return parseInt(g,10)},R=function(g){var I=String(g);return/^\d+$/.test(I)?I:g},x=function(g){return g?d.parse(g,u(JSON.parse)):null},T=function(g){return g[0]!=="("?null:(g=g.substring(1,g.length-1).split(","),{x:parseFloat(g[0]),y:parseFloat(g[1])})},S=function(g){if(g[0]!=="<"&&g[1]!=="(")return null;for(var I="(",P="",F=!1,B=2;B<g.length-1;B++){if(F||(I+=g[B]),g[B]===")"){F=!0;continue}else if(!F)continue;g[B]!==","&&(P+=g[B])}var j=T(I);return j.radius=parseFloat(P),j},C=function(g){g(20,R),g(21,_),g(23,_),g(26,_),g(700,parseFloat),g(701,parseFloat),g(16,a),g(1082,w),g(1114,w),g(1184,w),g(600,T),g(651,o),g(718,S),g(1e3,s),g(1001,b),g(1005,f),g(1007,f),g(1028,f),g(1016,i),g(1017,r),g(1021,n),g(1022,n),g(1231,n),g(1014,o),g(1015,o),g(1008,o),g(1009,o),g(1040,o),g(1041,o),g(1115,l),g(1182,l),g(1185,l),g(1186,v),g(1187,E),g(17,m),g(114,JSON.parse.bind(JSON)),g(3802,JSON.parse.bind(JSON)),g(199,x),g(3807,x),g(3907,o),g(2951,o),g(791,o),g(1183,o),g(1270,o)};return Ce={init:C},Ce}var xe,mt;function Tr(){if(mt)return xe;mt=1;var d=1e6;function y(w){var v=w.readInt32BE(0),m=w.readUInt32BE(4),u="";v<0&&(v=~v+(m===0),m=~m+1>>>0,u="-");var a="",s,h,f,i,r,n;{if(s=v%d,v=v/d>>>0,h=4294967296*s+m,m=h/d>>>0,f=""+(h-d*m),m===0&&v===0)return u+f+a;for(i="",r=6-f.length,n=0;n<r;n++)i+="0";a=i+f+a}{if(s=v%d,v=v/d>>>0,h=4294967296*s+m,m=h/d>>>0,f=""+(h-d*m),m===0&&v===0)return u+f+a;for(i="",r=6-f.length,n=0;n<r;n++)i+="0";a=i+f+a}{if(s=v%d,v=v/d>>>0,h=4294967296*s+m,m=h/d>>>0,f=""+(h-d*m),m===0&&v===0)return u+f+a;for(i="",r=6-f.length,n=0;n<r;n++)i+="0";a=i+f+a}return s=v%d,h=4294967296*s+m,f=""+h%d,u+f+a}return xe=y,xe}var Ie,yt;function Cr(){if(yt)return Ie;yt=1;var d=Tr(),y=function(o,l,E,b,_){E=E||0,b=b||!1,_=_||function(F,B,j){return F*Math.pow(2,j)+B};var R=E>>3,x=function(F){return b?~F&255:F},T=255,S=8-E%8;l<S&&(T=255<<8-l&255,S=l),E&&(T=T>>E%8);var C=0;E%8+l>=8&&(C=_(0,x(o[R])&T,S));for(var g=l+E>>3,I=R+1;I<g;I++)C=_(C,x(o[I]),8);var P=(l+E)%8;return P>0&&(C=_(C,x(o[g])>>8-P,P)),C},w=function(o,l,E){var b=Math.pow(2,E-1)-1,_=y(o,1),R=y(o,E,1);if(R===0)return 0;var x=1,T=function(C,g,I){C===0&&(C=1);for(var P=1;P<=I;P++)x/=2,(g&1<<I-P)>0&&(C+=x);return C},S=y(o,l,E+1,!1,T);return R==Math.pow(2,E+1)-1?S===0?_===0?1/0:-1/0:NaN:(_===0?1:-1)*Math.pow(2,R-b)*S},v=function(o){return y(o,1)==1?-1*(y(o,15,1,!0)+1):y(o,15,1)},m=function(o){return y(o,1)==1?-1*(y(o,31,1,!0)+1):y(o,31,1)},u=function(o){return w(o,23,8)},a=function(o){return w(o,52,11)},s=function(o){var l=y(o,16,32);if(l==49152)return NaN;for(var E=Math.pow(1e4,y(o,16,16)),b=0,_=y(o,16),R=0;R<_;R++)b+=y(o,16,64+16*R)*E,E/=1e4;var x=Math.pow(10,y(o,16,48));return(l===0?1:-1)*Math.round(b*x)/x},h=function(o,l){var E=y(l,1),b=y(l,63,1),_=new Date((E===0?1:-1)*b/1e3+9466848e5);return o||_.setTime(_.getTime()+_.getTimezoneOffset()*6e4),_.usec=b%1e3,_.getMicroSeconds=function(){return this.usec},_.setMicroSeconds=function(R){this.usec=R},_.getUTCMicroSeconds=function(){return this.usec},_},f=function(o){var l=y(o,32);y(o,32,32);for(var E=y(o,32,64),b=96,_=[],R=0;R<l;R++)_[R]=y(o,32,b),b+=32,b+=32;var x=function(S){var C=y(o,32,b);if(b+=32,C==4294967295)return null;var g;if(S==23||S==20)return g=y(o,C*8,b),b+=C*8,g;if(S==25)return g=o.toString(this.encoding,b>>3,(b+=C<<3)>>3),g;console.log("ERROR: ElementType not implemented: "+S)},T=function(S,C){var g=[],I;if(S.length>1){var P=S.shift();for(I=0;I<P;I++)g[I]=T(S,C);S.unshift(P)}else for(I=0;I<S[0];I++)g[I]=x(C);return g};return T(_,E)},i=function(o){return o.toString("utf8")},r=function(o){return o===null?null:y(o,8)>0},n=function(o){o(20,d),o(21,v),o(23,m),o(26,m),o(1700,s),o(700,u),o(701,a),o(16,r),o(1114,h.bind(null,!1)),o(1184,h.bind(null,!0)),o(1e3,f),o(1007,f),o(1016,f),o(1008,f),o(1009,f),o(25,i)};return Ie={init:n},Ie}var Le,Et;function xr(){return Et||(Et=1,Le={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}),Le}var wt;function me(){if(wt)return Z;wt=1;var d=Rr(),y=Cr(),w=nr(),v=xr();Z.getTypeParser=a,Z.setTypeParser=s,Z.arrayParser=w,Z.builtins=v;var m={text:{},binary:{}};function u(h){return String(h)}function a(h,f){return f=f||"text",m[f]&&m[f][h]||u}function s(h,f,i){typeof f=="function"&&(i=f,f="text"),m[f][h]=i}return d.init(function(h,f){m.text[h]=f}),y.init(function(h,f){m.binary[h]=f}),Z}var gt;function ye(){return gt||(gt=1,function(d){var y={};d.exports={host:"localhost",user:process.platform==="win32"?y.USERNAME:y.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};const w=me(),v=w.getTypeParser(20,"text"),m=w.getTypeParser(1016,"text");d.exports.__defineSetter__("parseInt8",function(u){w.setTypeParser(20,"text",u?w.getTypeParser(23,"text"):v),w.setTypeParser(1016,"text",u?w.getTypeParser(1007,"text"):m)})}(_e)),_e.exports}const Ir={},Lr=Object.freeze(Object.defineProperty({__proto__:null,default:Ir},Symbol.toStringTag,{value:"Module"})),$=tr(Lr);var Me,_t;function oe(){if(_t)return Me;_t=1;const d=ye(),y=$,{isDate:w}=y.types||y;function v(n){return'"'+n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function m(n){let o="{";for(let l=0;l<n.length;l++)if(l>0&&(o=o+","),n[l]===null||typeof n[l]>"u")o=o+"NULL";else if(Array.isArray(n[l]))o=o+m(n[l]);else if(ArrayBuffer.isView(n[l])){let E=n[l];if(!(E instanceof Buffer)){const b=Buffer.from(E.buffer,E.byteOffset,E.byteLength);b.length===E.byteLength?E=b:E=b.slice(E.byteOffset,E.byteOffset+E.byteLength)}o+="\\\\x"+E.toString("hex")}else o+=v(u(n[l]));return o=o+"}",o}const u=function(n,o){if(n==null)return null;if(typeof n=="object"){if(n instanceof Buffer)return n;if(ArrayBuffer.isView(n)){const l=Buffer.from(n.buffer,n.byteOffset,n.byteLength);return l.length===n.byteLength?l:l.slice(n.byteOffset,n.byteOffset+n.byteLength)}return w(n)?d.parseInputDatesAsUTC?h(n):s(n):Array.isArray(n)?m(n):a(n,o)}return n.toString()};function a(n,o){if(n&&typeof n.toPostgres=="function"){if(o=o||[],o.indexOf(n)!==-1)throw new Error('circular reference detected while preparing "'+n+'" for query');return o.push(n),u(n.toPostgres(u),o)}return JSON.stringify(n)}function s(n){let o=-n.getTimezoneOffset(),l=n.getFullYear();const E=l<1;E&&(l=Math.abs(l)+1);let b=String(l).padStart(4,"0")+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0")+"T"+String(n.getHours()).padStart(2,"0")+":"+String(n.getMinutes()).padStart(2,"0")+":"+String(n.getSeconds()).padStart(2,"0")+"."+String(n.getMilliseconds()).padStart(3,"0");return o<0?(b+="-",o*=-1):b+="+",b+=String(Math.floor(o/60)).padStart(2,"0")+":"+String(o%60).padStart(2,"0"),E&&(b+=" BC"),b}function h(n){let o=n.getUTCFullYear();const l=o<1;l&&(o=Math.abs(o)+1);let E=String(o).padStart(4,"0")+"-"+String(n.getUTCMonth()+1).padStart(2,"0")+"-"+String(n.getUTCDate()).padStart(2,"0")+"T"+String(n.getUTCHours()).padStart(2,"0")+":"+String(n.getUTCMinutes()).padStart(2,"0")+":"+String(n.getUTCSeconds()).padStart(2,"0")+"."+String(n.getUTCMilliseconds()).padStart(3,"0");return E+="+00:00",l&&(E+=" BC"),E}function f(n,o,l){return n=typeof n=="string"?{text:n}:n,o&&(typeof o=="function"?n.callback=o:n.values=o),l&&(n.callback=l),n}return Me={prepareValue:function(o){return u(o)},normalizeQueryConfig:f,escapeIdentifier:function(n){return'"'+n.replace(/"/g,'""')+'"'},escapeLiteral:function(n){let o=!1,l="'";if(n==null||typeof n!="string")return"''";for(let E=0;E<n.length;E++){const b=n[E];b==="'"?l+=b+b:b==="\\"?(l+=b+b,o=!0):l+=b}return l+="'",o===!0&&(l=" E"+l),l}},Me}var he={exports:{}},Pe,vt;function Mr(){if(vt)return Pe;vt=1;const d=$;function y(s){return d.createHash("md5").update(s,"utf-8").digest("hex")}function w(s,h,f){const i=y(h+s);return"md5"+y(Buffer.concat([Buffer.from(i),f]))}function v(s){return d.createHash("sha256").update(s).digest()}function m(s,h){return s=s.replace(/(\D)-/,"$1"),d.createHash(s).update(h).digest()}function u(s,h){return d.createHmac("sha256",s).update(h).digest()}async function a(s,h,f){return d.pbkdf2Sync(s,h,f,32,"sha256")}return Pe={postgresMd5PasswordHash:w,randomBytes:d.randomBytes,deriveKey:a,sha256:v,hashByName:m,hmacSha256:u,md5:y},Pe}var Ne,St;function Pr(){if(St)return Ne;St=1;const d=$;Ne={postgresMd5PasswordHash:a,randomBytes:m,deriveKey:i,sha256:s,hashByName:h,hmacSha256:f,md5:u};const y=d.webcrypto||globalThis.crypto,w=y.subtle,v=new TextEncoder;function m(r){return y.getRandomValues(Buffer.alloc(r))}async function u(r){try{return d.createHash("md5").update(r,"utf-8").digest("hex")}catch{const o=typeof r=="string"?v.encode(r):r,l=await w.digest("MD5",o);return Array.from(new Uint8Array(l)).map(E=>E.toString(16).padStart(2,"0")).join("")}}async function a(r,n,o){const l=await u(n+r);return"md5"+await u(Buffer.concat([Buffer.from(l),o]))}async function s(r){return await w.digest("SHA-256",r)}async function h(r,n){return await w.digest(r,n)}async function f(r,n){const o=await w.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return await w.sign("HMAC",o,v.encode(n))}async function i(r,n,o){const l=await w.importKey("raw",v.encode(r),"PBKDF2",!1,["deriveBits"]),E={name:"PBKDF2",hash:"SHA-256",salt:n,iterations:o};return await w.deriveBits(E,l,256,["deriveBits"])}return Ne}var bt;function ir(){return bt||(bt=1,parseInt(process.versions&&process.versions.node&&process.versions.node.split(".")[0])<15?he.exports=Mr():he.exports=Pr()),he.exports}var Fe,At;function Nr(){if(At)return Fe;At=1;function d(u,a){return new Error("SASL channel binding: "+u+" when parsing public certificate "+a.toString("base64"))}function y(u,a){let s=u[a++];if(s<128)return{length:s,index:a};const h=s&127;if(h>4)throw d("bad length",u);s=0;for(let f=0;f<h;f++)s=s<<8|u[a++];return{length:s,index:a}}function w(u,a){if(u[a++]!==6)throw d("non-OID data",u);const{length:s,index:h}=y(u,a);a=h;const f=a+s,i=u[a++];let r=(i/40>>0)+"."+i%40;for(;a<f;){let n=0;for(;a<f;){const o=u[a++];if(n=n<<7|o&127,o<128)break}r+="."+n}return{oid:r,index:a}}function v(u,a){if(u[a++]!==48)throw d("non-sequence data",u);return y(u,a)}function m(u,a){a===void 0&&(a=0),a=v(u,a).index;const{length:s,index:h}=v(u,a);a=h+s,a=v(u,a).index;const{oid:f,index:i}=w(u,a);switch(f){case"1.2.840.113549.1.1.4":return"MD5";case"1.2.840.113549.1.1.5":return"SHA-1";case"1.2.840.113549.1.1.11":return"SHA-256";case"1.2.840.113549.1.1.12":return"SHA-384";case"1.2.840.113549.1.1.13":return"SHA-512";case"1.2.840.113549.1.1.14":return"SHA-224";case"1.2.840.113549.1.1.15":return"SHA512-224";case"1.2.840.113549.1.1.16":return"SHA512-256";case"1.2.840.10045.4.1":return"SHA-1";case"1.2.840.10045.4.3.1":return"SHA-224";case"1.2.840.10045.4.3.2":return"SHA-256";case"1.2.840.10045.4.3.3":return"SHA-384";case"1.2.840.10045.4.3.4":return"SHA-512";case"1.2.840.113549.1.1.10":{if(a=i,a=v(u,a).index,u[a++]!==160)throw d("non-tag data",u);a=y(u,a).index,a=v(u,a).index;const{oid:r}=w(u,a);switch(r){case"1.2.840.113549.2.5":return"MD5";case"1.3.14.3.2.26":return"SHA-1";case"2.16.840.1.101.3.4.2.1":return"SHA-256";case"2.16.840.1.101.3.4.2.2":return"SHA-384";case"2.16.840.1.101.3.4.2.3":return"SHA-512"}throw d("unknown hash OID "+r,u)}case"1.3.101.110":case"1.3.101.112":return"SHA-512";case"1.3.101.111":case"1.3.101.113":throw d("Ed448 certificate channel binding is not currently supported by Postgres")}throw d("unknown OID "+f,u)}return Fe={signatureAlgorithmHashFromCertificate:m},Fe}var Be,Rt;function Fr(){if(Rt)return Be;Rt=1;const d=ir(),{signatureAlgorithmHashFromCertificate:y}=Nr();function w(r,n){const o=["SCRAM-SHA-256"];n&&o.unshift("SCRAM-SHA-256-PLUS");const l=o.find(_=>r.includes(_));if(!l)throw new Error("SASL: Only mechanism(s) "+o.join(" and ")+" are supported");if(l==="SCRAM-SHA-256-PLUS"&&typeof n.getPeerCertificate!="function")throw new Error("SASL: Mechanism SCRAM-SHA-256-PLUS requires a certificate");const E=d.randomBytes(18).toString("base64");return{mechanism:l,clientNonce:E,response:(l==="SCRAM-SHA-256-PLUS"?"p=tls-server-end-point":n?"y":"n")+",,n=*,r="+E,message:"SASLInitialResponse"}}async function v(r,n,o,l){if(r.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof n!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(n==="")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof o!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");const E=h(o);if(E.nonce.startsWith(r.clientNonce)){if(E.nonce.length===r.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");const b="n=*,r="+r.clientNonce,_="r="+E.nonce+",s="+E.salt+",i="+E.iteration;let R=l?"eSws":"biws";if(r.mechanism==="SCRAM-SHA-256-PLUS"){const N=l.getPeerCertificate().raw;let D=y(N);(D==="MD5"||D==="SHA-1")&&(D="SHA-256");const k=await d.hashByName(D,N);R=Buffer.concat([Buffer.from("p=tls-server-end-point,,"),Buffer.from(k)]).toString("base64")}const x="c="+R+",r="+E.nonce,T=b+","+_+","+x,S=Buffer.from(E.salt,"base64"),C=await d.deriveKey(n,S,E.iteration),g=await d.hmacSha256(C,"Client Key"),I=await d.sha256(g),P=await d.hmacSha256(I,T),F=i(Buffer.from(g),Buffer.from(P)).toString("base64"),B=await d.hmacSha256(C,"Server Key"),j=await d.hmacSha256(B,T);r.message="SASLResponse",r.serverSignature=Buffer.from(j).toString("base64"),r.response=x+",p="+F}function m(r,n){if(r.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof n!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");const{serverSignature:o}=f(n);if(o!==r.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function u(r){if(typeof r!="string")throw new TypeError("SASL: text must be a string");return r.split("").map((n,o)=>r.charCodeAt(o)).every(n=>n>=33&&n<=43||n>=45&&n<=126)}function a(r){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(r)}function s(r){if(typeof r!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(r.split(",").map(n=>{if(!/^.=/.test(n))throw new Error("SASL: Invalid attribute pair entry");const o=n[0],l=n.substring(2);return[o,l]}))}function h(r){const n=s(r),o=n.get("r");if(o){if(!u(o))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");const l=n.get("s");if(l){if(!a(l))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");const E=n.get("i");if(E){if(!/^[1-9][0-9]*$/.test(E))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");const b=parseInt(E,10);return{nonce:o,salt:l,iteration:b}}function f(r){const o=s(r).get("v");if(o){if(!a(o))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:o}}function i(r,n){if(!Buffer.isBuffer(r))throw new TypeError("first argument must be a Buffer");if(!Buffer.isBuffer(n))throw new TypeError("second argument must be a Buffer");if(r.length!==n.length)throw new Error("Buffer lengths must match");if(r.length===0)throw new Error("Buffers cannot be empty");return Buffer.from(r.map((o,l)=>r[l]^n[l]))}return Be={startSession:w,continueSession:v,finalizeSession:m},Be}var Oe,Tt;function et(){if(Tt)return Oe;Tt=1;const d=me();function y(w){this._types=w||d,this.text={},this.binary={}}return y.prototype.getOverrides=function(w){switch(w){case"text":return this.text;case"binary":return this.binary;default:return{}}},y.prototype.setTypeParser=function(w,v,m){typeof v=="function"&&(m=v,v="text"),this.getOverrides(v)[w]=m},y.prototype.getTypeParser=function(w,v){return v=v||"text",this.getOverrides(v)[w]||this._types.getTypeParser(w,v)},Oe=y,Oe}var De,Ct;function Br(){if(Ct)return De;Ct=1;function d(m,u={}){if(m.charAt(0)==="/"){const n=m.split(" ");return{host:n[0],database:n[1]}}const a={};let s,h=!1;/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(m)&&(m=encodeURI(m).replace(/%25(\d\d)/g,"%$1"));try{try{s=new URL(m,"postgres://base")}catch{s=new URL(m.replace("@/","@___DUMMY___/"),"postgres://base"),h=!0}}catch(n){n.input&&(n.input="*****REDACTED*****")}for(const n of s.searchParams.entries())a[n[0]]=n[1];if(a.user=a.user||decodeURIComponent(s.username),a.password=a.password||decodeURIComponent(s.password),s.protocol=="socket:")return a.host=decodeURI(s.pathname),a.database=s.searchParams.get("db"),a.client_encoding=s.searchParams.get("encoding"),a;const f=h?"":s.hostname;a.host?f&&/^%2f/i.test(f)&&(s.pathname=f+s.pathname):a.host=decodeURIComponent(f),a.port||(a.port=s.port);const i=s.pathname.slice(1)||null;a.database=i?decodeURI(i):null,(a.ssl==="true"||a.ssl==="1")&&(a.ssl=!0),a.ssl==="0"&&(a.ssl=!1),(a.sslcert||a.sslkey||a.sslrootcert||a.sslmode)&&(a.ssl={});const r=a.sslcert||a.sslkey||a.sslrootcert?$:null;if(a.sslcert&&(a.ssl.cert=r.readFileSync(a.sslcert).toString()),a.sslkey&&(a.ssl.key=r.readFileSync(a.sslkey).toString()),a.sslrootcert&&(a.ssl.ca=r.readFileSync(a.sslrootcert).toString()),u.useLibpqCompat&&a.uselibpqcompat)throw new Error("Both useLibpqCompat and uselibpqcompat are set. Please use only one of them.");if(a.uselibpqcompat==="true"||u.useLibpqCompat)switch(a.sslmode){case"disable":{a.ssl=!1;break}case"prefer":{a.ssl.rejectUnauthorized=!1;break}case"require":{a.sslrootcert?a.ssl.checkServerIdentity=function(){}:a.ssl.rejectUnauthorized=!1;break}case"verify-ca":{if(!a.ssl.ca)throw new Error("SECURITY WARNING: Using sslmode=verify-ca requires specifying a CA with sslrootcert. If a public CA is used, verify-ca allows connections to a server that somebody else may have registered with the CA, making you vulnerable to Man-in-the-Middle attacks. Either specify a custom CA certificate with sslrootcert parameter or use sslmode=verify-full for proper security.");a.ssl.checkServerIdentity=function(){};break}}else switch(a.sslmode){case"disable":{a.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{a.ssl.rejectUnauthorized=!1;break}}return a}function y(m){return Object.entries(m).reduce((a,[s,h])=>(h!=null&&(a[s]=h),a),{})}function w(m){return Object.entries(m).reduce((a,[s,h])=>{if(s==="ssl"){const f=h;typeof f=="boolean"&&(a[s]=f),typeof f=="object"&&(a[s]=y(f))}else if(h!=null)if(s==="port"){if(h!==""){const f=parseInt(h,10);if(isNaN(f))throw new Error(`Invalid ${s}: ${h}`);a[s]=f}}else a[s]=h;return a},{})}function v(m){return w(d(m))}return De=d,d.parse=d,d.toClientConfig=w,d.parseIntoClientConfig=v,De}var Ue,xt;function sr(){if(xt)return Ue;xt=1;var d={};const y=$,w=ye(),v=Br().parse,m=function(f,i,r){return r===void 0?r=d["PG"+f.toUpperCase()]:r===!1||(r=d[r]),i[f]||r||w[f]},u=function(){switch(d.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return w.ssl},a=function(f){return"'"+(""+f).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},s=function(f,i,r){const n=i[r];n!=null&&f.push(r+"="+a(n))};class h{constructor(i){i=typeof i=="string"?v(i):i||{},i.connectionString&&(i=Object.assign({},i,v(i.connectionString))),this.user=m("user",i),this.database=m("database",i),this.database===void 0&&(this.database=this.user),this.port=parseInt(m("port",i),10),this.host=m("host",i),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:m("password",i)}),this.binary=m("binary",i),this.options=m("options",i),this.ssl=typeof i.ssl>"u"?u():i.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=m("client_encoding",i),this.replication=m("replication",i),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=m("application_name",i,"PGAPPNAME"),this.fallback_application_name=m("fallback_application_name",i,!1),this.statement_timeout=m("statement_timeout",i,!1),this.lock_timeout=m("lock_timeout",i,!1),this.idle_in_transaction_session_timeout=m("idle_in_transaction_session_timeout",i,!1),this.query_timeout=m("query_timeout",i,!1),i.connectionTimeoutMillis===void 0?this.connect_timeout=d.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(i.connectionTimeoutMillis/1e3),i.keepAlive===!1?this.keepalives=0:i.keepAlive===!0&&(this.keepalives=1),typeof i.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(i.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(i){const r=[];s(r,this,"user"),s(r,this,"password"),s(r,this,"port"),s(r,this,"application_name"),s(r,this,"fallback_application_name"),s(r,this,"connect_timeout"),s(r,this,"options");const n=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(s(r,n,"sslmode"),s(r,n,"sslca"),s(r,n,"sslkey"),s(r,n,"sslcert"),s(r,n,"sslrootcert"),this.database&&r.push("dbname="+a(this.database)),this.replication&&r.push("replication="+a(this.replication)),this.host&&r.push("host="+a(this.host)),this.isDomainSocket)return i(null,r.join(" "));this.client_encoding&&r.push("client_encoding="+a(this.client_encoding)),y.lookup(this.host,function(o,l){return o?i(o,null):(r.push("hostaddr="+a(l)),i(null,r.join(" ")))})}}return Ue=h,Ue}var ke,It;function or(){if(It)return ke;It=1;const d=me(),y=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/;class w{constructor(m,u){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=u,this.RowCtor=null,this.rowAsArray=m==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray),this._prebuiltEmptyResultObject=null}addCommandComplete(m){let u;m.text?u=y.exec(m.text):u=y.exec(m.command),u&&(this.command=u[1],u[3]?(this.oid=parseInt(u[2],10),this.rowCount=parseInt(u[3],10)):u[2]&&(this.rowCount=parseInt(u[2],10)))}_parseRowAsArray(m){const u=new Array(m.length);for(let a=0,s=m.length;a<s;a++){const h=m[a];h!==null?u[a]=this._parsers[a](h):u[a]=null}return u}parseRow(m){const u={...this._prebuiltEmptyResultObject};for(let a=0,s=m.length;a<s;a++){const h=m[a],f=this.fields[a].name;if(h!==null){const i=this.fields[a].format==="binary"?Buffer.from(h):h;u[f]=this._parsers[a](i)}else u[f]=null}return u}addRow(m){this.rows.push(m)}addFields(m){this.fields=m,this.fields.length&&(this._parsers=new Array(m.length));const u={};for(let a=0;a<m.length;a++){const s=m[a];u[s.name]=null,this._types?this._parsers[a]=this._types.getTypeParser(s.dataTypeID,s.format||"text"):this._parsers[a]=d.getTypeParser(s.dataTypeID,s.format||"text")}this._prebuiltEmptyResultObject={...u}}}return ke=w,ke}var qe,Lt;function Or(){if(Lt)return qe;Lt=1;const{EventEmitter:d}=ee(),y=or(),w=oe();class v extends d{constructor(u,a,s){super(),u=w.normalizeQueryConfig(u,a,s),this.text=u.text,this.values=u.values,this.rows=u.rows,this.types=u.types,this.name=u.name,this.queryMode=u.queryMode,this.binary=u.binary,this.portal=u.portal||"",this.callback=u.callback,this._rowMode=u.rowMode,process.domain&&u.callback&&(this.callback=process.domain.bind(u.callback)),this._result=new y(this._rowMode,this.types),this._results=this._result,this._canceledDueToError=!1}requiresPreparation(){return this.queryMode==="extended"||this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new y(this._rowMode,this._result._types),this._results.push(this._result))}handleRowDescription(u){this._checkForMultirow(),this._result.addFields(u.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(u){let a;if(!this._canceledDueToError){try{a=this._result.parseRow(u.fields)}catch(s){this._canceledDueToError=s;return}this.emit("row",a,this._result),this._accumulateRows&&this._result.addRow(a)}}handleCommandComplete(u,a){this._checkForMultirow(),this._result.addCommandComplete(u),this.rows&&a.sync()}handleEmptyQuery(u){this.rows&&u.sync()}handleError(u,a){if(this._canceledDueToError&&(u=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(u);this.emit("error",u)}handleReadyForQuery(u){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,u);if(this.callback)try{this.callback(null,this._results)}catch(a){process.nextTick(()=>{throw a})}this.emit("end",this._results)}submit(u){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");const a=u.parsedStatements[this.name];if(this.text&&a&&this.text!==a)return new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);if(this.values&&!Array.isArray(this.values))return new Error("Query values must be an array");if(this.requiresPreparation()){u.stream.cork&&u.stream.cork();try{this.prepare(u)}finally{u.stream.uncork&&u.stream.uncork()}}else u.query(this.text);return null}hasBeenParsed(u){return this.name&&u.parsedStatements[this.name]}handlePortalSuspended(u){this._getRows(u,this.rows)}_getRows(u,a){u.execute({portal:this.portal,rows:a}),a?u.flush():u.sync()}prepare(u){this.hasBeenParsed(u)||u.parse({text:this.text,name:this.name,types:this.types});try{u.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:w.prepareValue})}catch(a){this.handleError(a,u);return}u.describe({type:"P",name:this.portal||""}),this._getRows(u,this.rows)}handleCopyInResponse(u){u.sendCopyFail("No source stream defined")}handleCopyData(u,a){}}return qe=v,qe}var Qe={},O={},Mt;function ar(){if(Mt)return O;Mt=1,Object.defineProperty(O,"__esModule",{value:!0}),O.NoticeMessage=O.DataRowMessage=O.CommandCompleteMessage=O.ReadyForQueryMessage=O.NotificationResponseMessage=O.BackendKeyDataMessage=O.AuthenticationMD5Password=O.ParameterStatusMessage=O.ParameterDescriptionMessage=O.RowDescriptionMessage=O.Field=O.CopyResponse=O.CopyDataMessage=O.DatabaseError=O.copyDone=O.emptyQuery=O.replicationStart=O.portalSuspended=O.noData=O.closeComplete=O.bindComplete=O.parseComplete=void 0,O.parseComplete={name:"parseComplete",length:5},O.bindComplete={name:"bindComplete",length:5},O.closeComplete={name:"closeComplete",length:5},O.noData={name:"noData",length:5},O.portalSuspended={name:"portalSuspended",length:5},O.replicationStart={name:"replicationStart",length:4},O.emptyQuery={name:"emptyQuery",length:4},O.copyDone={name:"copyDone",length:4};class d extends Error{constructor(E,b,_){super(E),this.length=b,this.name=_}}O.DatabaseError=d;class y{constructor(E,b){this.length=E,this.chunk=b,this.name="copyData"}}O.CopyDataMessage=y;class w{constructor(E,b,_,R){this.length=E,this.name=b,this.binary=_,this.columnTypes=new Array(R)}}O.CopyResponse=w;class v{constructor(E,b,_,R,x,T,S){this.name=E,this.tableID=b,this.columnID=_,this.dataTypeID=R,this.dataTypeSize=x,this.dataTypeModifier=T,this.format=S}}O.Field=v;class m{constructor(E,b){this.length=E,this.fieldCount=b,this.name="rowDescription",this.fields=new Array(this.fieldCount)}}O.RowDescriptionMessage=m;class u{constructor(E,b){this.length=E,this.parameterCount=b,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}}O.ParameterDescriptionMessage=u;class a{constructor(E,b,_){this.length=E,this.parameterName=b,this.parameterValue=_,this.name="parameterStatus"}}O.ParameterStatusMessage=a;class s{constructor(E,b){this.length=E,this.salt=b,this.name="authenticationMD5Password"}}O.AuthenticationMD5Password=s;class h{constructor(E,b,_){this.length=E,this.processID=b,this.secretKey=_,this.name="backendKeyData"}}O.BackendKeyDataMessage=h;class f{constructor(E,b,_,R){this.length=E,this.processId=b,this.channel=_,this.payload=R,this.name="notification"}}O.NotificationResponseMessage=f;class i{constructor(E,b){this.length=E,this.status=b,this.name="readyForQuery"}}O.ReadyForQueryMessage=i;class r{constructor(E,b){this.length=E,this.text=b,this.name="commandComplete"}}O.CommandCompleteMessage=r;class n{constructor(E,b){this.length=E,this.fields=b,this.name="dataRow",this.fieldCount=b.length}}O.DataRowMessage=n;class o{constructor(E,b){this.length=E,this.message=b,this.name="notice"}}return O.NoticeMessage=o,O}var te={},re={},Pt;function Dr(){if(Pt)return re;Pt=1,Object.defineProperty(re,"__esModule",{value:!0}),re.Writer=void 0;class d{constructor(w=256){this.size=w,this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(w)}ensure(w){if(this.buffer.length-this.offset<w){const m=this.buffer,u=m.length+(m.length>>1)+w;this.buffer=Buffer.allocUnsafe(u),m.copy(this.buffer)}}addInt32(w){return this.ensure(4),this.buffer[this.offset++]=w>>>24&255,this.buffer[this.offset++]=w>>>16&255,this.buffer[this.offset++]=w>>>8&255,this.buffer[this.offset++]=w>>>0&255,this}addInt16(w){return this.ensure(2),this.buffer[this.offset++]=w>>>8&255,this.buffer[this.offset++]=w>>>0&255,this}addCString(w){if(!w)this.ensure(1);else{const v=Buffer.byteLength(w);this.ensure(v+1),this.buffer.write(w,this.offset,"utf-8"),this.offset+=v}return this.buffer[this.offset++]=0,this}addString(w=""){const v=Buffer.byteLength(w);return this.ensure(v),this.buffer.write(w,this.offset),this.offset+=v,this}add(w){return this.ensure(w.length),w.copy(this.buffer,this.offset),this.offset+=w.length,this}join(w){if(w){this.buffer[this.headerPosition]=w;const v=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(v,this.headerPosition+1)}return this.buffer.slice(w?0:5,this.offset)}flush(w){const v=this.join(w);return this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(this.size),v}}return re.Writer=d,re}var Nt;function Ur(){if(Nt)return te;Nt=1,Object.defineProperty(te,"__esModule",{value:!0}),te.serialize=void 0;const d=Dr(),y=new d.Writer,w=N=>{y.addInt16(3).addInt16(0);for(const Q of Object.keys(N))y.addCString(Q).addCString(N[Q]);y.addCString("client_encoding").addCString("UTF8");const D=y.addCString("").flush(),k=D.length+4;return new d.Writer().addInt32(k).add(D).flush()},v=()=>{const N=Buffer.allocUnsafe(8);return N.writeInt32BE(8,0),N.writeInt32BE(80877103,4),N},m=N=>y.addCString(N).flush(112),u=function(N,D){return y.addCString(N).addInt32(Buffer.byteLength(D)).addString(D),y.flush(112)},a=function(N){return y.addString(N).flush(112)},s=N=>y.addCString(N).flush(81),h=[],f=N=>{const D=N.name||"";D.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",D,D.length),console.error("This can cause conflicts and silent errors executing queries"));const k=N.types||h,Q=k.length,Y=y.addCString(D).addCString(N.text).addInt16(Q);for(let V=0;V<Q;V++)Y.addInt32(k[V]);return y.flush(80)},i=new d.Writer,r=function(N,D){for(let k=0;k<N.length;k++){const Q=D?D(N[k],k):N[k];Q==null?(y.addInt16(0),i.addInt32(-1)):Q instanceof Buffer?(y.addInt16(1),i.addInt32(Q.length),i.add(Q)):(y.addInt16(0),i.addInt32(Buffer.byteLength(Q)),i.addString(Q))}},n=(N={})=>{const D=N.portal||"",k=N.statement||"",Q=N.binary||!1,Y=N.values||h,V=Y.length;return y.addCString(D).addCString(k),y.addInt16(V),r(Y,N.valueMapper),y.addInt16(V),y.add(i.flush()),y.addInt16(1),y.addInt16(Q?1:0),y.flush(66)},o=Buffer.from([69,0,0,0,9,0,0,0,0,0]),l=N=>{if(!N||!N.portal&&!N.rows)return o;const D=N.portal||"",k=N.rows||0,Q=Buffer.byteLength(D),Y=4+Q+1+4,V=Buffer.allocUnsafe(1+Y);return V[0]=69,V.writeInt32BE(Y,1),V.write(D,5,"utf-8"),V[Q+5]=0,V.writeUInt32BE(k,V.length-4),V},E=(N,D)=>{const k=Buffer.allocUnsafe(16);return k.writeInt32BE(16,0),k.writeInt16BE(1234,4),k.writeInt16BE(5678,6),k.writeInt32BE(N,8),k.writeInt32BE(D,12),k},b=(N,D)=>{const Q=4+Buffer.byteLength(D)+1,Y=Buffer.allocUnsafe(1+Q);return Y[0]=N,Y.writeInt32BE(Q,1),Y.write(D,5,"utf-8"),Y[Q]=0,Y},_=y.addCString("P").flush(68),R=y.addCString("S").flush(68),x=N=>N.name?b(68,`${N.type}${N.name||""}`):N.type==="P"?_:R,T=N=>{const D=`${N.type}${N.name||""}`;return b(67,D)},S=N=>y.add(N).flush(100),C=N=>b(102,N),g=N=>Buffer.from([N,0,0,0,4]),I=g(72),P=g(83),F=g(88),B=g(99),j={startup:w,password:m,requestSsl:v,sendSASLInitialResponseMessage:u,sendSCRAMClientFinalMessage:a,query:s,parse:f,bind:n,execute:l,describe:x,close:T,flush:()=>I,sync:()=>P,end:()=>F,copyData:S,copyDone:()=>B,copyFail:C,cancel:E};return te.serialize=j,te}var ne={},ie={},Ft;function kr(){if(Ft)return ie;Ft=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.BufferReader=void 0;const d=Buffer.allocUnsafe(0);class y{constructor(v=0){this.offset=v,this.buffer=d,this.encoding="utf-8"}setBuffer(v,m){this.offset=v,this.buffer=m}int16(){const v=this.buffer.readInt16BE(this.offset);return this.offset+=2,v}byte(){const v=this.buffer[this.offset];return this.offset++,v}int32(){const v=this.buffer.readInt32BE(this.offset);return this.offset+=4,v}uint32(){const v=this.buffer.readUInt32BE(this.offset);return this.offset+=4,v}string(v){const m=this.buffer.toString(this.encoding,this.offset,this.offset+v);return this.offset+=v,m}cstring(){const v=this.offset;let m=v;for(;this.buffer[m++]!==0;);return this.offset=m,this.buffer.toString(this.encoding,v,m-1)}bytes(v){const m=this.buffer.slice(this.offset,this.offset+v);return this.offset+=v,m}}return ie.BufferReader=y,ie}var Bt;function qr(){if(Bt)return ne;Bt=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.Parser=void 0;const d=ar(),y=kr(),w=1,m=w+4,u=Buffer.allocUnsafe(0);class a{constructor(h){if(this.buffer=u,this.bufferLength=0,this.bufferOffset=0,this.reader=new y.BufferReader,h?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=h?.mode||"text"}parse(h,f){this.mergeBuffer(h);const i=this.bufferOffset+this.bufferLength;let r=this.bufferOffset;for(;r+m<=i;){const n=this.buffer[r],o=this.buffer.readUInt32BE(r+w),l=w+o;if(l+r<=i){const E=this.handlePacket(r+m,n,o,this.buffer);f(E),r+=l}else break}r===i?(this.buffer=u,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=i-r,this.bufferOffset=r)}mergeBuffer(h){if(this.bufferLength>0){const f=this.bufferLength+h.byteLength;if(f+this.bufferOffset>this.buffer.byteLength){let r;if(f<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)r=this.buffer;else{let n=this.buffer.byteLength*2;for(;f>=n;)n*=2;r=Buffer.allocUnsafe(n)}this.buffer.copy(r,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=r,this.bufferOffset=0}h.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=f}else this.buffer=h,this.bufferOffset=0,this.bufferLength=h.byteLength}handlePacket(h,f,i,r){switch(f){case 50:return d.bindComplete;case 49:return d.parseComplete;case 51:return d.closeComplete;case 110:return d.noData;case 115:return d.portalSuspended;case 99:return d.copyDone;case 87:return d.replicationStart;case 73:return d.emptyQuery;case 68:return this.parseDataRowMessage(h,i,r);case 67:return this.parseCommandCompleteMessage(h,i,r);case 90:return this.parseReadyForQueryMessage(h,i,r);case 65:return this.parseNotificationMessage(h,i,r);case 82:return this.parseAuthenticationResponse(h,i,r);case 83:return this.parseParameterStatusMessage(h,i,r);case 75:return this.parseBackendKeyData(h,i,r);case 69:return this.parseErrorMessage(h,i,r,"error");case 78:return this.parseErrorMessage(h,i,r,"notice");case 84:return this.parseRowDescriptionMessage(h,i,r);case 116:return this.parseParameterDescriptionMessage(h,i,r);case 71:return this.parseCopyInMessage(h,i,r);case 72:return this.parseCopyOutMessage(h,i,r);case 100:return this.parseCopyData(h,i,r);default:return new d.DatabaseError("received invalid response: "+f.toString(16),i,"error")}}parseReadyForQueryMessage(h,f,i){this.reader.setBuffer(h,i);const r=this.reader.string(1);return new d.ReadyForQueryMessage(f,r)}parseCommandCompleteMessage(h,f,i){this.reader.setBuffer(h,i);const r=this.reader.cstring();return new d.CommandCompleteMessage(f,r)}parseCopyData(h,f,i){const r=i.slice(h,h+(f-4));return new d.CopyDataMessage(f,r)}parseCopyInMessage(h,f,i){return this.parseCopyMessage(h,f,i,"copyInResponse")}parseCopyOutMessage(h,f,i){return this.parseCopyMessage(h,f,i,"copyOutResponse")}parseCopyMessage(h,f,i,r){this.reader.setBuffer(h,i);const n=this.reader.byte()!==0,o=this.reader.int16(),l=new d.CopyResponse(f,r,n,o);for(let E=0;E<o;E++)l.columnTypes[E]=this.reader.int16();return l}parseNotificationMessage(h,f,i){this.reader.setBuffer(h,i);const r=this.reader.int32(),n=this.reader.cstring(),o=this.reader.cstring();return new d.NotificationResponseMessage(f,r,n,o)}parseRowDescriptionMessage(h,f,i){this.reader.setBuffer(h,i);const r=this.reader.int16(),n=new d.RowDescriptionMessage(f,r);for(let o=0;o<r;o++)n.fields[o]=this.parseField();return n}parseField(){const h=this.reader.cstring(),f=this.reader.uint32(),i=this.reader.int16(),r=this.reader.uint32(),n=this.reader.int16(),o=this.reader.int32(),l=this.reader.int16()===0?"text":"binary";return new d.Field(h,f,i,r,n,o,l)}parseParameterDescriptionMessage(h,f,i){this.reader.setBuffer(h,i);const r=this.reader.int16(),n=new d.ParameterDescriptionMessage(f,r);for(let o=0;o<r;o++)n.dataTypeIDs[o]=this.reader.int32();return n}parseDataRowMessage(h,f,i){this.reader.setBuffer(h,i);const r=this.reader.int16(),n=new Array(r);for(let o=0;o<r;o++){const l=this.reader.int32();n[o]=l===-1?null:this.reader.string(l)}return new d.DataRowMessage(f,n)}parseParameterStatusMessage(h,f,i){this.reader.setBuffer(h,i);const r=this.reader.cstring(),n=this.reader.cstring();return new d.ParameterStatusMessage(f,r,n)}parseBackendKeyData(h,f,i){this.reader.setBuffer(h,i);const r=this.reader.int32(),n=this.reader.int32();return new d.BackendKeyDataMessage(f,r,n)}parseAuthenticationResponse(h,f,i){this.reader.setBuffer(h,i);const r=this.reader.int32(),n={name:"authenticationOk",length:f};switch(r){case 0:break;case 3:n.length===8&&(n.name="authenticationCleartextPassword");break;case 5:if(n.length===12){n.name="authenticationMD5Password";const o=this.reader.bytes(4);return new d.AuthenticationMD5Password(f,o)}break;case 10:{n.name="authenticationSASL",n.mechanisms=[];let o;do o=this.reader.cstring(),o&&n.mechanisms.push(o);while(o)}break;case 11:n.name="authenticationSASLContinue",n.data=this.reader.string(f-8);break;case 12:n.name="authenticationSASLFinal",n.data=this.reader.string(f-8);break;default:throw new Error("Unknown authenticationOk message type "+r)}return n}parseErrorMessage(h,f,i,r){this.reader.setBuffer(h,i);const n={};let o=this.reader.string(1);for(;o!=="\0";)n[o]=this.reader.cstring(),o=this.reader.string(1);const l=n.M,E=r==="notice"?new d.NoticeMessage(f,l):new d.DatabaseError(l,f,r);return E.severity=n.S,E.code=n.C,E.detail=n.D,E.hint=n.H,E.position=n.P,E.internalPosition=n.p,E.internalQuery=n.q,E.where=n.W,E.schema=n.s,E.table=n.t,E.column=n.c,E.dataType=n.d,E.constraint=n.n,E.file=n.F,E.line=n.L,E.routine=n.R,E}}return ne.Parser=a,ne}var Ot;function ur(){return Ot||(Ot=1,function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.DatabaseError=d.serialize=d.parse=void 0;const y=ar();Object.defineProperty(d,"DatabaseError",{enumerable:!0,get:function(){return y.DatabaseError}});const w=Ur();Object.defineProperty(d,"serialize",{enumerable:!0,get:function(){return w.serialize}});const v=qr();function m(u,a){const s=new v.Parser;return u.on("data",h=>s.parse(h,a)),new Promise(h=>u.on("end",()=>h()))}d.parse=m}(Qe)),Qe}var fe={},Dt;function Qr(){return Dt||(Dt=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.default={}),fe}var He,Ut;function Hr(){if(Ut)return He;Ut=1;const{getStream:d,getSecureStream:y}=u();He={getStream:d,getSecureStream:y};function w(){function a(h){const f=$;return new f.Socket}function s(h){return $.connect(h)}return{getStream:a,getSecureStream:s}}function v(){function a(h){const{CloudflareSocket:f}=Qr();return new f(h)}function s(h){return h.socket.startTls(h),h.socket}return{getStream:a,getSecureStream:s}}function m(){if(typeof navigator=="object"&&navigator!==null&&typeof navigator.userAgent=="string")return navigator.userAgent==="Cloudflare-Workers";if(typeof Response=="function"){const a=new Response(null,{cf:{thing:!0}});if(typeof a.cf=="object"&&a.cf!==null&&a.cf.thing)return!0}return!1}function u(){return m()?v():w()}return He}var je,kt;function cr(){if(kt)return je;kt=1;const d=ee().EventEmitter,{parse:y,serialize:w}=ur(),{getStream:v,getSecureStream:m}=Hr(),u=w.flush(),a=w.sync(),s=w.end();class h extends d{constructor(i){super(),i=i||{},this.stream=i.stream||v(i.ssl),typeof this.stream=="function"&&(this.stream=this.stream(i)),this._keepAlive=i.keepAlive,this._keepAliveInitialDelayMillis=i.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=i.ssl||!1,this._ending=!1,this._emitMessage=!1;const r=this;this.on("newListener",function(n){n==="message"&&(r._emitMessage=!0)})}connect(i,r){const n=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(i,r),this.stream.once("connect",function(){n._keepAlive&&n.stream.setKeepAlive(!0,n._keepAliveInitialDelayMillis),n.emit("connect")});const o=function(l){n._ending&&(l.code==="ECONNRESET"||l.code==="EPIPE")||n.emit("error",l)};if(this.stream.on("error",o),this.stream.on("close",function(){n.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(l){switch(l.toString("utf8")){case"S":break;case"N":return n.stream.end(),n.emit("error",new Error("The server does not support SSL connections"));default:return n.stream.end(),n.emit("error",new Error("There was an error establishing an SSL connection"))}const b={socket:n.stream};n.ssl!==!0&&(Object.assign(b,n.ssl),"key"in n.ssl&&(b.key=n.ssl.key));const _=$;_.isIP&&_.isIP(r)===0&&(b.servername=r);try{n.stream=m(b)}catch(R){return n.emit("error",R)}n.attachListeners(n.stream),n.stream.on("error",o),n.emit("sslconnect")})}attachListeners(i){y(i,r=>{const n=r.name==="error"?"errorMessage":r.name;this._emitMessage&&this.emit("message",r),this.emit(n,r)})}requestSsl(){this.stream.write(w.requestSsl())}startup(i){this.stream.write(w.startup(i))}cancel(i,r){this._send(w.cancel(i,r))}password(i){this._send(w.password(i))}sendSASLInitialResponseMessage(i,r){this._send(w.sendSASLInitialResponseMessage(i,r))}sendSCRAMClientFinalMessage(i){this._send(w.sendSCRAMClientFinalMessage(i))}_send(i){return this.stream.writable?this.stream.write(i):!1}query(i){this._send(w.query(i))}parse(i){this._send(w.parse(i))}bind(i){this._send(w.bind(i))}execute(i){this._send(w.execute(i))}flush(){this.stream.writable&&this.stream.write(u)}sync(){this._ending=!0,this._send(a)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(s,()=>{this.stream.end()})}close(i){this._send(w.close(i))}describe(i){this._send(w.describe(i))}sendCopyFromChunk(i){this._send(w.copyData(i))}endCopyFrom(){this._send(w.copyDone())}sendCopyFail(i){this._send(w.copyFail(i))}}return je=h,je}var le={exports:{}},Ge={exports:{}},Ye={},pe={exports:{}},Ke={},se={},qt;function jr(){if(qt)return se;qt=1,se.byteLength=s,se.toByteArray=f,se.fromByteArray=n;for(var d=[],y=[],w=typeof Uint8Array<"u"?Uint8Array:Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0,u=v.length;m<u;++m)d[m]=v[m],y[v.charCodeAt(m)]=m;y[45]=62,y[95]=63;function a(o){var l=o.length;if(l%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var E=o.indexOf("=");E===-1&&(E=l);var b=E===l?0:4-E%4;return[E,b]}function s(o){var l=a(o),E=l[0],b=l[1];return(E+b)*3/4-b}function h(o,l,E){return(l+E)*3/4-E}function f(o){var l,E=a(o),b=E[0],_=E[1],R=new w(h(o,b,_)),x=0,T=_>0?b-4:b,S;for(S=0;S<T;S+=4)l=y[o.charCodeAt(S)]<<18|y[o.charCodeAt(S+1)]<<12|y[o.charCodeAt(S+2)]<<6|y[o.charCodeAt(S+3)],R[x++]=l>>16&255,R[x++]=l>>8&255,R[x++]=l&255;return _===2&&(l=y[o.charCodeAt(S)]<<2|y[o.charCodeAt(S+1)]>>4,R[x++]=l&255),_===1&&(l=y[o.charCodeAt(S)]<<10|y[o.charCodeAt(S+1)]<<4|y[o.charCodeAt(S+2)]>>2,R[x++]=l>>8&255,R[x++]=l&255),R}function i(o){return d[o>>18&63]+d[o>>12&63]+d[o>>6&63]+d[o&63]}function r(o,l,E){for(var b,_=[],R=l;R<E;R+=3)b=(o[R]<<16&16711680)+(o[R+1]<<8&65280)+(o[R+2]&255),_.push(i(b));return _.join("")}function n(o){for(var l,E=o.length,b=E%3,_=[],R=16383,x=0,T=E-b;x<T;x+=R)_.push(r(o,x,x+R>T?T:x+R));return b===1?(l=o[E-1],_.push(d[l>>2]+d[l<<4&63]+"==")):b===2&&(l=(o[E-2]<<8)+o[E-1],_.push(d[l>>10]+d[l>>4&63]+d[l<<2&63]+"=")),_.join("")}return se}var de={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Qt;function Gr(){return Qt||(Qt=1,de.read=function(d,y,w,v,m){var u,a,s=m*8-v-1,h=(1<<s)-1,f=h>>1,i=-7,r=w?m-1:0,n=w?-1:1,o=d[y+r];for(r+=n,u=o&(1<<-i)-1,o>>=-i,i+=s;i>0;u=u*256+d[y+r],r+=n,i-=8);for(a=u&(1<<-i)-1,u>>=-i,i+=v;i>0;a=a*256+d[y+r],r+=n,i-=8);if(u===0)u=1-f;else{if(u===h)return a?NaN:(o?-1:1)*(1/0);a=a+Math.pow(2,v),u=u-f}return(o?-1:1)*a*Math.pow(2,u-v)},de.write=function(d,y,w,v,m,u){var a,s,h,f=u*8-m-1,i=(1<<f)-1,r=i>>1,n=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,o=v?0:u-1,l=v?1:-1,E=y<0||y===0&&1/y<0?1:0;for(y=Math.abs(y),isNaN(y)||y===1/0?(s=isNaN(y)?1:0,a=i):(a=Math.floor(Math.log(y)/Math.LN2),y*(h=Math.pow(2,-a))<1&&(a--,h*=2),a+r>=1?y+=n/h:y+=n*Math.pow(2,1-r),y*h>=2&&(a++,h/=2),a+r>=i?(s=0,a=i):a+r>=1?(s=(y*h-1)*Math.pow(2,m),a=a+r):(s=y*Math.pow(2,r-1)*Math.pow(2,m),a=0));m>=8;d[w+o]=s&255,o+=l,s/=256,m-=8);for(a=a<<m|s,f+=m;f>0;d[w+o]=a&255,o+=l,a/=256,f-=8);d[w+o-l]|=E*128}),de}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Ht;function Yr(){return Ht||(Ht=1,function(d){var y=jr(),w=Gr(),v=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;d.Buffer=s,d.SlowBuffer=R,d.INSPECT_MAX_BYTES=50;var m=2147483647;d.kMaxLength=m,s.TYPED_ARRAY_SUPPORT=u(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function u(){try{var c=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(c,e),c.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function a(c){if(c>m)throw new RangeError('The value "'+c+'" is invalid for option "size"');var e=new Uint8Array(c);return Object.setPrototypeOf(e,s.prototype),e}function s(c,e,t){if(typeof c=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return r(c)}return h(c,e,t)}s.poolSize=8192;function h(c,e,t){if(typeof c=="string")return n(c,e);if(ArrayBuffer.isView(c))return l(c);if(c==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(J(c,ArrayBuffer)||c&&J(c.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(J(c,SharedArrayBuffer)||c&&J(c.buffer,SharedArrayBuffer)))return E(c,e,t);if(typeof c=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var p=c.valueOf&&c.valueOf();if(p!=null&&p!==c)return s.from(p,e,t);var A=b(c);if(A)return A;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof c[Symbol.toPrimitive]=="function")return s.from(c[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}s.from=function(c,e,t){return h(c,e,t)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function f(c){if(typeof c!="number")throw new TypeError('"size" argument must be of type number');if(c<0)throw new RangeError('The value "'+c+'" is invalid for option "size"')}function i(c,e,t){return f(c),c<=0?a(c):e!==void 0?typeof t=="string"?a(c).fill(e,t):a(c).fill(e):a(c)}s.alloc=function(c,e,t){return i(c,e,t)};function r(c){return f(c),a(c<0?0:_(c)|0)}s.allocUnsafe=function(c){return r(c)},s.allocUnsafeSlow=function(c){return r(c)};function n(c,e){if((typeof e!="string"||e==="")&&(e="utf8"),!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var t=x(c,e)|0,p=a(t),A=p.write(c,e);return A!==t&&(p=p.slice(0,A)),p}function o(c){for(var e=c.length<0?0:_(c.length)|0,t=a(e),p=0;p<e;p+=1)t[p]=c[p]&255;return t}function l(c){if(J(c,Uint8Array)){var e=new Uint8Array(c);return E(e.buffer,e.byteOffset,e.byteLength)}return o(c)}function E(c,e,t){if(e<0||c.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');var p;return e===void 0&&t===void 0?p=new Uint8Array(c):t===void 0?p=new Uint8Array(c,e):p=new Uint8Array(c,e,t),Object.setPrototypeOf(p,s.prototype),p}function b(c){if(s.isBuffer(c)){var e=_(c.length)|0,t=a(e);return t.length===0||c.copy(t,0,0,e),t}if(c.length!==void 0)return typeof c.length!="number"||we(c.length)?a(0):o(c);if(c.type==="Buffer"&&Array.isArray(c.data))return o(c.data)}function _(c){if(c>=m)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+m.toString(16)+" bytes");return c|0}function R(c){return+c!=c&&(c=0),s.alloc(+c)}s.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==s.prototype},s.compare=function(e,t){if(J(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var p=e.length,A=t.length,L=0,M=Math.min(p,A);L<M;++L)if(e[L]!==t[L]){p=e[L],A=t[L];break}return p<A?-1:A<p?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return s.alloc(0);var p;if(t===void 0)for(t=0,p=0;p<e.length;++p)t+=e[p].length;var A=s.allocUnsafe(t),L=0;for(p=0;p<e.length;++p){var M=e[p];if(J(M,Uint8Array))L+M.length>A.length?s.from(M).copy(A,L):Uint8Array.prototype.set.call(A,M,L);else if(s.isBuffer(M))M.copy(A,L);else throw new TypeError('"list" argument must be an Array of Buffers');L+=M.length}return A};function x(c,e){if(s.isBuffer(c))return c.length;if(ArrayBuffer.isView(c)||J(c,ArrayBuffer))return c.byteLength;if(typeof c!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);var t=c.length,p=arguments.length>2&&arguments[2]===!0;if(!p&&t===0)return 0;for(var A=!1;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Ee(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return it(c).length;default:if(A)return p?-1:Ee(c).length;e=(""+e).toLowerCase(),A=!0}}s.byteLength=x;function T(c,e,t){var p=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(c||(c="utf8");;)switch(c){case"hex":return pr(this,e,t);case"utf8":case"utf-8":return D(this,e,t);case"ascii":return Y(this,e,t);case"latin1":case"binary":return V(this,e,t);case"base64":return N(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return dr(this,e,t);default:if(p)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),p=!0}}s.prototype._isBuffer=!0;function S(c,e,t){var p=c[e];c[e]=c[t],c[t]=p}s.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)S(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?D(this,0,e):T.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:s.compare(this,e)===0},s.prototype.inspect=function(){var e="",t=d.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},v&&(s.prototype[v]=s.prototype.inspect),s.prototype.compare=function(e,t,p,A,L){if(J(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),p===void 0&&(p=e?e.length:0),A===void 0&&(A=0),L===void 0&&(L=this.length),t<0||p>e.length||A<0||L>this.length)throw new RangeError("out of range index");if(A>=L&&t>=p)return 0;if(A>=L)return-1;if(t>=p)return 1;if(t>>>=0,p>>>=0,A>>>=0,L>>>=0,this===e)return 0;for(var M=L-A,U=p-t,q=Math.min(M,U),H=this.slice(A,L),W=e.slice(t,p),G=0;G<q;++G)if(H[G]!==W[G]){M=H[G],U=W[G];break}return M<U?-1:U<M?1:0};function C(c,e,t,p,A){if(c.length===0)return-1;if(typeof t=="string"?(p=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,we(t)&&(t=A?0:c.length-1),t<0&&(t=c.length+t),t>=c.length){if(A)return-1;t=c.length-1}else if(t<0)if(A)t=0;else return-1;if(typeof e=="string"&&(e=s.from(e,p)),s.isBuffer(e))return e.length===0?-1:g(c,e,t,p,A);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?A?Uint8Array.prototype.indexOf.call(c,e,t):Uint8Array.prototype.lastIndexOf.call(c,e,t):g(c,[e],t,p,A);throw new TypeError("val must be string, number or Buffer")}function g(c,e,t,p,A){var L=1,M=c.length,U=e.length;if(p!==void 0&&(p=String(p).toLowerCase(),p==="ucs2"||p==="ucs-2"||p==="utf16le"||p==="utf-16le")){if(c.length<2||e.length<2)return-1;L=2,M/=2,U/=2,t/=2}function q(st,ot){return L===1?st[ot]:st.readUInt16BE(ot*L)}var H;if(A){var W=-1;for(H=t;H<M;H++)if(q(c,H)===q(e,W===-1?0:H-W)){if(W===-1&&(W=H),H-W+1===U)return W*L}else W!==-1&&(H-=H-W),W=-1}else for(t+U>M&&(t=M-U),H=t;H>=0;H--){for(var G=!0,ue=0;ue<U;ue++)if(q(c,H+ue)!==q(e,ue)){G=!1;break}if(G)return H}return-1}s.prototype.includes=function(e,t,p){return this.indexOf(e,t,p)!==-1},s.prototype.indexOf=function(e,t,p){return C(this,e,t,p,!0)},s.prototype.lastIndexOf=function(e,t,p){return C(this,e,t,p,!1)};function I(c,e,t,p){t=Number(t)||0;var A=c.length-t;p?(p=Number(p),p>A&&(p=A)):p=A;var L=e.length;p>L/2&&(p=L/2);for(var M=0;M<p;++M){var U=parseInt(e.substr(M*2,2),16);if(we(U))return M;c[t+M]=U}return M}function P(c,e,t,p){return ae(Ee(e,c.length-t),c,t,p)}function F(c,e,t,p){return ae(Er(e),c,t,p)}function B(c,e,t,p){return ae(it(e),c,t,p)}function j(c,e,t,p){return ae(wr(e,c.length-t),c,t,p)}s.prototype.write=function(e,t,p,A){if(t===void 0)A="utf8",p=this.length,t=0;else if(p===void 0&&typeof t=="string")A=t,p=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(p)?(p=p>>>0,A===void 0&&(A="utf8")):(A=p,p=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var L=this.length-t;if((p===void 0||p>L)&&(p=L),e.length>0&&(p<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");for(var M=!1;;)switch(A){case"hex":return I(this,e,t,p);case"utf8":case"utf-8":return P(this,e,t,p);case"ascii":case"latin1":case"binary":return F(this,e,t,p);case"base64":return B(this,e,t,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,e,t,p);default:if(M)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),M=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function N(c,e,t){return e===0&&t===c.length?y.fromByteArray(c):y.fromByteArray(c.slice(e,t))}function D(c,e,t){t=Math.min(c.length,t);for(var p=[],A=e;A<t;){var L=c[A],M=null,U=L>239?4:L>223?3:L>191?2:1;if(A+U<=t){var q,H,W,G;switch(U){case 1:L<128&&(M=L);break;case 2:q=c[A+1],(q&192)===128&&(G=(L&31)<<6|q&63,G>127&&(M=G));break;case 3:q=c[A+1],H=c[A+2],(q&192)===128&&(H&192)===128&&(G=(L&15)<<12|(q&63)<<6|H&63,G>2047&&(G<55296||G>57343)&&(M=G));break;case 4:q=c[A+1],H=c[A+2],W=c[A+3],(q&192)===128&&(H&192)===128&&(W&192)===128&&(G=(L&15)<<18|(q&63)<<12|(H&63)<<6|W&63,G>65535&&G<1114112&&(M=G))}}M===null?(M=65533,U=1):M>65535&&(M-=65536,p.push(M>>>10&1023|55296),M=56320|M&1023),p.push(M),A+=U}return Q(p)}var k=4096;function Q(c){var e=c.length;if(e<=k)return String.fromCharCode.apply(String,c);for(var t="",p=0;p<e;)t+=String.fromCharCode.apply(String,c.slice(p,p+=k));return t}function Y(c,e,t){var p="";t=Math.min(c.length,t);for(var A=e;A<t;++A)p+=String.fromCharCode(c[A]&127);return p}function V(c,e,t){var p="";t=Math.min(c.length,t);for(var A=e;A<t;++A)p+=String.fromCharCode(c[A]);return p}function pr(c,e,t){var p=c.length;(!e||e<0)&&(e=0),(!t||t<0||t>p)&&(t=p);for(var A="",L=e;L<t;++L)A+=gr[c[L]];return A}function dr(c,e,t){for(var p=c.slice(e,t),A="",L=0;L<p.length-1;L+=2)A+=String.fromCharCode(p[L]+p[L+1]*256);return A}s.prototype.slice=function(e,t){var p=this.length;e=~~e,t=t===void 0?p:~~t,e<0?(e+=p,e<0&&(e=0)):e>p&&(e=p),t<0?(t+=p,t<0&&(t=0)):t>p&&(t=p),t<e&&(t=e);var A=this.subarray(e,t);return Object.setPrototypeOf(A,s.prototype),A};function K(c,e,t){if(c%1!==0||c<0)throw new RangeError("offset is not uint");if(c+e>t)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,p){e=e>>>0,t=t>>>0,p||K(e,t,this.length);for(var A=this[e],L=1,M=0;++M<t&&(L*=256);)A+=this[e+M]*L;return A},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,p){e=e>>>0,t=t>>>0,p||K(e,t,this.length);for(var A=this[e+--t],L=1;t>0&&(L*=256);)A+=this[e+--t]*L;return A},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e=e>>>0,t||K(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||K(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||K(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||K(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||K(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,p){e=e>>>0,t=t>>>0,p||K(e,t,this.length);for(var A=this[e],L=1,M=0;++M<t&&(L*=256);)A+=this[e+M]*L;return L*=128,A>=L&&(A-=Math.pow(2,8*t)),A},s.prototype.readIntBE=function(e,t,p){e=e>>>0,t=t>>>0,p||K(e,t,this.length);for(var A=t,L=1,M=this[e+--A];A>0&&(L*=256);)M+=this[e+--A]*L;return L*=128,M>=L&&(M-=Math.pow(2,8*t)),M},s.prototype.readInt8=function(e,t){return e=e>>>0,t||K(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},s.prototype.readInt16LE=function(e,t){e=e>>>0,t||K(e,2,this.length);var p=this[e]|this[e+1]<<8;return p&32768?p|4294901760:p},s.prototype.readInt16BE=function(e,t){e=e>>>0,t||K(e,2,this.length);var p=this[e+1]|this[e]<<8;return p&32768?p|4294901760:p},s.prototype.readInt32LE=function(e,t){return e=e>>>0,t||K(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e=e>>>0,t||K(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e=e>>>0,t||K(e,4,this.length),w.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e=e>>>0,t||K(e,4,this.length),w.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||K(e,8,this.length),w.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||K(e,8,this.length),w.read(this,e,!1,52,8)};function X(c,e,t,p,A,L){if(!s.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>A||e<L)throw new RangeError('"value" argument is out of bounds');if(t+p>c.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,p,A){if(e=+e,t=t>>>0,p=p>>>0,!A){var L=Math.pow(2,8*p)-1;X(this,e,t,p,L,0)}var M=1,U=0;for(this[t]=e&255;++U<p&&(M*=256);)this[t+U]=e/M&255;return t+p},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,p,A){if(e=+e,t=t>>>0,p=p>>>0,!A){var L=Math.pow(2,8*p)-1;X(this,e,t,p,L,0)}var M=p-1,U=1;for(this[t+M]=e&255;--M>=0&&(U*=256);)this[t+M]=e/U&255;return t+p},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,p){return e=+e,t=t>>>0,p||X(this,e,t,1,255,0),this[t]=e&255,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,p){return e=+e,t=t>>>0,p||X(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,p){return e=+e,t=t>>>0,p||X(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,p){return e=+e,t=t>>>0,p||X(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,p){return e=+e,t=t>>>0,p||X(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},s.prototype.writeIntLE=function(e,t,p,A){if(e=+e,t=t>>>0,!A){var L=Math.pow(2,8*p-1);X(this,e,t,p,L-1,-L)}var M=0,U=1,q=0;for(this[t]=e&255;++M<p&&(U*=256);)e<0&&q===0&&this[t+M-1]!==0&&(q=1),this[t+M]=(e/U>>0)-q&255;return t+p},s.prototype.writeIntBE=function(e,t,p,A){if(e=+e,t=t>>>0,!A){var L=Math.pow(2,8*p-1);X(this,e,t,p,L-1,-L)}var M=p-1,U=1,q=0;for(this[t+M]=e&255;--M>=0&&(U*=256);)e<0&&q===0&&this[t+M+1]!==0&&(q=1),this[t+M]=(e/U>>0)-q&255;return t+p},s.prototype.writeInt8=function(e,t,p){return e=+e,t=t>>>0,p||X(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},s.prototype.writeInt16LE=function(e,t,p){return e=+e,t=t>>>0,p||X(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,p){return e=+e,t=t>>>0,p||X(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},s.prototype.writeInt32LE=function(e,t,p){return e=+e,t=t>>>0,p||X(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,p){return e=+e,t=t>>>0,p||X(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function tt(c,e,t,p,A,L){if(t+p>c.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function rt(c,e,t,p,A){return e=+e,t=t>>>0,A||tt(c,e,t,4),w.write(c,e,t,p,23,4),t+4}s.prototype.writeFloatLE=function(e,t,p){return rt(this,e,t,!0,p)},s.prototype.writeFloatBE=function(e,t,p){return rt(this,e,t,!1,p)};function nt(c,e,t,p,A){return e=+e,t=t>>>0,A||tt(c,e,t,8),w.write(c,e,t,p,52,8),t+8}s.prototype.writeDoubleLE=function(e,t,p){return nt(this,e,t,!0,p)},s.prototype.writeDoubleBE=function(e,t,p){return nt(this,e,t,!1,p)},s.prototype.copy=function(e,t,p,A){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(p||(p=0),!A&&A!==0&&(A=this.length),t>=e.length&&(t=e.length),t||(t=0),A>0&&A<p&&(A=p),A===p||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(p<0||p>=this.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),e.length-t<A-p&&(A=e.length-t+p);var L=A-p;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,p,A):Uint8Array.prototype.set.call(e,this.subarray(p,A),t),L},s.prototype.fill=function(e,t,p,A){if(typeof e=="string"){if(typeof t=="string"?(A=t,t=0,p=this.length):typeof p=="string"&&(A=p,p=this.length),A!==void 0&&typeof A!="string")throw new TypeError("encoding must be a string");if(typeof A=="string"&&!s.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(e.length===1){var L=e.charCodeAt(0);(A==="utf8"&&L<128||A==="latin1")&&(e=L)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<p)throw new RangeError("Out of range index");if(p<=t)return this;t=t>>>0,p=p===void 0?this.length:p>>>0,e||(e=0);var M;if(typeof e=="number")for(M=t;M<p;++M)this[M]=e;else{var U=s.isBuffer(e)?e:s.from(e,A),q=U.length;if(q===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(M=0;M<p-t;++M)this[M+t]=U[M%q]}return this};var mr=/[^+/0-9A-Za-z-_]/g;function yr(c){if(c=c.split("=")[0],c=c.trim().replace(mr,""),c.length<2)return"";for(;c.length%4!==0;)c=c+"=";return c}function Ee(c,e){e=e||1/0;for(var t,p=c.length,A=null,L=[],M=0;M<p;++M){if(t=c.charCodeAt(M),t>55295&&t<57344){if(!A){if(t>56319){(e-=3)>-1&&L.push(239,191,189);continue}else if(M+1===p){(e-=3)>-1&&L.push(239,191,189);continue}A=t;continue}if(t<56320){(e-=3)>-1&&L.push(239,191,189),A=t;continue}t=(A-55296<<10|t-56320)+65536}else A&&(e-=3)>-1&&L.push(239,191,189);if(A=null,t<128){if((e-=1)<0)break;L.push(t)}else if(t<2048){if((e-=2)<0)break;L.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;L.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;L.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return L}function Er(c){for(var e=[],t=0;t<c.length;++t)e.push(c.charCodeAt(t)&255);return e}function wr(c,e){for(var t,p,A,L=[],M=0;M<c.length&&!((e-=2)<0);++M)t=c.charCodeAt(M),p=t>>8,A=t%256,L.push(A),L.push(p);return L}function it(c){return y.toByteArray(yr(c))}function ae(c,e,t,p){for(var A=0;A<p&&!(A+t>=e.length||A>=c.length);++A)e[A+t]=c[A];return A}function J(c,e){return c instanceof e||c!=null&&c.constructor!=null&&c.constructor.name!=null&&c.constructor.name===e.name}function we(c){return c!==c}var gr=function(){for(var c="0123456789abcdef",e=new Array(256),t=0;t<16;++t)for(var p=t*16,A=0;A<16;++A)e[p+A]=c[t]+c[A];return e}()}(Ke)),Ke}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var jt;function Kr(){return jt||(jt=1,function(d,y){var w=Yr(),v=w.Buffer;function m(a,s){for(var h in a)s[h]=a[h]}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?d.exports=w:(m(w,y),y.Buffer=u);function u(a,s,h){return v(a,s,h)}u.prototype=Object.create(v.prototype),m(v,u),u.from=function(a,s,h){if(typeof a=="number")throw new TypeError("Argument must not be a number");return v(a,s,h)},u.alloc=function(a,s,h){if(typeof a!="number")throw new TypeError("Argument must be a number");var f=v(a);return s!==void 0?typeof h=="string"?f.fill(s,h):f.fill(s):f.fill(0),f},u.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return v(a)},u.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return w.SlowBuffer(a)}}(pe,pe.exports)),pe.exports}var Gt;function Vr(){if(Gt)return Ye;Gt=1;var d=Kr().Buffer,y=d.isEncoding||function(_){switch(_=""+_,_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function w(_){if(!_)return"utf8";for(var R;;)switch(_){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return _;default:if(R)return;_=(""+_).toLowerCase(),R=!0}}function v(_){var R=w(_);if(typeof R!="string"&&(d.isEncoding===y||!y(_)))throw new Error("Unknown encoding: "+_);return R||_}Ye.StringDecoder=m;function m(_){this.encoding=v(_);var R;switch(this.encoding){case"utf16le":this.text=r,this.end=n,R=4;break;case"utf8":this.fillLast=h,R=4;break;case"base64":this.text=o,this.end=l,R=3;break;default:this.write=E,this.end=b;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=d.allocUnsafe(R)}m.prototype.write=function(_){if(_.length===0)return"";var R,x;if(this.lastNeed){if(R=this.fillLast(_),R===void 0)return"";x=this.lastNeed,this.lastNeed=0}else x=0;return x<_.length?R?R+this.text(_,x):this.text(_,x):R||""},m.prototype.end=i,m.prototype.text=f,m.prototype.fillLast=function(_){if(this.lastNeed<=_.length)return _.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,this.lastTotal-this.lastNeed,0,_.length),this.lastNeed-=_.length};function u(_){return _<=127?0:_>>5===6?2:_>>4===14?3:_>>3===30?4:_>>6===2?-1:-2}function a(_,R,x){var T=R.length-1;if(T<x)return 0;var S=u(R[T]);return S>=0?(S>0&&(_.lastNeed=S-1),S):--T<x||S===-2?0:(S=u(R[T]),S>=0?(S>0&&(_.lastNeed=S-2),S):--T<x||S===-2?0:(S=u(R[T]),S>=0?(S>0&&(S===2?S=0:_.lastNeed=S-3),S):0))}function s(_,R,x){if((R[0]&192)!==128)return _.lastNeed=0,"�";if(_.lastNeed>1&&R.length>1){if((R[1]&192)!==128)return _.lastNeed=1,"�";if(_.lastNeed>2&&R.length>2&&(R[2]&192)!==128)return _.lastNeed=2,"�"}}function h(_){var R=this.lastTotal-this.lastNeed,x=s(this,_);if(x!==void 0)return x;if(this.lastNeed<=_.length)return _.copy(this.lastChar,R,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,R,0,_.length),this.lastNeed-=_.length}function f(_,R){var x=a(this,_,R);if(!this.lastNeed)return _.toString("utf8",R);this.lastTotal=x;var T=_.length-(x-this.lastNeed);return _.copy(this.lastChar,0,T),_.toString("utf8",R,T)}function i(_){var R=_&&_.length?this.write(_):"";return this.lastNeed?R+"�":R}function r(_,R){if((_.length-R)%2===0){var x=_.toString("utf16le",R);if(x){var T=x.charCodeAt(x.length-1);if(T>=55296&&T<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1],x.slice(0,-1)}return x}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=_[_.length-1],_.toString("utf16le",R,_.length-1)}function n(_){var R=_&&_.length?this.write(_):"";if(this.lastNeed){var x=this.lastTotal-this.lastNeed;return R+this.lastChar.toString("utf16le",0,x)}return R}function o(_,R){var x=(_.length-R)%3;return x===0?_.toString("base64",R):(this.lastNeed=3-x,this.lastTotal=3,x===1?this.lastChar[0]=_[_.length-1]:(this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1]),_.toString("base64",R,_.length-x))}function l(_){var R=_&&_.length?this.write(_):"";return this.lastNeed?R+this.lastChar.toString("base64",0,3-this.lastNeed):R}function E(_){return _.toString(this.encoding)}function b(_){return _&&_.length?this.write(_):""}return Ye}var Ve,Yt;function Wr(){if(Yt)return Ve;Yt=1;const{Transform:d}=$,{StringDecoder:y}=Vr(),w=Symbol("last"),v=Symbol("decoder");function m(f,i,r){let n;if(this.overflow){if(n=this[v].write(f).split(this.matcher),n.length===1)return r();n.shift(),this.overflow=!1}else this[w]+=this[v].write(f),n=this[w].split(this.matcher);this[w]=n.pop();for(let o=0;o<n.length;o++)try{a(this,this.mapper(n[o]))}catch(l){return r(l)}if(this.overflow=this[w].length>this.maxLength,this.overflow&&!this.skipOverflow){r(new Error("maximum buffer reached"));return}r()}function u(f){if(this[w]+=this[v].end(),this[w])try{a(this,this.mapper(this[w]))}catch(i){return f(i)}f()}function a(f,i){i!==void 0&&f.push(i)}function s(f){return f}function h(f,i,r){switch(f=f||/\r?\n/,i=i||s,r=r||{},arguments.length){case 1:typeof f=="function"?(i=f,f=/\r?\n/):typeof f=="object"&&!(f instanceof RegExp)&&!f[Symbol.split]&&(r=f,f=/\r?\n/);break;case 2:typeof f=="function"?(r=i,i=f,f=/\r?\n/):typeof i=="object"&&(r=i,i=s)}r=Object.assign({},r),r.autoDestroy=!0,r.transform=m,r.flush=u,r.readableObjectMode=!0;const n=new d(r);return n[w]="",n[v]=new y("utf8"),n.matcher=f,n.mapper=i,n.maxLength=r.maxLength,n.skipOverflow=r.skipOverflow||!1,n.overflow=!1,n._destroy=function(o,l){this._writableState.errorEmitted=!1,l(o)},n}return Ve=h,Ve}var Kt;function $r(){return Kt||(Kt=1,function(d){var y={},w=$,v=$.Stream,m=Wr(),u=$,a=5432,s=process.platform==="win32",h=process.stderr,f=56,i=7,r=61440,n=32768;function o(S){return(S&r)==n}var l=["host","port","database","user","password"],E=l.length,b=l[E-1];function _(){var S=h instanceof v&&h.writable===!0;if(S){var C=Array.prototype.slice.call(arguments).concat(`
`);h.write(u.format.apply(u,C))}}Object.defineProperty(d.exports,"isWin",{get:function(){return s},set:function(S){s=S}}),d.exports.warnTo=function(S){var C=h;return h=S,C},d.exports.getFileName=function(S){var C=S||y,g=C.PGPASSFILE||(s?w.join(C.APPDATA||"./","postgresql","pgpass.conf"):w.join(C.HOME||"./",".pgpass"));return g},d.exports.usePgPass=function(S,C){return Object.prototype.hasOwnProperty.call(y,"PGPASSWORD")?!1:s?!0:(C=C||"<unkn>",o(S.mode)?S.mode&(f|i)?(_('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',C),!1):!0:(_('WARNING: password file "%s" is not a plain file',C),!1))};var R=d.exports.match=function(S,C){return l.slice(0,-1).reduce(function(g,I,P){return P==1&&Number(S[I]||a)===Number(C[I])?g&&!0:g&&(C[I]==="*"||C[I]===S[I])},!0)};d.exports.getPassword=function(S,C,g){var I,P=C.pipe(m());function F(N){var D=x(N);D&&T(D)&&R(S,D)&&(I=D[b],P.end())}var B=function(){C.destroy(),g(I)},j=function(N){C.destroy(),_("WARNING: error on reading file: %s",N),g(void 0)};C.on("error",j),P.on("data",F).on("end",B).on("error",j)};var x=d.exports.parseLine=function(S){if(S.length<11||S.match(/^\s+#/))return null;for(var C="",g="",I=0,P=0,F={},B=!1,j=function(D,k,Q){var Y=S.substring(k,Q);Object.hasOwnProperty.call(y,"PGPASS_NO_DEESCAPE")||(Y=Y.replace(/\\([:\\])/g,"$1")),F[l[D]]=Y},N=0;N<S.length-1;N+=1){if(C=S.charAt(N+1),g=S.charAt(N),B=I==E-1,B){j(I,P);break}N>=0&&C==":"&&g!=="\\"&&(j(I,P,N+1),P=N+2,I+=1)}return F=Object.keys(F).length===E?F:null,F},T=d.exports.isValidEntry=function(S){for(var C={0:function(B){return B.length>0},1:function(B){return B==="*"?!0:(B=Number(B),isFinite(B)&&B>0&&B<9007199254740992&&Math.floor(B)===B)},2:function(B){return B.length>0},3:function(B){return B.length>0},4:function(B){return B.length>0}},g=0;g<l.length;g+=1){var I=C[g],P=S[l[g]]||"",F=I(P);if(!F)return!1}return!0}}(Ge)),Ge.exports}var Vt;function Xr(){if(Vt)return le.exports;Vt=1;var d=$,y=$r();return le.exports=function(w,v){var m=y.getFileName();d.stat(m,function(u,a){if(u||!y.usePgPass(a,m))return v(void 0);var s=d.createReadStream(m);y.getPassword(w,s,v)})},le.exports.warnTo=y.warnTo,le.exports}var We,Wt;function zr(){if(Wt)return We;Wt=1;const d=ee().EventEmitter,y=oe(),w=Fr(),v=et(),m=sr(),u=Or(),a=ye(),s=cr(),h=ir();class f extends d{constructor(r){super(),this.connectionParameters=new m(r),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;const n=r||{};this._Promise=n.Promise||Ze.Promise,this._types=new v(n.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!n.enableChannelBinding,this.connection=n.connection||new s({stream:n.stream,ssl:this.connectionParameters.ssl,keepAlive:n.keepAlive||!1,keepAliveInitialDelayMillis:n.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=n.binary||a.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=n.connectionTimeoutMillis||0}_errorAllQueries(r){const n=o=>{process.nextTick(()=>{o.handleError(r,this.connection)})};this.activeQuery&&(n(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(n),this.queryQueue.length=0}_connect(r){const n=this,o=this.connection;if(this._connectionCallback=r,this._connecting||this._connected){const l=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{r(l)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{o._ending=!0,o.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?o.connect(this.host+"/.s.PGSQL."+this.port):o.connect(this.port,this.host),o.on("connect",function(){n.ssl?o.requestSsl():o.startup(n.getStartupConf())}),o.on("sslconnect",function(){o.startup(n.getStartupConf())}),this._attachListeners(o),o.once("end",()=>{const l=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(l),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(l):this._handleErrorEvent(l):this._connectionError||this._handleErrorEvent(l)),process.nextTick(()=>{this.emit("end")})})}connect(r){if(r){this._connect(r);return}return new this._Promise((n,o)=>{this._connect(l=>{l?o(l):n()})})}_attachListeners(r){r.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),r.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),r.on("authenticationSASL",this._handleAuthSASL.bind(this)),r.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),r.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),r.on("backendKeyData",this._handleBackendKeyData.bind(this)),r.on("error",this._handleErrorEvent.bind(this)),r.on("errorMessage",this._handleErrorMessage.bind(this)),r.on("readyForQuery",this._handleReadyForQuery.bind(this)),r.on("notice",this._handleNotice.bind(this)),r.on("rowDescription",this._handleRowDescription.bind(this)),r.on("dataRow",this._handleDataRow.bind(this)),r.on("portalSuspended",this._handlePortalSuspended.bind(this)),r.on("emptyQuery",this._handleEmptyQuery.bind(this)),r.on("commandComplete",this._handleCommandComplete.bind(this)),r.on("parseComplete",this._handleParseComplete.bind(this)),r.on("copyInResponse",this._handleCopyInResponse.bind(this)),r.on("copyData",this._handleCopyData.bind(this)),r.on("notification",this._handleNotification.bind(this))}_checkPgPass(r){const n=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(o=>{if(o!==void 0){if(typeof o!="string"){n.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=o}else this.connectionParameters.password=this.password=null;r()}).catch(o=>{n.emit("error",o)});else if(this.password!==null)r();else try{Xr()(this.connectionParameters,l=>{l!==void 0&&(this.connectionParameters.password=this.password=l),r()})}catch(o){this.emit("error",o)}}_handleAuthCleartextPassword(r){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(r){this._checkPgPass(async()=>{try{const n=await h.postgresMd5PasswordHash(this.user,this.password,r.salt);this.connection.password(n)}catch(n){this.emit("error",n)}})}_handleAuthSASL(r){this._checkPgPass(()=>{try{this.saslSession=w.startSession(r.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(n){this.connection.emit("error",n)}})}async _handleAuthSASLContinue(r){try{await w.continueSession(this.saslSession,this.password,r.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(n){this.connection.emit("error",n)}}_handleAuthSASLFinal(r){try{w.finalizeSession(this.saslSession,r.data),this.saslSession=null}catch(n){this.connection.emit("error",n)}}_handleBackendKeyData(r){this.processID=r.processID,this.secretKey=r.secretKey}_handleReadyForQuery(r){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));const{activeQuery:n}=this;this.activeQuery=null,this.readyForQuery=!0,n&&n.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(r){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(r);this.emit("error",r)}}_handleErrorEvent(r){if(this._connecting)return this._handleErrorWhileConnecting(r);this._queryable=!1,this._errorAllQueries(r),this.emit("error",r)}_handleErrorMessage(r){if(this._connecting)return this._handleErrorWhileConnecting(r);const n=this.activeQuery;if(!n){this._handleErrorEvent(r);return}this.activeQuery=null,n.handleError(r,this.connection)}_handleRowDescription(r){this.activeQuery.handleRowDescription(r)}_handleDataRow(r){this.activeQuery.handleDataRow(r)}_handlePortalSuspended(r){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(r){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(r){if(this.activeQuery==null){const n=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(n);return}this.activeQuery.handleCommandComplete(r,this.connection)}_handleParseComplete(){if(this.activeQuery==null){const r=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(r);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(r){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(r){this.activeQuery.handleCopyData(r,this.connection)}_handleNotification(r){this.emit("notification",r)}_handleNotice(r){this.emit("notice",r)}getStartupConf(){const r=this.connectionParameters,n={user:r.user,database:r.database},o=r.application_name||r.fallback_application_name;return o&&(n.application_name=o),r.replication&&(n.replication=""+r.replication),r.statement_timeout&&(n.statement_timeout=String(parseInt(r.statement_timeout,10))),r.lock_timeout&&(n.lock_timeout=String(parseInt(r.lock_timeout,10))),r.idle_in_transaction_session_timeout&&(n.idle_in_transaction_session_timeout=String(parseInt(r.idle_in_transaction_session_timeout,10))),r.options&&(n.options=r.options),n}cancel(r,n){if(r.activeQuery===n){const o=this.connection;this.host&&this.host.indexOf("/")===0?o.connect(this.host+"/.s.PGSQL."+this.port):o.connect(this.port,this.host),o.on("connect",function(){o.cancel(r.processID,r.secretKey)})}else r.queryQueue.indexOf(n)!==-1&&r.queryQueue.splice(r.queryQueue.indexOf(n),1)}setTypeParser(r,n,o){return this._types.setTypeParser(r,n,o)}getTypeParser(r,n){return this._types.getTypeParser(r,n)}escapeIdentifier(r){return y.escapeIdentifier(r)}escapeLiteral(r){return y.escapeLiteral(r)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;const r=this.activeQuery.submit(this.connection);r&&process.nextTick(()=>{this.activeQuery.handleError(r,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(r,n,o){let l,E,b,_,R;if(r==null)throw new TypeError("Client was passed a null or undefined query");return typeof r.submit=="function"?(b=r.query_timeout||this.connectionParameters.query_timeout,E=l=r,typeof n=="function"&&(l.callback=l.callback||n)):(b=r.query_timeout||this.connectionParameters.query_timeout,l=new u(r,n,o),l.callback||(E=new this._Promise((x,T)=>{l.callback=(S,C)=>S?T(S):x(C)}).catch(x=>{throw Error.captureStackTrace(x),x}))),b&&(R=l.callback,_=setTimeout(()=>{const x=new Error("Query read timeout");process.nextTick(()=>{l.handleError(x,this.connection)}),R(x),l.callback=()=>{};const T=this.queryQueue.indexOf(l);T>-1&&this.queryQueue.splice(T,1),this._pulseQueryQueue()},b),l.callback=(x,T)=>{clearTimeout(_),R(x,T)}),this.binary&&!l.binary&&(l.binary=!0),l._result&&!l._result._types&&(l._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{l.handleError(new Error("Client was closed and is not queryable"),this.connection)}),E):(this.queryQueue.push(l),this._pulseQueryQueue(),E):(process.nextTick(()=>{l.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),E)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(r){if(this._ending=!0,!this.connection._connecting||this._ended)if(r)r();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),r)this.connection.once("end",r);else return new this._Promise(n=>{this.connection.once("end",n)})}}return f.Query=u,We=f,We}var $e,$t;function Jr(){if($t)return $e;$t=1;const d=ee().EventEmitter,y=function(){},w=(f,i)=>{const r=f.findIndex(i);return r===-1?void 0:f.splice(r,1)[0]};class v{constructor(i,r,n){this.client=i,this.idleListener=r,this.timeoutId=n}}class m{constructor(i){this.callback=i}}function u(){throw new Error("Release called on client which has already been released to the pool.")}function a(f,i){if(i)return{callback:i,result:void 0};let r,n;const o=function(E,b){E?r(E):n(b)},l=new f(function(E,b){n=E,r=b}).catch(E=>{throw Error.captureStackTrace(E),E});return{callback:o,result:l}}function s(f,i){return function r(n){n.client=i,i.removeListener("error",r),i.on("error",()=>{f.log("additional client error after disconnection due to error",n)}),f._remove(i),f.emit("error",n,i)}}class h extends d{constructor(i,r){super(),this.options=Object.assign({},i),i!=null&&"password"in i&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:i.password}),i!=null&&i.ssl&&i.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||r||hr().Client,this.Promise=this.options.Promise||Ze.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;const i=this._pendingQueue.shift();if(this._idle.length){const r=this._idle.pop();clearTimeout(r.timeoutId);const n=r.client;n.ref&&n.ref();const o=r.idleListener;return this._acquireClient(n,i,o,!1)}if(!this._isFull())return this.newClient(i);throw new Error("unexpected condition")}_remove(i,r){const n=w(this._idle,l=>l.client===i);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(l=>l!==i);const o=this;i.end(()=>{o.emit("remove",i),typeof r=="function"&&r()})}connect(i){if(this.ending){const o=new Error("Cannot use a pool after calling end on the pool");return i?i(o):this.Promise.reject(o)}const r=a(this.Promise,i),n=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new m(r.callback)),n;const o=(b,_,R)=>{clearTimeout(E),r.callback(b,_,R)},l=new m(o),E=setTimeout(()=>{w(this._pendingQueue,b=>b.callback===o),l.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return E.unref&&E.unref(),this._pendingQueue.push(l),n}return this.newClient(new m(r.callback)),n}newClient(i){const r=new this.Client(this.options);this._clients.push(r);const n=s(this,r);this.log("checking client timeout");let o,l=!1;this.options.connectionTimeoutMillis&&(o=setTimeout(()=>{this.log("ending client due to timeout"),l=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(E=>{if(o&&clearTimeout(o),r.on("error",n),E)this.log("client failed to connect",E),this._clients=this._clients.filter(b=>b!==r),l&&(E=new Error("Connection terminated due to connection timeout",{cause:E})),this._pulseQueue(),i.timedOut||i.callback(E,void 0,y);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){const b=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(r),this._idle.findIndex(R=>R.client===r)!==-1&&this._acquireClient(r,new m((R,x,T)=>T()),n,!1)},this.options.maxLifetimeSeconds*1e3);b.unref(),r.once("end",()=>clearTimeout(b))}return this._acquireClient(r,i,n,!0)}})}_acquireClient(i,r,n,o){o&&this.emit("connect",i),this.emit("acquire",i),i.release=this._releaseOnce(i,n),i.removeListener("error",n),r.timedOut?o&&this.options.verify?this.options.verify(i,i.release):i.release():o&&this.options.verify?this.options.verify(i,l=>{if(l)return i.release(l),r.callback(l,void 0,y);r.callback(void 0,i,i.release)}):r.callback(void 0,i,i.release)}_releaseOnce(i,r){let n=!1;return o=>{n&&u(),n=!0,this._release(i,r,o)}}_release(i,r,n){if(i.on("error",r),i._poolUseCount=(i._poolUseCount||0)+1,this.emit("release",n,i),n||this.ending||!i._queryable||i._ending||i._poolUseCount>=this.options.maxUses)return i._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(i,this._pulseQueue.bind(this));if(this._expired.has(i))return this.log("remove expired client"),this._expired.delete(i),this._remove(i,this._pulseQueue.bind(this));let l;this.options.idleTimeoutMillis&&this._isAboveMin()&&(l=setTimeout(()=>{this.log("remove idle client"),this._remove(i,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&l.unref()),this.options.allowExitOnIdle&&i.unref(),this._idle.push(new v(i,r,l)),this._pulseQueue()}query(i,r,n){if(typeof i=="function"){const l=a(this.Promise,i);return setImmediate(function(){return l.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),l.result}typeof r=="function"&&(n=r,r=void 0);const o=a(this.Promise,n);return n=o.callback,this.connect((l,E)=>{if(l)return n(l);let b=!1;const _=R=>{b||(b=!0,E.release(R),n(R))};E.once("error",_),this.log("dispatching query");try{E.query(i,r,(R,x)=>{if(this.log("query dispatched"),E.removeListener("error",_),!b)return b=!0,E.release(R),R?n(R):n(void 0,x)})}catch(R){return E.release(R),n(R)}}),o.result}end(i){if(this.log("ending"),this.ending){const n=new Error("Called end on pool more than once");return i?i(n):this.Promise.reject(n)}this.ending=!0;const r=a(this.Promise,i);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((i,r)=>i+(this._expired.has(r)?1:0),0)}get totalCount(){return this._clients.length}}return $e=h,$e}var Xe={exports:{}};const Zr={},en=Object.freeze(Object.defineProperty({__proto__:null,default:Zr},Symbol.toStringTag,{value:"Module"})),tn=tr(en);var ze={exports:{}},Xt;function rn(){if(Xt)return ze.exports;Xt=1;const d=ee().EventEmitter,y=$,w=oe(),v=ze.exports=function(u,a,s){d.call(this),u=w.normalizeQueryConfig(u,a,s),this.text=u.text,this.values=u.values,this.name=u.name,this.queryMode=u.queryMode,this.callback=u.callback,this.state="new",this._arrayMode=u.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(h){h==="row"&&(this._emitRowEvents=!0)}.bind(this))};y.inherits(v,d);const m={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};return v.prototype.handleError=function(u){const a=this.native.pq.resultErrorFields();if(a)for(const s in a){const h=m[s]||s;u[h]=a[s]}this.callback?this.callback(u):this.emit("error",u),this.state="error"},v.prototype.then=function(u,a){return this._getPromise().then(u,a)},v.prototype.catch=function(u){return this._getPromise().catch(u)},v.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(u,a){this._once("end",u),this._once("error",a)}.bind(this)),this._promise)},v.prototype.submit=function(u){this.state="running";const a=this;this.native=u.native,u.native.arrayMode=this._arrayMode;let s=function(h,f,i){if(u.native.arrayMode=!1,setImmediate(function(){a.emit("_done")}),h)return a.handleError(h);a._emitRowEvents&&(i.length>1?f.forEach((r,n)=>{r.forEach(o=>{a.emit("row",o,i[n])})}):f.forEach(function(r){a.emit("row",r,i)})),a.state="end",a.emit("end",i),a.callback&&a.callback(null,i)};if(process.domain&&(s=process.domain.bind(s)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));const h=(this.values||[]).map(w.prepareValue);if(u.namedQueries[this.name]){if(this.text&&u.namedQueries[this.name]!==this.text){const f=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return s(f)}return u.native.execute(this.name,h,s)}return u.native.prepare(this.name,this.text,h.length,function(f){return f?s(f):(u.namedQueries[a.name]=a.text,a.native.execute(a.name,h,s))})}else if(this.values){if(!Array.isArray(this.values)){const f=new Error("Query values must be an array");return s(f)}const h=this.values.map(w.prepareValue);u.native.query(this.text,h,s)}else this.queryMode==="extended"?u.native.query(this.text,[],s):u.native.query(this.text,s)},ze.exports}var zt;function nn(){if(zt)return Xe.exports;zt=1;var d;try{d=tn}catch(s){throw s}const y=et(),w=ee().EventEmitter,v=$,m=sr(),u=rn(),a=Xe.exports=function(s){w.call(this),s=s||{},this._Promise=s.Promise||Ze.Promise,this._types=new y(s.types),this.native=new d({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;const h=this.connectionParameters=new m(s);s.nativeConnectionString&&(h.nativeConnectionString=s.nativeConnectionString),this.user=h.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:h.password}),this.database=h.database,this.host=h.host,this.port=h.port,this.namedQueries={}};return a.Query=u,v.inherits(a,w),a.prototype._errorAllQueries=function(s){const h=f=>{process.nextTick(()=>{f.native=this.native,f.handleError(s)})};this._hasActiveQuery()&&(h(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(h),this._queryQueue.length=0},a.prototype._connect=function(s){const h=this;if(this._connecting){process.nextTick(()=>s(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(f,i){if(h.connectionParameters.nativeConnectionString&&(i=h.connectionParameters.nativeConnectionString),f)return s(f);h.native.connect(i,function(r){if(r)return h.native.end(),s(r);h._connected=!0,h.native.on("error",function(n){h._queryable=!1,h._errorAllQueries(n),h.emit("error",n)}),h.native.on("notification",function(n){h.emit("notification",{channel:n.relname,payload:n.extra})}),h.emit("connect"),h._pulseQueryQueue(!0),s()})})},a.prototype.connect=function(s){if(s){this._connect(s);return}return new this._Promise((h,f)=>{this._connect(i=>{i?f(i):h()})})},a.prototype.query=function(s,h,f){let i,r,n,o,l;if(s==null)throw new TypeError("Client was passed a null or undefined query");if(typeof s.submit=="function")n=s.query_timeout||this.connectionParameters.query_timeout,r=i=s,typeof h=="function"&&(s.callback=h);else if(n=s.query_timeout||this.connectionParameters.query_timeout,i=new u(s,h,f),!i.callback){let E,b;r=new this._Promise((_,R)=>{E=_,b=R}).catch(_=>{throw Error.captureStackTrace(_),_}),i.callback=(_,R)=>_?b(_):E(R)}return n&&(l=i.callback,o=setTimeout(()=>{const E=new Error("Query read timeout");process.nextTick(()=>{i.handleError(E,this.connection)}),l(E),i.callback=()=>{};const b=this._queryQueue.indexOf(i);b>-1&&this._queryQueue.splice(b,1),this._pulseQueryQueue()},n),i.callback=(E,b)=>{clearTimeout(o),l(E,b)}),this._queryable?this._ending?(i.native=this.native,process.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(i),this._pulseQueryQueue(),r):(i.native=this.native,process.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)},a.prototype.end=function(s){const h=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,s));let f;return s||(f=new this._Promise(function(i,r){s=n=>n?r(n):i()})),this.native.end(function(){h._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{h.emit("end"),s&&s()})}),f},a.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},a.prototype._pulseQueryQueue=function(s){if(!this._connected||this._hasActiveQuery())return;const h=this._queryQueue.shift();if(!h){s||this.emit("drain");return}this._activeQuery=h,h.submit(this);const f=this;h.once("_done",function(){f._pulseQueryQueue()})},a.prototype.cancel=function(s){this._activeQuery===s?this.native.cancel(function(){}):this._queryQueue.indexOf(s)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(s),1)},a.prototype.ref=function(){},a.prototype.unref=function(){},a.prototype.setTypeParser=function(s,h,f){return this._types.setTypeParser(s,h,f)},a.prototype.getTypeParser=function(s,h){return this._types.getTypeParser(s,h)},Xe.exports}var Je,Jt;function Zt(){return Jt||(Jt=1,Je=nn()),Je}var er;function hr(){return er||(er=1,function(d){var y={};const w=zr(),v=ye(),m=cr(),u=or(),a=oe(),s=Jr(),h=et(),{DatabaseError:f}=ur(),{escapeIdentifier:i,escapeLiteral:r}=oe(),n=l=>class extends s{constructor(b){super(b,l)}},o=function(l){this.defaults=v,this.Client=l,this.Query=this.Client.Query,this.Pool=n(this.Client),this._pools=[],this.Connection=m,this.types=me(),this.DatabaseError=f,this.TypeOverrides=h,this.escapeIdentifier=i,this.escapeLiteral=r,this.Result=u,this.utils=a};typeof y.NODE_PG_FORCE_NATIVE<"u"?d.exports=new o(Zt()):(d.exports=new o(w),Object.defineProperty(d.exports,"native",{configurable:!0,enumerable:!1,get(){let l=null;try{l=new o(Zt())}catch(E){if(E.code!=="MODULE_NOT_FOUND")throw E}return Object.defineProperty(d.exports,"native",{value:l}),l}}))}(ge)),ge.exports}var sn=hr();const z=_r(sn);z.Client;z.Pool;z.Connection;z.types;z.Query;z.DatabaseError;z.escapeIdentifier;z.escapeLiteral;z.Result;z.TypeOverrides;z.defaults;var on={};const{Pool:an}=z,fr=new an({connectionString:on.DATABASE_URL,ssl:{rejectUnauthorized:!1}});async function un(){const d=await fr.connect();try{await d.query(`
      CREATE TABLE IF NOT EXISTS members (
        member_number VARCHAR(50) PRIMARY KEY,
        name VARCHAR(255) NOT NULL,
        phone VARCHAR(50),
        email VARCHAR(255),
        profile_picture TEXT,
        bio TEXT,
        sailing_experience TEXT,
        pin VARCHAR(50),
        is_admin BOOLEAN DEFAULT FALSE,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
      );
      
      CREATE TABLE IF NOT EXISTS boats (
        id VARCHAR(50) PRIMARY KEY,
        name VARCHAR(255) NOT NULL,
        status VARCHAR(50) DEFAULT 'operational',
        boat_type VARCHAR(50) DEFAULT 'individual',
        last_maintenance DATE,
        notes TEXT
      );
      
      CREATE TABLE IF NOT EXISTS check_ins (
        id SERIAL PRIMARY KEY,
        boat_id VARCHAR(50) NOT NULL,
        sailor_name VARCHAR(255) NOT NULL,
        member_number VARCHAR(50),
        phone VARCHAR(50),
        departure_time TIMESTAMP NOT NULL,
        expected_return TIMESTAMP NOT NULL,
        actual_return TIMESTAMP,
        checkout_checklist_completed BOOLEAN DEFAULT FALSE,
        checkin_checklist_completed BOOLEAN DEFAULT FALSE,
        trip_notes TEXT,
        weather_conditions TEXT,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (boat_id) REFERENCES boats (id),
        FOREIGN KEY (member_number) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS notifications (
        id SERIAL PRIMARY KEY,
        boat_id VARCHAR(50) NOT NULL,
        type VARCHAR(50) NOT NULL,
        message TEXT NOT NULL,
        sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (boat_id) REFERENCES boats (id)
      );
      
      CREATE TABLE IF NOT EXISTS trip_photos (
        id SERIAL PRIMARY KEY,
        check_in_id INTEGER NOT NULL,
        member_number VARCHAR(50) NOT NULL,
        photo_url TEXT NOT NULL,
        caption TEXT,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (check_in_id) REFERENCES check_ins (id),
        FOREIGN KEY (member_number) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS trip_likes (
        id SERIAL PRIMARY KEY,
        trip_photo_id INTEGER NOT NULL,
        member_number VARCHAR(50) NOT NULL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (trip_photo_id) REFERENCES trip_photos (id),
        FOREIGN KEY (member_number) REFERENCES members (member_number),
        UNIQUE(trip_photo_id, member_number)
      );
      
      CREATE TABLE IF NOT EXISTS trip_comments (
        id SERIAL PRIMARY KEY,
        trip_photo_id INTEGER NOT NULL,
        member_number VARCHAR(50) NOT NULL,
        comment TEXT NOT NULL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (trip_photo_id) REFERENCES trip_photos (id),
        FOREIGN KEY (member_number) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS user_friends (
        id SERIAL PRIMARY KEY,
        member_number1 VARCHAR(50) NOT NULL,
        member_number2 VARCHAR(50) NOT NULL,
        status VARCHAR(20) DEFAULT 'pending',
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (member_number1) REFERENCES members (member_number),
        FOREIGN KEY (member_number2) REFERENCES members (member_number),
        UNIQUE(member_number1, member_number2)
      );
      
      CREATE TABLE IF NOT EXISTS planned_outings (
        id SERIAL PRIMARY KEY,
        title VARCHAR(255) NOT NULL,
        description TEXT,
        date DATE NOT NULL,
        time TIME,
        location VARCHAR(255),
        max_participants INTEGER,
        created_by VARCHAR(50) NOT NULL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (created_by) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS outing_participants (
        id SERIAL PRIMARY KEY,
        outing_id INTEGER NOT NULL,
        member_number VARCHAR(50) NOT NULL,
        status VARCHAR(20) DEFAULT 'confirmed',
        joined_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (outing_id) REFERENCES planned_outings (id),
        FOREIGN KEY (member_number) REFERENCES members (member_number),
        UNIQUE(outing_id, member_number)
      );
      
      CREATE TABLE IF NOT EXISTS messages (
        id SERIAL PRIMARY KEY,
        sender_member_number VARCHAR(50) NOT NULL,
        receiver_member_number VARCHAR(50) NOT NULL,
        message TEXT NOT NULL,
        is_read BOOLEAN DEFAULT FALSE,
        sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (sender_member_number) REFERENCES members (member_number),
        FOREIGN KEY (receiver_member_number) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS boat_hours (
        id SERIAL PRIMARY KEY,
        member_number VARCHAR(50) NOT NULL,
        check_in_id INTEGER NOT NULL,
        boat_id VARCHAR(50) NOT NULL,
        hours DECIMAL(5,2) NOT NULL,
        recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (member_number) REFERENCES members (member_number),
        FOREIGN KEY (check_in_id) REFERENCES check_ins (id),
        FOREIGN KEY (boat_id) REFERENCES boats (id)
      );
      
      CREATE TABLE IF NOT EXISTS maintenance_issues (
        id SERIAL PRIMARY KEY,
        boat_id VARCHAR(50) NOT NULL,
        reported_by VARCHAR(50) NOT NULL,
        issue_type VARCHAR(100) NOT NULL,
        description TEXT NOT NULL,
        severity VARCHAR(20) DEFAULT 'medium',
        status VARCHAR(20) DEFAULT 'open',
        reported_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        resolved_at TIMESTAMP,
        resolved_by VARCHAR(50),
        resolution_notes TEXT,
        FOREIGN KEY (boat_id) REFERENCES boats (id),
        FOREIGN KEY (reported_by) REFERENCES members (member_number),
        FOREIGN KEY (resolved_by) REFERENCES members (member_number)
      );
      
      CREATE TABLE IF NOT EXISTS qr_codes (
        id SERIAL PRIMARY KEY,
        boat_id VARCHAR(50) NOT NULL,
        qr_code_url TEXT NOT NULL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (boat_id) REFERENCES boats (id)
      );
    `)}finally{d.release()}}un().catch(console.error);async function lr(){return await fr.connect()}async function hn(d){const y=await lr();try{return(await y.query("SELECT is_admin FROM members WHERE member_number = $1",[d])).rows[0]?.is_admin||!1}finally{y.release()}}async function fn(d,y){const w=await lr();try{return(await w.query("SELECT * FROM members WHERE member_number = $1 AND pin = $2",[d,y])).rows[0]||null}finally{w.release()}}export{hn as isAdmin,fn as verifyMemberCredentials};
